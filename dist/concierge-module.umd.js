(function(Y,C){typeof exports=="object"&&typeof module<"u"?C(exports,require("react/jsx-runtime"),require("react"),require("framer-motion"),require("lucide-react"),require("react-markdown"),require("@radix-ui/react-tooltip"),require("@daily-co/daily-react"),require("@mui/icons-material/CallEnd"),require("react-i18next")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","react","framer-motion","lucide-react","react-markdown","@radix-ui/react-tooltip","@daily-co/daily-react","@mui/icons-material/CallEnd","react-i18next"],C):(Y=typeof globalThis<"u"?globalThis:Y||self,C(Y.ReactAIConcierge={},Y.jsxRuntime,Y.React,Y.framerMotion,Y.lucideReact,Y.ReactMarkdown,Y.TooltipPrimitive,Y.dailyReact,Y.CallEndIcon,Y.reactI18next))})(this,function(Y,C,I,mc,X,eo,ug,oe,lg,pg){"use strict";function yc(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const r in e)if(r!=="default"){const o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:()=>e[r]})}}return t.default=e,Object.freeze(t)}const ae=yc(I),Gt=yc(ug);function Sc(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function dg(...e){return t=>{let r=!1;const o=e.map(i=>{const a=Sc(i,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let i=0;i<o.length;i++){const a=o[i];typeof a=="function"?a():Sc(e[i],null)}}}}function hg(e){const t=vg(e),r=ae.forwardRef((o,i)=>{const{children:a,...s}=o,n=ae.Children.toArray(a),c=n.find(mg);if(c){const u=c.props.children,l=n.map(p=>p===c?ae.Children.count(u)>1?ae.Children.only(null):ae.isValidElement(u)?u.props.children:null:p);return C.jsx(t,{...s,ref:i,children:ae.isValidElement(u)?ae.cloneElement(u,void 0,l):null})}return C.jsx(t,{...s,ref:i,children:a})});return r.displayName=`${e}.Slot`,r}var fg=hg("Slot");function vg(e){const t=ae.forwardRef((r,o)=>{const{children:i,...a}=r;if(ae.isValidElement(i)){const s=Sg(i),n=yg(a,i.props);return i.type!==ae.Fragment&&(n.ref=o?dg(o,s):s),ae.cloneElement(i,n)}return ae.Children.count(i)>1?ae.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var gg=Symbol("radix.slottable");function mg(e){return ae.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===gg}function yg(e,t){const r={...t};for(const o in t){const i=e[o],a=t[o];/^on[A-Z]/.test(o)?i&&a?r[o]=(...n)=>{const c=a(...n);return i(...n),c}:i&&(r[o]=i):o==="style"?r[o]={...i,...a}:o==="className"&&(r[o]=[i,a].filter(Boolean).join(" "))}return{...e,...r}}function Sg(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function Cc(e){var t,r,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=Cc(e[t]))&&(o&&(o+=" "),o+=r)}else for(r in e)e[r]&&(o&&(o+=" "),o+=r);return o}function Pc(){for(var e,t,r=0,o="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=Cc(e))&&(o&&(o+=" "),o+=t);return o}const Rc=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,bc=Pc,Cg=(e,t)=>r=>{var o;if(t?.variants==null)return bc(e,r?.class,r?.className);const{variants:i,defaultVariants:a}=t,s=Object.keys(i).map(u=>{const l=r?.[u],p=a?.[u];if(l===null)return null;const d=Rc(l)||Rc(p);return i[u][d]}),n=r&&Object.entries(r).reduce((u,l)=>{let[p,d]=l;return d===void 0||(u[p]=d),u},{}),c=t==null||(o=t.compoundVariants)===null||o===void 0?void 0:o.reduce((u,l)=>{let{class:p,className:d,...h}=l;return Object.entries(h).every(f=>{let[g,m]=f;return Array.isArray(m)?m.includes({...a,...n}[g]):{...a,...n}[g]===m})?[...u,p,d]:u},[]);return bc(e,s,c,r?.class,r?.className)},to="-",Pg=e=>{const t=bg(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:o}=e;return{getClassGroupId:s=>{const n=s.split(to);return n[0]===""&&n.length!==1&&n.shift(),wc(n,t)||Rg(s)},getConflictingClassGroupIds:(s,n)=>{const c=r[s]||[];return n&&o[s]?[...c,...o[s]]:c}}},wc=(e,t)=>{if(e.length===0)return t.classGroupId;const r=e[0],o=t.nextPart.get(r),i=o?wc(e.slice(1),o):void 0;if(i)return i;if(t.validators.length===0)return;const a=e.join(to);return t.validators.find(({validator:s})=>s(a))?.classGroupId},Ec=/^\[(.+)\]$/,Rg=e=>{if(Ec.test(e)){const t=Ec.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},bg=e=>{const{theme:t,prefix:r}=e,o={nextPart:new Map,validators:[]};return Eg(Object.entries(e.classGroups),r).forEach(([a,s])=>{ro(s,o,a,t)}),o},ro=(e,t,r,o)=>{e.forEach(i=>{if(typeof i=="string"){const a=i===""?t:Ic(t,i);a.classGroupId=r;return}if(typeof i=="function"){if(wg(i)){ro(i(o),t,r,o);return}t.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,s])=>{ro(s,Ic(t,a),r,o)})})},Ic=(e,t)=>{let r=e;return t.split(to).forEach(o=>{r.nextPart.has(o)||r.nextPart.set(o,{nextPart:new Map,validators:[]}),r=r.nextPart.get(o)}),r},wg=e=>e.isThemeGetter,Eg=(e,t)=>t?e.map(([r,o])=>{const i=o.map(a=>typeof a=="string"?t+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([s,n])=>[t+s,n])):a);return[r,i]}):e,Ig=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,o=new Map;const i=(a,s)=>{r.set(a,s),t++,t>e&&(t=0,o=r,r=new Map)};return{get(a){let s=r.get(a);if(s!==void 0)return s;if((s=o.get(a))!==void 0)return i(a,s),s},set(a,s){r.has(a)?r.set(a,s):i(a,s)}}},Ac="!",Ag=e=>{const{separator:t,experimentalParseClassName:r}=e,o=t.length===1,i=t[0],a=t.length,s=n=>{const c=[];let u=0,l=0,p;for(let m=0;m<n.length;m++){let v=n[m];if(u===0){if(v===i&&(o||n.slice(m,m+a)===t)){c.push(n.slice(l,m)),l=m+a;continue}if(v==="/"){p=m;continue}}v==="["?u++:v==="]"&&u--}const d=c.length===0?n:n.substring(l),h=d.startsWith(Ac),f=h?d.substring(1):d,g=p&&p>l?p-l:void 0;return{modifiers:c,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:g}};return r?n=>r({className:n,parseClassName:s}):s},Tg=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(o=>{o[0]==="["?(t.push(...r.sort(),o),r=[]):r.push(o)}),t.push(...r.sort()),t},_g=e=>({cache:Ig(e.cacheSize),parseClassName:Ag(e),...Pg(e)}),kg=/\s+/,Og=(e,t)=>{const{parseClassName:r,getClassGroupId:o,getConflictingClassGroupIds:i}=t,a=[],s=e.trim().split(kg);let n="";for(let c=s.length-1;c>=0;c-=1){const u=s[c],{modifiers:l,hasImportantModifier:p,baseClassName:d,maybePostfixModifierPosition:h}=r(u);let f=!!h,g=o(f?d.substring(0,h):d);if(!g){if(!f){n=u+(n.length>0?" "+n:n);continue}if(g=o(d),!g){n=u+(n.length>0?" "+n:n);continue}f=!1}const m=Tg(l).join(":"),v=p?m+Ac:m,y=v+g;if(a.includes(y))continue;a.push(y);const S=i(g,f);for(let P=0;P<S.length;++P){const b=S[P];a.push(v+b)}n=u+(n.length>0?" "+n:n)}return n};function Mg(){let e=0,t,r,o="";for(;e<arguments.length;)(t=arguments[e++])&&(r=Tc(t))&&(o&&(o+=" "),o+=r);return o}const Tc=e=>{if(typeof e=="string")return e;let t,r="";for(let o=0;o<e.length;o++)e[o]&&(t=Tc(e[o]))&&(r&&(r+=" "),r+=t);return r};function Dg(e,...t){let r,o,i,a=s;function s(c){const u=t.reduce((l,p)=>p(l),e());return r=_g(u),o=r.cache.get,i=r.cache.set,a=n,n(c)}function n(c){const u=o(c);if(u)return u;const l=Og(c,r);return i(c,l),l}return function(){return a(Mg.apply(null,arguments))}}const W=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},_c=/^\[(?:([a-z-]+):)?(.+)\]$/i,Ng=/^\d+\/\d+$/,xg=new Set(["px","full","screen"]),zg=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Lg=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,jg=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,qg=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Fg=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,xe=e=>qt(e)||xg.has(e)||Ng.test(e),He=e=>Ft(e,"length",Jg),qt=e=>!!e&&!Number.isNaN(Number(e)),no=e=>Ft(e,"number",qt),Qt=e=>!!e&&Number.isInteger(Number(e)),Bg=e=>e.endsWith("%")&&qt(e.slice(0,-1)),L=e=>_c.test(e),Ke=e=>zg.test(e),Ug=new Set(["length","size","percentage"]),$g=e=>Ft(e,Ug,kc),Vg=e=>Ft(e,"position",kc),Wg=new Set(["image","url"]),Hg=e=>Ft(e,Wg,Qg),Kg=e=>Ft(e,"",Gg),Yt=()=>!0,Ft=(e,t,r)=>{const o=_c.exec(e);return o?o[1]?typeof t=="string"?o[1]===t:t.has(o[1]):r(o[2]):!1},Jg=e=>Lg.test(e)&&!jg.test(e),kc=()=>!1,Gg=e=>qg.test(e),Qg=e=>Fg.test(e),Yg=Dg(()=>{const e=W("colors"),t=W("spacing"),r=W("blur"),o=W("brightness"),i=W("borderColor"),a=W("borderRadius"),s=W("borderSpacing"),n=W("borderWidth"),c=W("contrast"),u=W("grayscale"),l=W("hueRotate"),p=W("invert"),d=W("gap"),h=W("gradientColorStops"),f=W("gradientColorStopPositions"),g=W("inset"),m=W("margin"),v=W("opacity"),y=W("padding"),S=W("saturate"),P=W("scale"),b=W("sepia"),w=W("skew"),A=W("space"),E=W("translate"),D=()=>["auto","contain","none"],R=()=>["auto","hidden","clip","visible","scroll"],M=()=>["auto",L,t],_=()=>[L,t],z=()=>["",xe,He],F=()=>["auto",qt,L],Q=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ee=()=>["solid","dashed","dotted","double","none"],re=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],me=()=>["start","end","center","between","around","evenly","stretch"],$=()=>["","0",L],se=()=>["auto","avoid","all","avoid-page","page","left","right","column"],H=()=>[qt,L];return{cacheSize:500,separator:":",theme:{colors:[Yt],spacing:[xe,He],blur:["none","",Ke,L],brightness:H(),borderColor:[e],borderRadius:["none","","full",Ke,L],borderSpacing:_(),borderWidth:z(),contrast:H(),grayscale:$(),hueRotate:H(),invert:$(),gap:_(),gradientColorStops:[e],gradientColorStopPositions:[Bg,He],inset:M(),margin:M(),opacity:H(),padding:_(),saturate:H(),scale:H(),sepia:$(),skew:H(),space:_(),translate:_()},classGroups:{aspect:[{aspect:["auto","square","video",L]}],container:["container"],columns:[{columns:[Ke]}],"break-after":[{"break-after":se()}],"break-before":[{"break-before":se()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Q(),L]}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Qt,L]}],basis:[{basis:M()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",L]}],grow:[{grow:$()}],shrink:[{shrink:$()}],order:[{order:["first","last","none",Qt,L]}],"grid-cols":[{"grid-cols":[Yt]}],"col-start-end":[{col:["auto",{span:["full",Qt,L]},L]}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":[Yt]}],"row-start-end":[{row:["auto",{span:[Qt,L]},L]}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",L]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",L]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal",...me()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...me(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...me(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[A]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[A]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",L,t]}],"min-w":[{"min-w":[L,t,"min","max","fit"]}],"max-w":[{"max-w":[L,t,"none","full","min","max","fit","prose",{screen:[Ke]},Ke]}],h:[{h:[L,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[L,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[L,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[L,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Ke,He]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",no]}],"font-family":[{font:[Yt]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",L]}],"line-clamp":[{"line-clamp":["none",qt,no]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",xe,L]}],"list-image":[{"list-image":["none",L]}],"list-style-type":[{list:["none","disc","decimal",L]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ee(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",xe,He]}],"underline-offset":[{"underline-offset":["auto",xe,L]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:_()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",L]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",L]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Q(),Vg]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",$g]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Hg]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[f]}],"gradient-via-pos":[{via:[f]}],"gradient-to-pos":[{to:[f]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[n]}],"border-w-x":[{"border-x":[n]}],"border-w-y":[{"border-y":[n]}],"border-w-s":[{"border-s":[n]}],"border-w-e":[{"border-e":[n]}],"border-w-t":[{"border-t":[n]}],"border-w-r":[{"border-r":[n]}],"border-w-b":[{"border-b":[n]}],"border-w-l":[{"border-l":[n]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...ee(),"hidden"]}],"divide-x":[{"divide-x":[n]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[n]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:ee()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...ee()]}],"outline-offset":[{"outline-offset":[xe,L]}],"outline-w":[{outline:[xe,He]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[xe,He]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Ke,Kg]}],"shadow-color":[{shadow:[Yt]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...re(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":re()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[o]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Ke,L]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[l]}],invert:[{invert:[p]}],saturate:[{saturate:[S]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[o]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[l]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",L]}],duration:[{duration:H()}],ease:[{ease:["linear","in","out","in-out",L]}],delay:[{delay:H()}],animate:[{animate:["none","spin","ping","pulse","bounce",L]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[P]}],"scale-x":[{"scale-x":[P]}],"scale-y":[{"scale-y":[P]}],rotate:[{rotate:[Qt,L]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[w]}],"skew-y":[{"skew-y":[w]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",L]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",L]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":_()}],"scroll-mx":[{"scroll-mx":_()}],"scroll-my":[{"scroll-my":_()}],"scroll-ms":[{"scroll-ms":_()}],"scroll-me":[{"scroll-me":_()}],"scroll-mt":[{"scroll-mt":_()}],"scroll-mr":[{"scroll-mr":_()}],"scroll-mb":[{"scroll-mb":_()}],"scroll-ml":[{"scroll-ml":_()}],"scroll-p":[{"scroll-p":_()}],"scroll-px":[{"scroll-px":_()}],"scroll-py":[{"scroll-py":_()}],"scroll-ps":[{"scroll-ps":_()}],"scroll-pe":[{"scroll-pe":_()}],"scroll-pt":[{"scroll-pt":_()}],"scroll-pr":[{"scroll-pr":_()}],"scroll-pb":[{"scroll-pb":_()}],"scroll-pl":[{"scroll-pl":_()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",L]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[xe,He,no]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}});function Zt(...e){return Yg(Pc(e))}const Zg=Cg("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ke=ae.forwardRef(({className:e,variant:t,size:r,asChild:o=!1,...i},a)=>{const s=o?fg:"button";return C.jsx(s,{className:Zt(Zg({variant:t,size:r,className:e})),ref:a,...i})});ke.displayName="Button";function Oc(e,t){const r=String(e);if(typeof t!="string")throw new TypeError("Expected character");let o=0,i=r.indexOf(t);for(;i!==-1;)o++,i=r.indexOf(t,i+t.length);return o}function Qw(){}const Xt=ws(/[A-Za-z]/),io=ws(/[\dA-Za-z]/);function Xg(e){return e!==null&&(e<32||e===127)}function Bt(e){return e!==null&&e<-2}function he(e){return e!==null&&(e<0||e===32)}function ze(e){return e===-2||e===-1||e===32}const bs=ws(new RegExp("\\p{P}|\\p{S}","u")),nt=ws(/\s/);function ws(e){return t;function t(r){return r!==null&&r>-1&&e.test(String.fromCharCode(r))}}function em(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}const Es=function(e){if(e==null)return im;if(typeof e=="function")return Is(e);if(typeof e=="object")return Array.isArray(e)?tm(e):rm(e);if(typeof e=="string")return nm(e);throw new Error("Expected function, string, or object as test")};function tm(e){const t=[];let r=-1;for(;++r<e.length;)t[r]=Es(e[r]);return Is(o);function o(...i){let a=-1;for(;++a<t.length;)if(t[a].apply(this,i))return!0;return!1}}function rm(e){const t=e;return Is(r);function r(o){const i=o;let a;for(a in e)if(i[a]!==t[a])return!1;return!0}}function nm(e){return Is(t);function t(r){return r&&r.type===e}}function Is(e){return t;function t(r,o,i){return!!(sm(r)&&e.call(this,r,typeof o=="number"?o:void 0,i||void 0))}}function im(){return!0}function sm(e){return e!==null&&typeof e=="object"&&"type"in e}function Yw(e){return e}const Mc=[],om=!0,so=!1,am="skip";function Dc(e,t,r,o){let i;typeof t=="function"&&typeof r!="function"?(o=r,r=t):i=t;const a=Es(i),s=o?-1:1;n(e,void 0,[])();function n(c,u,l){const p=c&&typeof c=="object"?c:{};if(typeof p.type=="string"){const h=typeof p.tagName=="string"?p.tagName:typeof p.name=="string"?p.name:void 0;Object.defineProperty(d,"name",{value:"node ("+(c.type+(h?"<"+h+">":""))+")"})}return d;function d(){let h=Mc,f,g,m;if((!t||a(c,u,l[l.length-1]||void 0))&&(h=cm(r(c,l)),h[0]===so))return h;if("children"in c&&c.children){const v=c;if(v.children&&h[0]!==am)for(g=(o?v.children.length:-1)+s,m=l.concat(v);g>-1&&g<v.children.length;){const y=v.children[g];if(f=n(y,g,m)(),f[0]===so)return f;g=typeof f[1]=="number"?f[1]:g+s}}return h}}}function cm(e){return Array.isArray(e)?e:typeof e=="number"?[om,e]:e==null?Mc:[e]}function um(e,t,r){const i=Es((r||{}).ignore||[]),a=lm(t);let s=-1;for(;++s<a.length;)Dc(e,"text",n);function n(u,l){let p=-1,d;for(;++p<l.length;){const h=l[p],f=d?d.children:void 0;if(i(h,f?f.indexOf(h):void 0,d))return;d=h}if(d)return c(u,l)}function c(u,l){const p=l[l.length-1],d=a[s][0],h=a[s][1];let f=0;const m=p.children.indexOf(u);let v=!1,y=[];d.lastIndex=0;let S=d.exec(u.value);for(;S;){const P=S.index,b={index:S.index,input:S.input,stack:[...l,u]};let w=h(...S,b);if(typeof w=="string"&&(w=w.length>0?{type:"text",value:w}:void 0),w===!1?d.lastIndex=P+1:(f!==P&&y.push({type:"text",value:u.value.slice(f,P)}),Array.isArray(w)?y.push(...w):w&&y.push(w),f=P+S[0].length,v=!0),!d.global)break;S=d.exec(u.value)}return v?(f<u.value.length&&y.push({type:"text",value:u.value.slice(f)}),p.children.splice(m,1,...y)):y=[u],m+y.length}}function lm(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const r=!e[0]||Array.isArray(e[0])?e:[e];let o=-1;for(;++o<r.length;){const i=r[o];t.push([pm(i[0]),dm(i[1])])}return t}function pm(e){return typeof e=="string"?new RegExp(em(e),"g"):e}function dm(e){return typeof e=="function"?e:function(){return e}}const oo="phrasing",ao=["autolink","link","image","label"];function hm(){return{transforms:[Cm],enter:{literalAutolink:vm,literalAutolinkEmail:co,literalAutolinkHttp:co,literalAutolinkWww:co},exit:{literalAutolink:Sm,literalAutolinkEmail:ym,literalAutolinkHttp:gm,literalAutolinkWww:mm}}}function fm(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:oo,notInConstruct:ao},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:oo,notInConstruct:ao},{character:":",before:"[ps]",after:"\\/",inConstruct:oo,notInConstruct:ao}]}}function vm(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function co(e){this.config.enter.autolinkProtocol.call(this,e)}function gm(e){this.config.exit.autolinkProtocol.call(this,e)}function mm(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function ym(e){this.config.exit.autolinkEmail.call(this,e)}function Sm(e){this.exit(e)}function Cm(e){um(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,Pm],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),Rm]],{ignore:["link","linkReference"]})}function Pm(e,t,r,o,i){let a="";if(!Nc(i)||(/^w/i.test(t)&&(r=t+r,t="",a="http://"),!bm(r)))return!1;const s=wm(r+o);if(!s[0])return!1;const n={type:"link",title:null,url:a+t+s[0],children:[{type:"text",value:t+s[0]}]};return s[1]?[n,{type:"text",value:s[1]}]:n}function Rm(e,t,r,o){return!Nc(o,!0)||/[-\d_]$/.test(r)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+r,children:[{type:"text",value:t+"@"+r}]}}function bm(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function wm(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let r=t[0],o=r.indexOf(")");const i=Oc(e,"(");let a=Oc(e,")");for(;o!==-1&&i>a;)e+=r.slice(0,o+1),r=r.slice(o+1),o=r.indexOf(")"),a++;return[e,r]}function Nc(e,t){const r=e.input.charCodeAt(e.index-1);return(e.index===0||nt(r)||bs(r))&&(!t||r!==47)}function er(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}xc.peek=Dm;function Em(){this.buffer()}function Im(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function Am(){this.buffer()}function Tm(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function _m(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.identifier=er(this.sliceSerialize(e)).toLowerCase(),r.label=t}function km(e){this.exit(e)}function Om(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.identifier=er(this.sliceSerialize(e)).toLowerCase(),r.label=t}function Mm(e){this.exit(e)}function Dm(){return"["}function xc(e,t,r,o){const i=r.createTracker(o);let a=i.move("[^");const s=r.enter("footnoteReference"),n=r.enter("reference");return a+=i.move(r.safe(r.associationId(e),{after:"]",before:a})),n(),s(),a+=i.move("]"),a}function Nm(){return{enter:{gfmFootnoteCallString:Em,gfmFootnoteCall:Im,gfmFootnoteDefinitionLabelString:Am,gfmFootnoteDefinition:Tm},exit:{gfmFootnoteCallString:_m,gfmFootnoteCall:km,gfmFootnoteDefinitionLabelString:Om,gfmFootnoteDefinition:Mm}}}function xm(e){let t=!1;return e&&e.firstLineBlank&&(t=!0),{handlers:{footnoteDefinition:r,footnoteReference:xc},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function r(o,i,a,s){const n=a.createTracker(s);let c=n.move("[^");const u=a.enter("footnoteDefinition"),l=a.enter("label");return c+=n.move(a.safe(a.associationId(o),{before:c,after:"]"})),l(),c+=n.move("]:"),o.children&&o.children.length>0&&(n.shift(4),c+=n.move((t?`
`:" ")+a.indentLines(a.containerFlow(o,n.current()),t?zc:zm))),u(),c}}function zm(e,t,r){return t===0?e:zc(e,t,r)}function zc(e,t,r){return(r?"":"    ")+e}const Lm=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];Lc.peek=Um;function jm(){return{canContainEols:["delete"],enter:{strikethrough:Fm},exit:{strikethrough:Bm}}}function qm(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:Lm}],handlers:{delete:Lc}}}function Fm(e){this.enter({type:"delete",children:[]},e)}function Bm(e){this.exit(e)}function Lc(e,t,r,o){const i=r.createTracker(o),a=r.enter("strikethrough");let s=i.move("~~");return s+=r.containerPhrasing(e,{...i.current(),before:s,after:"~"}),s+=i.move("~~"),a(),s}function Um(){return"~"}function $m(e){return e.length}function Vm(e,t){const r=t||{},o=(r.align||[]).concat(),i=r.stringLength||$m,a=[],s=[],n=[],c=[];let u=0,l=-1;for(;++l<e.length;){const g=[],m=[];let v=-1;for(e[l].length>u&&(u=e[l].length);++v<e[l].length;){const y=Wm(e[l][v]);if(r.alignDelimiters!==!1){const S=i(y);m[v]=S,(c[v]===void 0||S>c[v])&&(c[v]=S)}g.push(y)}s[l]=g,n[l]=m}let p=-1;if(typeof o=="object"&&"length"in o)for(;++p<u;)a[p]=jc(o[p]);else{const g=jc(o);for(;++p<u;)a[p]=g}p=-1;const d=[],h=[];for(;++p<u;){const g=a[p];let m="",v="";g===99?(m=":",v=":"):g===108?m=":":g===114&&(v=":");let y=r.alignDelimiters===!1?1:Math.max(1,c[p]-m.length-v.length);const S=m+"-".repeat(y)+v;r.alignDelimiters!==!1&&(y=m.length+y+v.length,y>c[p]&&(c[p]=y),h[p]=y),d[p]=S}s.splice(1,0,d),n.splice(1,0,h),l=-1;const f=[];for(;++l<s.length;){const g=s[l],m=n[l];p=-1;const v=[];for(;++p<u;){const y=g[p]||"";let S="",P="";if(r.alignDelimiters!==!1){const b=c[p]-(m[p]||0),w=a[p];w===114?S=" ".repeat(b):w===99?b%2?(S=" ".repeat(b/2+.5),P=" ".repeat(b/2-.5)):(S=" ".repeat(b/2),P=S):P=" ".repeat(b)}r.delimiterStart!==!1&&!p&&v.push("|"),r.padding!==!1&&!(r.alignDelimiters===!1&&y==="")&&(r.delimiterStart!==!1||p)&&v.push(" "),r.alignDelimiters!==!1&&v.push(S),v.push(y),r.alignDelimiters!==!1&&v.push(P),r.padding!==!1&&v.push(" "),(r.delimiterEnd!==!1||p!==u-1)&&v.push("|")}f.push(r.delimiterEnd===!1?v.join("").replace(/ +$/,""):v.join(""))}return f.join(`
`)}function Wm(e){return e==null?"":String(e)}function jc(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}function Hm(e,t,r,o){const i=r.enter("blockquote"),a=r.createTracker(o);a.move("> "),a.shift(2);const s=r.indentLines(r.containerFlow(e,a.current()),Km);return i(),s}function Km(e,t,r){return">"+(r?"":" ")+e}function Jm(e,t){return qc(e,t.inConstruct,!0)&&!qc(e,t.notInConstruct,!1)}function qc(e,t,r){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return r;let o=-1;for(;++o<t.length;)if(e.includes(t[o]))return!0;return!1}function Fc(e,t,r,o){let i=-1;for(;++i<r.unsafe.length;)if(r.unsafe[i].character===`
`&&Jm(r.stack,r.unsafe[i]))return/[ \t]/.test(o.before)?"":" ";return`\\
`}function Gm(e,t){const r=String(e);let o=r.indexOf(t),i=o,a=0,s=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;o!==-1;)o===i?++a>s&&(s=a):a=1,i=o+t.length,o=r.indexOf(t,i);return s}function Qm(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function Ym(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function Zm(e,t,r,o){const i=Ym(r),a=e.value||"",s=i==="`"?"GraveAccent":"Tilde";if(Qm(e,r)){const p=r.enter("codeIndented"),d=r.indentLines(a,Xm);return p(),d}const n=r.createTracker(o),c=i.repeat(Math.max(Gm(a,i)+1,3)),u=r.enter("codeFenced");let l=n.move(c);if(e.lang){const p=r.enter(`codeFencedLang${s}`);l+=n.move(r.safe(e.lang,{before:l,after:" ",encode:["`"],...n.current()})),p()}if(e.lang&&e.meta){const p=r.enter(`codeFencedMeta${s}`);l+=n.move(" "),l+=n.move(r.safe(e.meta,{before:l,after:`
`,encode:["`"],...n.current()})),p()}return l+=n.move(`
`),a&&(l+=n.move(a+`
`)),l+=n.move(c),u(),l}function Xm(e,t,r){return(r?"":"    ")+e}function uo(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function ey(e,t,r,o){const i=uo(r),a=i==='"'?"Quote":"Apostrophe",s=r.enter("definition");let n=r.enter("label");const c=r.createTracker(o);let u=c.move("[");return u+=c.move(r.safe(r.associationId(e),{before:u,after:"]",...c.current()})),u+=c.move("]: "),n(),!e.url||/[\0- \u007F]/.test(e.url)?(n=r.enter("destinationLiteral"),u+=c.move("<"),u+=c.move(r.safe(e.url,{before:u,after:">",...c.current()})),u+=c.move(">")):(n=r.enter("destinationRaw"),u+=c.move(r.safe(e.url,{before:u,after:e.title?" ":`
`,...c.current()}))),n(),e.title&&(n=r.enter(`title${a}`),u+=c.move(" "+i),u+=c.move(r.safe(e.title,{before:u,after:i,...c.current()})),u+=c.move(i),n()),s(),u}function ty(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function tr(e){return"&#x"+e.toString(16).toUpperCase()+";"}function As(e){if(e===null||he(e)||nt(e))return 1;if(bs(e))return 2}function Ts(e,t,r){const o=As(e),i=As(t);return o===void 0?i===void 0?r==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:i===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:o===1?i===void 0?{inside:!1,outside:!1}:i===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:i===void 0?{inside:!1,outside:!1}:i===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}Bc.peek=ry;function Bc(e,t,r,o){const i=ty(r),a=r.enter("emphasis"),s=r.createTracker(o),n=s.move(i);let c=s.move(r.containerPhrasing(e,{after:i,before:n,...s.current()}));const u=c.charCodeAt(0),l=Ts(o.before.charCodeAt(o.before.length-1),u,i);l.inside&&(c=tr(u)+c.slice(1));const p=c.charCodeAt(c.length-1),d=Ts(o.after.charCodeAt(0),p,i);d.inside&&(c=c.slice(0,-1)+tr(p));const h=s.move(i);return a(),r.attentionEncodeSurroundingInfo={after:d.outside,before:l.outside},n+c+h}function ry(e,t,r){return r.options.emphasis||"*"}function ny(e,t,r,o){let i,a,s;typeof t=="function"&&typeof r!="function"?(a=void 0,s=t,i=r):(a=t,s=r,i=o),Dc(e,a,n,i);function n(c,u){const l=u[u.length-1],p=l?l.children.indexOf(c):void 0;return s(c,p,l)}}const iy={};function Uc(e,t){const r=iy,o=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,i=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return $c(e,o,i)}function $c(e,t,r){if(sy(e)){if("value"in e)return e.type==="html"&&!r?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Vc(e.children,t,r)}return Array.isArray(e)?Vc(e,t,r):""}function Vc(e,t,r){const o=[];let i=-1;for(;++i<e.length;)o[i]=$c(e[i],t,r);return o.join("")}function sy(e){return!!(e&&typeof e=="object")}function oy(e,t){let r=!1;return ny(e,function(o){if("value"in o&&/\r?\n|\r/.test(o.value)||o.type==="break")return r=!0,so}),!!((!e.depth||e.depth<3)&&Uc(e)&&(t.options.setext||r))}function ay(e,t,r,o){const i=Math.max(Math.min(6,e.depth||1),1),a=r.createTracker(o);if(oy(e,r)){const l=r.enter("headingSetext"),p=r.enter("phrasing"),d=r.containerPhrasing(e,{...a.current(),before:`
`,after:`
`});return p(),l(),d+`
`+(i===1?"=":"-").repeat(d.length-(Math.max(d.lastIndexOf("\r"),d.lastIndexOf(`
`))+1))}const s="#".repeat(i),n=r.enter("headingAtx"),c=r.enter("phrasing");a.move(s+" ");let u=r.containerPhrasing(e,{before:"# ",after:`
`,...a.current()});return/^[\t ]/.test(u)&&(u=tr(u.charCodeAt(0))+u.slice(1)),u=u?s+" "+u:s,r.options.closeAtx&&(u+=" "+s),c(),n(),u}Wc.peek=cy;function Wc(e){return e.value||""}function cy(){return"<"}Hc.peek=uy;function Hc(e,t,r,o){const i=uo(r),a=i==='"'?"Quote":"Apostrophe",s=r.enter("image");let n=r.enter("label");const c=r.createTracker(o);let u=c.move("![");return u+=c.move(r.safe(e.alt,{before:u,after:"]",...c.current()})),u+=c.move("]("),n(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(n=r.enter("destinationLiteral"),u+=c.move("<"),u+=c.move(r.safe(e.url,{before:u,after:">",...c.current()})),u+=c.move(">")):(n=r.enter("destinationRaw"),u+=c.move(r.safe(e.url,{before:u,after:e.title?" ":")",...c.current()}))),n(),e.title&&(n=r.enter(`title${a}`),u+=c.move(" "+i),u+=c.move(r.safe(e.title,{before:u,after:i,...c.current()})),u+=c.move(i),n()),u+=c.move(")"),s(),u}function uy(){return"!"}Kc.peek=ly;function Kc(e,t,r,o){const i=e.referenceType,a=r.enter("imageReference");let s=r.enter("label");const n=r.createTracker(o);let c=n.move("![");const u=r.safe(e.alt,{before:c,after:"]",...n.current()});c+=n.move(u+"]["),s();const l=r.stack;r.stack=[],s=r.enter("reference");const p=r.safe(r.associationId(e),{before:c,after:"]",...n.current()});return s(),r.stack=l,a(),i==="full"||!u||u!==p?c+=n.move(p+"]"):i==="shortcut"?c=c.slice(0,-1):c+=n.move("]"),c}function ly(){return"!"}Jc.peek=py;function Jc(e,t,r){let o=e.value||"",i="`",a=-1;for(;new RegExp("(^|[^`])"+i+"([^`]|$)").test(o);)i+="`";for(/[^ \r\n]/.test(o)&&(/^[ \r\n]/.test(o)&&/[ \r\n]$/.test(o)||/^`|`$/.test(o))&&(o=" "+o+" ");++a<r.unsafe.length;){const s=r.unsafe[a],n=r.compilePattern(s);let c;if(s.atBreak)for(;c=n.exec(o);){let u=c.index;o.charCodeAt(u)===10&&o.charCodeAt(u-1)===13&&u--,o=o.slice(0,u)+" "+o.slice(c.index+1)}}return i+o+i}function py(){return"`"}function Gc(e,t){const r=Uc(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(r===e.url||"mailto:"+r===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}Qc.peek=dy;function Qc(e,t,r,o){const i=uo(r),a=i==='"'?"Quote":"Apostrophe",s=r.createTracker(o);let n,c;if(Gc(e,r)){const l=r.stack;r.stack=[],n=r.enter("autolink");let p=s.move("<");return p+=s.move(r.containerPhrasing(e,{before:p,after:">",...s.current()})),p+=s.move(">"),n(),r.stack=l,p}n=r.enter("link"),c=r.enter("label");let u=s.move("[");return u+=s.move(r.containerPhrasing(e,{before:u,after:"](",...s.current()})),u+=s.move("]("),c(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(c=r.enter("destinationLiteral"),u+=s.move("<"),u+=s.move(r.safe(e.url,{before:u,after:">",...s.current()})),u+=s.move(">")):(c=r.enter("destinationRaw"),u+=s.move(r.safe(e.url,{before:u,after:e.title?" ":")",...s.current()}))),c(),e.title&&(c=r.enter(`title${a}`),u+=s.move(" "+i),u+=s.move(r.safe(e.title,{before:u,after:i,...s.current()})),u+=s.move(i),c()),u+=s.move(")"),n(),u}function dy(e,t,r){return Gc(e,r)?"<":"["}Yc.peek=hy;function Yc(e,t,r,o){const i=e.referenceType,a=r.enter("linkReference");let s=r.enter("label");const n=r.createTracker(o);let c=n.move("[");const u=r.containerPhrasing(e,{before:c,after:"]",...n.current()});c+=n.move(u+"]["),s();const l=r.stack;r.stack=[],s=r.enter("reference");const p=r.safe(r.associationId(e),{before:c,after:"]",...n.current()});return s(),r.stack=l,a(),i==="full"||!u||u!==p?c+=n.move(p+"]"):i==="shortcut"?c=c.slice(0,-1):c+=n.move("]"),c}function hy(){return"["}function lo(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function fy(e){const t=lo(e),r=e.options.bulletOther;if(!r)return t==="*"?"-":"*";if(r!=="*"&&r!=="+"&&r!=="-")throw new Error("Cannot serialize items with `"+r+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(r===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+r+"`) to be different");return r}function vy(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function Zc(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function gy(e,t,r,o){const i=r.enter("list"),a=r.bulletCurrent;let s=e.ordered?vy(r):lo(r);const n=e.ordered?s==="."?")":".":fy(r);let c=t&&r.bulletLastUsed?s===r.bulletLastUsed:!1;if(!e.ordered){const l=e.children?e.children[0]:void 0;if((s==="*"||s==="-")&&l&&(!l.children||!l.children[0])&&r.stack[r.stack.length-1]==="list"&&r.stack[r.stack.length-2]==="listItem"&&r.stack[r.stack.length-3]==="list"&&r.stack[r.stack.length-4]==="listItem"&&r.indexStack[r.indexStack.length-1]===0&&r.indexStack[r.indexStack.length-2]===0&&r.indexStack[r.indexStack.length-3]===0&&(c=!0),Zc(r)===s&&l){let p=-1;for(;++p<e.children.length;){const d=e.children[p];if(d&&d.type==="listItem"&&d.children&&d.children[0]&&d.children[0].type==="thematicBreak"){c=!0;break}}}}c&&(s=n),r.bulletCurrent=s;const u=r.containerFlow(e,o);return r.bulletLastUsed=s,r.bulletCurrent=a,i(),u}function my(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function yy(e,t,r,o){const i=my(r);let a=r.bulletCurrent||lo(r);t&&t.type==="list"&&t.ordered&&(a=(typeof t.start=="number"&&t.start>-1?t.start:1)+(r.options.incrementListMarker===!1?0:t.children.indexOf(e))+a);let s=a.length+1;(i==="tab"||i==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(s=Math.ceil(s/4)*4);const n=r.createTracker(o);n.move(a+" ".repeat(s-a.length)),n.shift(s);const c=r.enter("listItem"),u=r.indentLines(r.containerFlow(e,n.current()),l);return c(),u;function l(p,d,h){return d?(h?"":" ".repeat(s))+p:(h?a:a+" ".repeat(s-a.length))+p}}function Sy(e,t,r,o){const i=r.enter("paragraph"),a=r.enter("phrasing"),s=r.containerPhrasing(e,o);return a(),i(),s}const Cy=Es(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function Py(e,t,r,o){return(e.children.some(function(s){return Cy(s)})?r.containerPhrasing:r.containerFlow).call(r,e,o)}function Ry(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}Xc.peek=by;function Xc(e,t,r,o){const i=Ry(r),a=r.enter("strong"),s=r.createTracker(o),n=s.move(i+i);let c=s.move(r.containerPhrasing(e,{after:i,before:n,...s.current()}));const u=c.charCodeAt(0),l=Ts(o.before.charCodeAt(o.before.length-1),u,i);l.inside&&(c=tr(u)+c.slice(1));const p=c.charCodeAt(c.length-1),d=Ts(o.after.charCodeAt(0),p,i);d.inside&&(c=c.slice(0,-1)+tr(p));const h=s.move(i+i);return a(),r.attentionEncodeSurroundingInfo={after:d.outside,before:l.outside},n+c+h}function by(e,t,r){return r.options.strong||"*"}function wy(e,t,r,o){return r.safe(e.value,o)}function Ey(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function Iy(e,t,r){const o=(Zc(r)+(r.options.ruleSpaces?" ":"")).repeat(Ey(r));return r.options.ruleSpaces?o.slice(0,-1):o}const eu={blockquote:Hm,break:Fc,code:Zm,definition:ey,emphasis:Bc,hardBreak:Fc,heading:ay,html:Wc,image:Hc,imageReference:Kc,inlineCode:Jc,link:Qc,linkReference:Yc,list:gy,listItem:yy,paragraph:Sy,root:Py,strong:Xc,text:wy,thematicBreak:Iy};function Ay(){return{enter:{table:Ty,tableData:tu,tableHeader:tu,tableRow:ky},exit:{codeText:Oy,table:_y,tableData:po,tableHeader:po,tableRow:po}}}function Ty(e){const t=e._align;this.enter({type:"table",align:t.map(function(r){return r==="none"?null:r}),children:[]},e),this.data.inTable=!0}function _y(e){this.exit(e),this.data.inTable=void 0}function ky(e){this.enter({type:"tableRow",children:[]},e)}function po(e){this.exit(e)}function tu(e){this.enter({type:"tableCell",children:[]},e)}function Oy(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,My));const r=this.stack[this.stack.length-1];r.type,r.value=t,this.exit(e)}function My(e,t){return t==="|"?t:e}function Dy(e){const t=e||{},r=t.tableCellPadding,o=t.tablePipeAlign,i=t.stringLength,a=r?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:d,table:s,tableCell:c,tableRow:n}};function s(h,f,g,m){return u(l(h,g,m),h.align)}function n(h,f,g,m){const v=p(h,g,m),y=u([v]);return y.slice(0,y.indexOf(`
`))}function c(h,f,g,m){const v=g.enter("tableCell"),y=g.enter("phrasing"),S=g.containerPhrasing(h,{...m,before:a,after:a});return y(),v(),S}function u(h,f){return Vm(h,{align:f,alignDelimiters:o,padding:r,stringLength:i})}function l(h,f,g){const m=h.children;let v=-1;const y=[],S=f.enter("table");for(;++v<m.length;)y[v]=p(m[v],f,g);return S(),y}function p(h,f,g){const m=h.children;let v=-1;const y=[],S=f.enter("tableRow");for(;++v<m.length;)y[v]=c(m[v],h,f,g);return S(),y}function d(h,f,g){let m=eu.inlineCode(h,f,g);return g.stack.includes("tableCell")&&(m=m.replace(/\|/g,"\\$&")),m}}function Ny(){return{exit:{taskListCheckValueChecked:ru,taskListCheckValueUnchecked:ru,paragraph:zy}}}function xy(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:Ly}}}function ru(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function zy(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const r=this.stack[this.stack.length-1];r.type;const o=r.children[0];if(o&&o.type==="text"){const i=t.children;let a=-1,s;for(;++a<i.length;){const n=i[a];if(n.type==="paragraph"){s=n;break}}s===r&&(o.value=o.value.slice(1),o.value.length===0?r.children.shift():r.position&&o.position&&typeof o.position.start.offset=="number"&&(o.position.start.column++,o.position.start.offset++,r.position.start=Object.assign({},o.position.start)))}}this.exit(e)}function Ly(e,t,r,o){const i=e.children[0],a=typeof e.checked=="boolean"&&i&&i.type==="paragraph",s="["+(e.checked?"x":" ")+"] ",n=r.createTracker(o);a&&n.move(s);let c=eu.listItem(e,t,r,{...o,...n.current()});return a&&(c=c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),c;function u(l){return l+s}}function jy(){return[hm(),Nm(),jm(),Ay(),Ny()]}function qy(e){return{extensions:[fm(),xm(e),qm(),Dy(e),xy()]}}function _s(e,t,r,o){const i=e.length;let a=0,s;if(t<0?t=-t>i?0:i+t:t=t>i?i:t,r=r>0?r:0,o.length<1e4)s=Array.from(o),s.unshift(t,r),e.splice(...s);else for(r&&e.splice(t,r);a<o.length;)s=o.slice(a,a+1e4),s.unshift(t,0),e.splice(...s),a+=1e4,t+=1e4}const nu={}.hasOwnProperty;function Fy(e){const t={};let r=-1;for(;++r<e.length;)By(t,e[r]);return t}function By(e,t){let r;for(r in t){const i=(nu.call(e,r)?e[r]:void 0)||(e[r]={}),a=t[r];let s;if(a)for(s in a){nu.call(i,s)||(i[s]=[]);const n=a[s];Uy(i[s],Array.isArray(n)?n:n?[n]:[])}}}function Uy(e,t){let r=-1;const o=[];for(;++r<t.length;)(t[r].add==="after"?e:o).push(t[r]);_s(e,0,0,o)}const $y={tokenize:Gy,partial:!0},iu={tokenize:Qy,partial:!0},su={tokenize:Yy,partial:!0},ou={tokenize:Zy,partial:!0},Vy={tokenize:Xy,partial:!0},au={name:"wwwAutolink",tokenize:Ky,previous:uu},cu={name:"protocolAutolink",tokenize:Jy,previous:lu},Le={name:"emailAutolink",tokenize:Hy,previous:pu},Oe={};function Wy(){return{text:Oe}}let it=48;for(;it<123;)Oe[it]=Le,it++,it===58?it=65:it===91&&(it=97);Oe[43]=Le,Oe[45]=Le,Oe[46]=Le,Oe[95]=Le,Oe[72]=[Le,cu],Oe[104]=[Le,cu],Oe[87]=[Le,au],Oe[119]=[Le,au];function Hy(e,t,r){const o=this;let i,a;return s;function s(p){return!ho(p)||!pu.call(o,o.previous)||fo(o.events)?r(p):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),n(p))}function n(p){return ho(p)?(e.consume(p),n):p===64?(e.consume(p),c):r(p)}function c(p){return p===46?e.check(Vy,l,u)(p):p===45||p===95||io(p)?(a=!0,e.consume(p),c):l(p)}function u(p){return e.consume(p),i=!0,c}function l(p){return a&&i&&Xt(o.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(p)):r(p)}}function Ky(e,t,r){const o=this;return i;function i(s){return s!==87&&s!==119||!uu.call(o,o.previous)||fo(o.events)?r(s):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check($y,e.attempt(iu,e.attempt(su,a),r),r)(s))}function a(s){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(s)}}function Jy(e,t,r){const o=this;let i="",a=!1;return s;function s(p){return(p===72||p===104)&&lu.call(o,o.previous)&&!fo(o.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),i+=String.fromCodePoint(p),e.consume(p),n):r(p)}function n(p){if(Xt(p)&&i.length<5)return i+=String.fromCodePoint(p),e.consume(p),n;if(p===58){const d=i.toLowerCase();if(d==="http"||d==="https")return e.consume(p),c}return r(p)}function c(p){return p===47?(e.consume(p),a?u:(a=!0,c)):r(p)}function u(p){return p===null||Xg(p)||he(p)||nt(p)||bs(p)?r(p):e.attempt(iu,e.attempt(su,l),r)(p)}function l(p){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(p)}}function Gy(e,t,r){let o=0;return i;function i(s){return(s===87||s===119)&&o<3?(o++,e.consume(s),i):s===46&&o===3?(e.consume(s),a):r(s)}function a(s){return s===null?r(s):t(s)}}function Qy(e,t,r){let o,i,a;return s;function s(u){return u===46||u===95?e.check(ou,c,n)(u):u===null||he(u)||nt(u)||u!==45&&bs(u)?c(u):(a=!0,e.consume(u),s)}function n(u){return u===95?o=!0:(i=o,o=void 0),e.consume(u),s}function c(u){return i||o||!a?r(u):t(u)}}function Yy(e,t){let r=0,o=0;return i;function i(s){return s===40?(r++,e.consume(s),i):s===41&&o<r?a(s):s===33||s===34||s===38||s===39||s===41||s===42||s===44||s===46||s===58||s===59||s===60||s===63||s===93||s===95||s===126?e.check(ou,t,a)(s):s===null||he(s)||nt(s)?t(s):(e.consume(s),i)}function a(s){return s===41&&o++,e.consume(s),i}}function Zy(e,t,r){return o;function o(n){return n===33||n===34||n===39||n===41||n===42||n===44||n===46||n===58||n===59||n===63||n===95||n===126?(e.consume(n),o):n===38?(e.consume(n),a):n===93?(e.consume(n),i):n===60||n===null||he(n)||nt(n)?t(n):r(n)}function i(n){return n===null||n===40||n===91||he(n)||nt(n)?t(n):o(n)}function a(n){return Xt(n)?s(n):r(n)}function s(n){return n===59?(e.consume(n),o):Xt(n)?(e.consume(n),s):r(n)}}function Xy(e,t,r){return o;function o(a){return e.consume(a),i}function i(a){return io(a)?r(a):t(a)}}function uu(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||he(e)}function lu(e){return!Xt(e)}function pu(e){return!(e===47||ho(e))}function ho(e){return e===43||e===45||e===46||e===95||io(e)}function fo(e){let t=e.length,r=!1;for(;t--;){const o=e[t][1];if((o.type==="labelLink"||o.type==="labelImage")&&!o._balanced){r=!0;break}if(o._gfmAutolinkLiteralWalkedInto){r=!1;break}}return e.length>0&&!r&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),r}function eS(e,t,r){const o=[];let i=-1;for(;++i<e.length;){const a=e[i].resolveAll;a&&!o.includes(a)&&(t=a(t,r),o.push(a))}return t}function je(e,t,r,o){const i=o?o-1:Number.POSITIVE_INFINITY;let a=0;return s;function s(c){return ze(c)?(e.enter(r),n(c)):t(c)}function n(c){return ze(c)&&a++<i?(e.consume(c),n):(e.exit(r),t(c))}}const tS={partial:!0,tokenize:rS};function rS(e,t,r){return o;function o(a){return ze(a)?je(e,i,"linePrefix")(a):i(a)}function i(a){return a===null||Bt(a)?t(a):r(a)}}const nS={tokenize:pS,partial:!0};function iS(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:cS,continuation:{tokenize:uS},exit:lS}},text:{91:{name:"gfmFootnoteCall",tokenize:aS},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:sS,resolveTo:oS}}}}function sS(e,t,r){const o=this;let i=o.events.length;const a=o.parser.gfmFootnotes||(o.parser.gfmFootnotes=[]);let s;for(;i--;){const c=o.events[i][1];if(c.type==="labelImage"){s=c;break}if(c.type==="gfmFootnoteCall"||c.type==="labelLink"||c.type==="label"||c.type==="image"||c.type==="link")break}return n;function n(c){if(!s||!s._balanced)return r(c);const u=er(o.sliceSerialize({start:s.end,end:o.now()}));return u.codePointAt(0)!==94||!a.includes(u.slice(1))?r(c):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(c),e.exit("gfmFootnoteCallLabelMarker"),t(c))}}function oS(e,t){let r=e.length;for(;r--;)if(e[r][1].type==="labelImage"&&e[r][0]==="enter"){e[r][1];break}e[r+1][1].type="data",e[r+3][1].type="gfmFootnoteCallLabelMarker";const o={type:"gfmFootnoteCall",start:Object.assign({},e[r+3][1].start),end:Object.assign({},e[e.length-1][1].end)},i={type:"gfmFootnoteCallMarker",start:Object.assign({},e[r+3][1].end),end:Object.assign({},e[r+3][1].end)};i.end.column++,i.end.offset++,i.end._bufferIndex++;const a={type:"gfmFootnoteCallString",start:Object.assign({},i.end),end:Object.assign({},e[e.length-1][1].start)},s={type:"chunkString",contentType:"string",start:Object.assign({},a.start),end:Object.assign({},a.end)},n=[e[r+1],e[r+2],["enter",o,t],e[r+3],e[r+4],["enter",i,t],["exit",i,t],["enter",a,t],["enter",s,t],["exit",s,t],["exit",a,t],e[e.length-2],e[e.length-1],["exit",o,t]];return e.splice(r,e.length-r+1,...n),e}function aS(e,t,r){const o=this,i=o.parser.gfmFootnotes||(o.parser.gfmFootnotes=[]);let a=0,s;return n;function n(p){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(p),e.exit("gfmFootnoteCallLabelMarker"),c}function c(p){return p!==94?r(p):(e.enter("gfmFootnoteCallMarker"),e.consume(p),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(p){if(a>999||p===93&&!s||p===null||p===91||he(p))return r(p);if(p===93){e.exit("chunkString");const d=e.exit("gfmFootnoteCallString");return i.includes(er(o.sliceSerialize(d)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(p),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):r(p)}return he(p)||(s=!0),a++,e.consume(p),p===92?l:u}function l(p){return p===91||p===92||p===93?(e.consume(p),a++,u):u(p)}}function cS(e,t,r){const o=this,i=o.parser.gfmFootnotes||(o.parser.gfmFootnotes=[]);let a,s=0,n;return c;function c(f){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(f),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(f){return f===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(f),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",l):r(f)}function l(f){if(s>999||f===93&&!n||f===null||f===91||he(f))return r(f);if(f===93){e.exit("chunkString");const g=e.exit("gfmFootnoteDefinitionLabelString");return a=er(o.sliceSerialize(g)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(f),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),d}return he(f)||(n=!0),s++,e.consume(f),f===92?p:l}function p(f){return f===91||f===92||f===93?(e.consume(f),s++,l):l(f)}function d(f){return f===58?(e.enter("definitionMarker"),e.consume(f),e.exit("definitionMarker"),i.includes(a)||i.push(a),je(e,h,"gfmFootnoteDefinitionWhitespace")):r(f)}function h(f){return t(f)}}function uS(e,t,r){return e.check(tS,t,e.attempt(nS,t,r))}function lS(e){e.exit("gfmFootnoteDefinition")}function pS(e,t,r){const o=this;return je(e,i,"gfmFootnoteDefinitionIndent",5);function i(a){const s=o.events[o.events.length-1];return s&&s[1].type==="gfmFootnoteDefinitionIndent"&&s[2].sliceSerialize(s[1],!0).length===4?t(a):r(a)}}function dS(e){let r=(e||{}).singleTilde;const o={name:"strikethrough",tokenize:a,resolveAll:i};return r==null&&(r=!0),{text:{126:o},insideSpan:{null:[o]},attentionMarkers:{null:[126]}};function i(s,n){let c=-1;for(;++c<s.length;)if(s[c][0]==="enter"&&s[c][1].type==="strikethroughSequenceTemporary"&&s[c][1]._close){let u=c;for(;u--;)if(s[u][0]==="exit"&&s[u][1].type==="strikethroughSequenceTemporary"&&s[u][1]._open&&s[c][1].end.offset-s[c][1].start.offset===s[u][1].end.offset-s[u][1].start.offset){s[c][1].type="strikethroughSequence",s[u][1].type="strikethroughSequence";const l={type:"strikethrough",start:Object.assign({},s[u][1].start),end:Object.assign({},s[c][1].end)},p={type:"strikethroughText",start:Object.assign({},s[u][1].end),end:Object.assign({},s[c][1].start)},d=[["enter",l,n],["enter",s[u][1],n],["exit",s[u][1],n],["enter",p,n]],h=n.parser.constructs.insideSpan.null;h&&_s(d,d.length,0,eS(h,s.slice(u+1,c),n)),_s(d,d.length,0,[["exit",p,n],["enter",s[c][1],n],["exit",s[c][1],n],["exit",l,n]]),_s(s,u-1,c-u+3,d),c=u+d.length-2;break}}for(c=-1;++c<s.length;)s[c][1].type==="strikethroughSequenceTemporary"&&(s[c][1].type="data");return s}function a(s,n,c){const u=this.previous,l=this.events;let p=0;return d;function d(f){return u===126&&l[l.length-1][1].type!=="characterEscape"?c(f):(s.enter("strikethroughSequenceTemporary"),h(f))}function h(f){const g=As(u);if(f===126)return p>1?c(f):(s.consume(f),p++,h);if(p<2&&!r)return c(f);const m=s.exit("strikethroughSequenceTemporary"),v=As(f);return m._open=!v||v===2&&!!g,m._close=!g||g===2&&!!v,n(f)}}}class hS{constructor(){this.map=[]}add(t,r,o){fS(this,t,r,o)}consume(t){if(this.map.sort(function(a,s){return a[0]-s[0]}),this.map.length===0)return;let r=this.map.length;const o=[];for(;r>0;)r-=1,o.push(t.slice(this.map[r][0]+this.map[r][1]),this.map[r][2]),t.length=this.map[r][0];o.push(t.slice()),t.length=0;let i=o.pop();for(;i;){for(const a of i)t.push(a);i=o.pop()}this.map.length=0}}function fS(e,t,r,o){let i=0;if(!(r===0&&o.length===0)){for(;i<e.map.length;){if(e.map[i][0]===t){e.map[i][1]+=r,e.map[i][2].push(...o);return}i+=1}e.map.push([t,r,o])}}function vS(e,t){let r=!1;const o=[];for(;t<e.length;){const i=e[t];if(r){if(i[0]==="enter")i[1].type==="tableContent"&&o.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(i[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const a=o.length-1;o[a]=o[a]==="left"?"center":"right"}}else if(i[1].type==="tableDelimiterRow")break}else i[0]==="enter"&&i[1].type==="tableDelimiterRow"&&(r=!0);t+=1}return o}function gS(){return{flow:{null:{name:"table",tokenize:mS,resolveAll:yS}}}}function mS(e,t,r){const o=this;let i=0,a=0,s;return n;function n(R){let M=o.events.length-1;for(;M>-1;){const F=o.events[M][1].type;if(F==="lineEnding"||F==="linePrefix")M--;else break}const _=M>-1?o.events[M][1].type:null,z=_==="tableHead"||_==="tableRow"?w:c;return z===w&&o.parser.lazy[o.now().line]?r(R):z(R)}function c(R){return e.enter("tableHead"),e.enter("tableRow"),u(R)}function u(R){return R===124||(s=!0,a+=1),l(R)}function l(R){return R===null?r(R):Bt(R)?a>1?(a=0,o.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(R),e.exit("lineEnding"),h):r(R):ze(R)?je(e,l,"whitespace")(R):(a+=1,s&&(s=!1,i+=1),R===124?(e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),s=!0,l):(e.enter("data"),p(R)))}function p(R){return R===null||R===124||he(R)?(e.exit("data"),l(R)):(e.consume(R),R===92?d:p)}function d(R){return R===92||R===124?(e.consume(R),p):p(R)}function h(R){return o.interrupt=!1,o.parser.lazy[o.now().line]?r(R):(e.enter("tableDelimiterRow"),s=!1,ze(R)?je(e,f,"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(R):f(R))}function f(R){return R===45||R===58?m(R):R===124?(s=!0,e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),g):b(R)}function g(R){return ze(R)?je(e,m,"whitespace")(R):m(R)}function m(R){return R===58?(a+=1,s=!0,e.enter("tableDelimiterMarker"),e.consume(R),e.exit("tableDelimiterMarker"),v):R===45?(a+=1,v(R)):R===null||Bt(R)?P(R):b(R)}function v(R){return R===45?(e.enter("tableDelimiterFiller"),y(R)):b(R)}function y(R){return R===45?(e.consume(R),y):R===58?(s=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(R),e.exit("tableDelimiterMarker"),S):(e.exit("tableDelimiterFiller"),S(R))}function S(R){return ze(R)?je(e,P,"whitespace")(R):P(R)}function P(R){return R===124?f(R):R===null||Bt(R)?!s||i!==a?b(R):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(R)):b(R)}function b(R){return r(R)}function w(R){return e.enter("tableRow"),A(R)}function A(R){return R===124?(e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),A):R===null||Bt(R)?(e.exit("tableRow"),t(R)):ze(R)?je(e,A,"whitespace")(R):(e.enter("data"),E(R))}function E(R){return R===null||R===124||he(R)?(e.exit("data"),A(R)):(e.consume(R),R===92?D:E)}function D(R){return R===92||R===124?(e.consume(R),E):E(R)}}function yS(e,t){let r=-1,o=!0,i=0,a=[0,0,0,0],s=[0,0,0,0],n=!1,c=0,u,l,p;const d=new hS;for(;++r<e.length;){const h=e[r],f=h[1];h[0]==="enter"?f.type==="tableHead"?(n=!1,c!==0&&(du(d,t,c,u,l),l=void 0,c=0),u={type:"table",start:Object.assign({},f.start),end:Object.assign({},f.end)},d.add(r,0,[["enter",u,t]])):f.type==="tableRow"||f.type==="tableDelimiterRow"?(o=!0,p=void 0,a=[0,0,0,0],s=[0,r+1,0,0],n&&(n=!1,l={type:"tableBody",start:Object.assign({},f.start),end:Object.assign({},f.end)},d.add(r,0,[["enter",l,t]])),i=f.type==="tableDelimiterRow"?2:l?3:1):i&&(f.type==="data"||f.type==="tableDelimiterMarker"||f.type==="tableDelimiterFiller")?(o=!1,s[2]===0&&(a[1]!==0&&(s[0]=s[1],p=ks(d,t,a,i,void 0,p),a=[0,0,0,0]),s[2]=r)):f.type==="tableCellDivider"&&(o?o=!1:(a[1]!==0&&(s[0]=s[1],p=ks(d,t,a,i,void 0,p)),a=s,s=[a[1],r,0,0])):f.type==="tableHead"?(n=!0,c=r):f.type==="tableRow"||f.type==="tableDelimiterRow"?(c=r,a[1]!==0?(s[0]=s[1],p=ks(d,t,a,i,r,p)):s[1]!==0&&(p=ks(d,t,s,i,r,p)),i=0):i&&(f.type==="data"||f.type==="tableDelimiterMarker"||f.type==="tableDelimiterFiller")&&(s[3]=r)}for(c!==0&&du(d,t,c,u,l),d.consume(t.events),r=-1;++r<t.events.length;){const h=t.events[r];h[0]==="enter"&&h[1].type==="table"&&(h[1]._align=vS(t.events,r))}return e}function ks(e,t,r,o,i,a){const s=o===1?"tableHeader":o===2?"tableDelimiter":"tableData",n="tableContent";r[0]!==0&&(a.end=Object.assign({},Ut(t.events,r[0])),e.add(r[0],0,[["exit",a,t]]));const c=Ut(t.events,r[1]);if(a={type:s,start:Object.assign({},c),end:Object.assign({},c)},e.add(r[1],0,[["enter",a,t]]),r[2]!==0){const u=Ut(t.events,r[2]),l=Ut(t.events,r[3]),p={type:n,start:Object.assign({},u),end:Object.assign({},l)};if(e.add(r[2],0,[["enter",p,t]]),o!==2){const d=t.events[r[2]],h=t.events[r[3]];if(d[1].end=Object.assign({},h[1].end),d[1].type="chunkText",d[1].contentType="text",r[3]>r[2]+1){const f=r[2]+1,g=r[3]-r[2]-1;e.add(f,g,[])}}e.add(r[3]+1,0,[["exit",p,t]])}return i!==void 0&&(a.end=Object.assign({},Ut(t.events,i)),e.add(i,0,[["exit",a,t]]),a=void 0),a}function du(e,t,r,o,i){const a=[],s=Ut(t.events,r);i&&(i.end=Object.assign({},s),a.push(["exit",i,t])),o.end=Object.assign({},s),a.push(["exit",o,t]),e.add(r+1,0,a)}function Ut(e,t){const r=e[t],o=r[0]==="enter"?"start":"end";return r[1][o]}const SS={name:"tasklistCheck",tokenize:PS};function CS(){return{text:{91:SS}}}function PS(e,t,r){const o=this;return i;function i(c){return o.previous!==null||!o._gfmTasklistFirstContentOfListItem?r(c):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),a)}function a(c){return he(c)?(e.enter("taskListCheckValueUnchecked"),e.consume(c),e.exit("taskListCheckValueUnchecked"),s):c===88||c===120?(e.enter("taskListCheckValueChecked"),e.consume(c),e.exit("taskListCheckValueChecked"),s):r(c)}function s(c){return c===93?(e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),n):r(c)}function n(c){return Bt(c)?t(c):ze(c)?e.check({tokenize:RS},t,r)(c):r(c)}}function RS(e,t,r){return je(e,o,"whitespace");function o(i){return i===null?r(i):t(i)}}function bS(e){return Fy([Wy(),iS(),dS(e),gS(),CS()])}const wS={};function vo(e){const t=this,r=e||wS,o=t.data(),i=o.micromarkExtensions||(o.micromarkExtensions=[]),a=o.fromMarkdownExtensions||(o.fromMarkdownExtensions=[]),s=o.toMarkdownExtensions||(o.toMarkdownExtensions=[]);i.push(bS(r)),a.push(jy()),s.push(qy(r))}const Os=async(e,t,r="en",o,i,a)=>{try{const n=`${i.replace(/\/+$/,"")}/translate?api-version=3.0&from=${r}&to=${t}`,c=await fetch(n,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":o,"Ocp-Apim-Subscription-Region":a,"Content-Type":"application/json"},body:JSON.stringify(e.map(l=>({Text:l})))});if(!c.ok)throw new Error(`Translation failed: ${c.statusText}`);return(await c.json()).map(l=>l.translations?.[0]?.text||"")}catch(s){return console.error("Batch translation error:",s),e}};function ES({messages:e,welcomeMessage:t,onSendMessage:r,className:o="",isLoading:i=!1,rightElement:a,suggestedPrompts:s,renderMessage:n,showRetryButton:c=!1,handleRetry:u,setInterruptReplica:l,language:p,config:d}){const[h,f]=I.useState(""),g=I.useRef(null),[m,v]=I.useState(!0),y=I.useRef(null),S=I.useRef(null),[P,b]=I.useState({insufficientCredits:"Insufficient Credits",insufficientCreditsDescription:"Please purchase more credits to continue.",placeholder:"Type your message...",suggestedPrompts:"Suggested Prompts",thinking:"Thinking...",retry:"Retry"});I.useEffect(()=>{if(g.current){const R=g.current.closest("[data-radix-scroll-area-viewport]")||y.current;R&&(R.scrollTop=R.scrollHeight)}},[e,i]),I.useEffect(()=>{(async()=>{if(p!=="en"&&S.current!==p){const[M,_,z,F,Q,ee]=await Os(["Insufficient Credits","Please purchase more credits to continue.","Type your message...","Suggested Prompts","Thinking...","Retry","Hi there! I'm your personal health navigator. I can help you understand your lab results, explain medical terminology, and provide personalized health insights. Go ahead and upload any lab test or medical report. If you dont have one, lets just talk."],p,"en",d?.azureTranslatorKey||"",d?.azureTranslatorEndpoint||"",d?.azureTranslatorRegion||"");b({insufficientCredits:M,insufficientCreditsDescription:_,placeholder:z,suggestedPrompts:F,thinking:Q,retry:ee}),S.current=p}p==="en"&&S.current!=="en"&&(b({insufficientCredits:"Insufficient Credits",insufficientCreditsDescription:"Please purchase more credits to continue.",placeholder:"Type your message...",suggestedPrompts:"Suggested Prompts",thinking:"Thinking...",retry:"Retry"}),S.current="en")})()},[p,d]);const w=()=>{h.trim()===""||i||(r(h),f(""))},A=R=>{R.key==="Enter"&&!R.shiftKey&&(R.preventDefault(),w())},E=R=>{f(R)},D=()=>{v(!m)};return C.jsxs("div",{className:`flex flex-col h-full bg-white rounded-lg border border-primary/20 overflow-hidden ${o}`,children:[C.jsx("div",{ref:y,className:"flex-1 overflow-y-auto p-3 bg-white/80",children:C.jsxs("div",{className:"space-y-3",children:[e?.length===0?C.jsxs("div",{className:"flex items-start",children:[C.jsx("div",{className:"w-8 h-8 rounded-full bg-primary flex items-center justify-center text-white flex-shrink-0",children:C.jsx(X.Bot,{size:14})}),C.jsx("div",{className:"ml-2 px-3 py-2 rounded-lg bg-secondary/10",children:C.jsx("div",{className:"text-sm text-secondary",children:t})})]}):e?.map((R,M)=>{const z=M===e.length-1&&R.sender==="ai",F=c&&z&&u&&R.sender==="ai";return C.jsx("div",{className:Zt("flex",R.sender==="user"?"justify-end":"justify-start","mb-4"),children:C.jsxs("div",{className:Zt("max-w-[80%] rounded-lg p-3",R.sender==="user"?"bg-primary text-white":"bg-light text-secondary"),children:[n?n(R,M):R.sender==="user"?C.jsx("div",{className:"text-sm",children:R.text}):C.jsx("div",{className:"text-sm",children:C.jsx(eo,{remarkPlugins:[vo],children:R.text})}),F&&C.jsx("div",{className:"mt-2 flex justify-end",children:C.jsxs(ke,{variant:"ghost",size:"sm",onClick:u,className:"h-6 px-2 text-xs hover:bg-secondary/20",children:[C.jsx(X.RotateCcw,{className:"h-3 w-3 mr-1"}),P.retry]})})]})},R.id)}),i&&C.jsxs("div",{className:"flex items-start",children:[C.jsx("div",{className:"w-8 h-8 rounded-full bg-primary flex items-center justify-center text-white flex-shrink-0",children:C.jsx(X.Bot,{size:14})}),C.jsxs("div",{className:"ml-2 px-3 py-2 rounded-lg bg-secondary/10 flex items-center",children:[C.jsx(X.Loader2,{className:"h-4 w-4 animate-spin mr-2 text-primary"}),C.jsx("span",{className:"text-sm text-secondary",children:P.thinking})]})]}),C.jsx("div",{ref:g})]})}),C.jsxs("div",{className:"p-3 border-t border-light bg-white flex-shrink-0",children:[s&&s?.length>0&&C.jsxs("div",{className:"bg-white border-b border-light flex-shrink-0",children:[C.jsxs("button",{onClick:D,className:"w-full p-2 flex items-center justify-center hover:bg-secondary/10 transition-colors",children:[C.jsx("span",{className:"text-sm font-medium text-secondary",children:P.suggestedPrompts}),m?C.jsx(X.ChevronDown,{className:"h-4 w-4 text-secondary"}):C.jsx(X.ChevronUp,{className:"h-4 w-4 text-secondary"})]}),!m&&C.jsx("div",{className:"p-3 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2",children:s.map(({id:R,text:M,icon:_})=>C.jsxs(ke,{variant:"outline",className:Zt("w-full justify-start text-left text-sm h-auto min-h-[40px] py-2 px-3","whitespace-normal break-words"),onClick:()=>E(M),children:[C.jsx(_,{className:"h-4 w-4 mr-2 text-primary flex-shrink-0"}),C.jsx("span",{className:"text-left",children:M})]},R))})]}),C.jsxs("div",{className:"flex items-end",children:[C.jsx("textarea",{value:h,onChange:R=>{f(R.target.value),l(!0),R.target.style.height="auto",R.target.style.height=Math.min(R.target.scrollHeight,120)+"px"},onKeyDown:A,placeholder:P.placeholder,className:"flex-1 rounded-l-lg rounded-r-none focus-visible:ring-0 focus-visible:ring-offset-0 border-r-0 resize-none min-h-[40px] max-h-[120px] p-3 text-sm border border-input bg-background ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",disabled:i||!1,rows:1}),C.jsx(ke,{onClick:w,className:"rounded-l-none bg-primary hover:bg-secondary h-[40px]",disabled:h.trim()===""||i,children:i?C.jsx(X.Loader2,{className:"h-5 w-5 animate-spin"}):C.jsx(X.Send,{size:18})}),a&&C.jsx("div",{className:"ml-2",children:a})]})]})]})}function IS(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function o(){var i=!1;try{i=this instanceof o}catch{}return i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(o){var i=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(r,o,i.get?i:{enumerable:!0,get:function(){return e[o]}})}),r}var st={},ot={},rr={},at={},J={},go={},ct={},mo={},nr={},Ms={},hu;function fu(){if(hu)return Ms;hu=1,Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.default=r;let e;const t=new Uint8Array(16);function r(){if(!e&&(e=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!e))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(t)}return Ms}var $t={},ir={},sr={},vu;function AS(){if(vu)return sr;vu=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.default=void 0;var e=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;return sr.default=e,sr}var gu;function Ds(){if(gu)return ir;gu=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.default=void 0;var e=t(AS());function t(i){return i&&i.__esModule?i:{default:i}}function r(i){return typeof i=="string"&&e.default.test(i)}var o=r;return ir.default=o,ir}var mu;function Ns(){if(mu)return $t;mu=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.default=void 0,$t.unsafeStringify=o;var e=t(Ds());function t(s){return s&&s.__esModule?s:{default:s}}const r=[];for(let s=0;s<256;++s)r.push((s+256).toString(16).slice(1));function o(s,n=0){return r[s[n+0]]+r[s[n+1]]+r[s[n+2]]+r[s[n+3]]+"-"+r[s[n+4]]+r[s[n+5]]+"-"+r[s[n+6]]+r[s[n+7]]+"-"+r[s[n+8]]+r[s[n+9]]+"-"+r[s[n+10]]+r[s[n+11]]+r[s[n+12]]+r[s[n+13]]+r[s[n+14]]+r[s[n+15]]}function i(s,n=0){const c=o(s,n);if(!(0,e.default)(c))throw TypeError("Stringified UUID is invalid");return c}var a=i;return $t.default=a,$t}var yu;function TS(){if(yu)return nr;yu=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.default=void 0;var e=r(fu()),t=Ns();function r(u){return u&&u.__esModule?u:{default:u}}let o,i,a=0,s=0;function n(u,l,p){let d=l&&p||0;const h=l||new Array(16);u=u||{};let f=u.node||o,g=u.clockseq!==void 0?u.clockseq:i;if(f==null||g==null){const b=u.random||(u.rng||e.default)();f==null&&(f=o=[b[0]|1,b[1],b[2],b[3],b[4],b[5]]),g==null&&(g=i=(b[6]<<8|b[7])&16383)}let m=u.msecs!==void 0?u.msecs:Date.now(),v=u.nsecs!==void 0?u.nsecs:s+1;const y=m-a+(v-s)/1e4;if(y<0&&u.clockseq===void 0&&(g=g+1&16383),(y<0||m>a)&&u.nsecs===void 0&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=m,s=v,i=g,m+=122192928e5;const S=((m&268435455)*1e4+v)%4294967296;h[d++]=S>>>24&255,h[d++]=S>>>16&255,h[d++]=S>>>8&255,h[d++]=S&255;const P=m/4294967296*1e4&268435455;h[d++]=P>>>8&255,h[d++]=P&255,h[d++]=P>>>24&15|16,h[d++]=P>>>16&255,h[d++]=g>>>8|128,h[d++]=g&255;for(let b=0;b<6;++b)h[d+b]=f[b];return l||(0,t.unsafeStringify)(h)}var c=n;return nr.default=c,nr}var or={},Je={},ar={},Su;function Cu(){if(Su)return ar;Su=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.default=void 0;var e=t(Ds());function t(i){return i&&i.__esModule?i:{default:i}}function r(i){if(!(0,e.default)(i))throw TypeError("Invalid UUID");let a;const s=new Uint8Array(16);return s[0]=(a=parseInt(i.slice(0,8),16))>>>24,s[1]=a>>>16&255,s[2]=a>>>8&255,s[3]=a&255,s[4]=(a=parseInt(i.slice(9,13),16))>>>8,s[5]=a&255,s[6]=(a=parseInt(i.slice(14,18),16))>>>8,s[7]=a&255,s[8]=(a=parseInt(i.slice(19,23),16))>>>8,s[9]=a&255,s[10]=(a=parseInt(i.slice(24,36),16))/1099511627776&255,s[11]=a/4294967296&255,s[12]=a>>>24&255,s[13]=a>>>16&255,s[14]=a>>>8&255,s[15]=a&255,s}var o=r;return ar.default=o,ar}var Pu;function Ru(){if(Pu)return Je;Pu=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.URL=Je.DNS=void 0,Je.default=s;var e=Ns(),t=r(Cu());function r(n){return n&&n.__esModule?n:{default:n}}function o(n){n=unescape(encodeURIComponent(n));const c=[];for(let u=0;u<n.length;++u)c.push(n.charCodeAt(u));return c}const i="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Je.DNS=i;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Je.URL=a;function s(n,c,u){function l(p,d,h,f){var g;if(typeof p=="string"&&(p=o(p)),typeof d=="string"&&(d=(0,t.default)(d)),((g=d)===null||g===void 0?void 0:g.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let m=new Uint8Array(16+p.length);if(m.set(d),m.set(p,d.length),m=u(m),m[6]=m[6]&15|c,m[8]=m[8]&63|128,h){f=f||0;for(let v=0;v<16;++v)h[f+v]=m[v];return h}return(0,e.unsafeStringify)(m)}try{l.name=n}catch{}return l.DNS=i,l.URL=a,l}return Je}var cr={},bu;function _S(){if(bu)return cr;bu=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.default=void 0;function e(h){if(typeof h=="string"){const f=unescape(encodeURIComponent(h));h=new Uint8Array(f.length);for(let g=0;g<f.length;++g)h[g]=f.charCodeAt(g)}return t(o(i(h),h.length*8))}function t(h){const f=[],g=h.length*32,m="0123456789abcdef";for(let v=0;v<g;v+=8){const y=h[v>>5]>>>v%32&255,S=parseInt(m.charAt(y>>>4&15)+m.charAt(y&15),16);f.push(S)}return f}function r(h){return(h+64>>>9<<4)+14+1}function o(h,f){h[f>>5]|=128<<f%32,h[r(f)-1]=f;let g=1732584193,m=-271733879,v=-1732584194,y=271733878;for(let S=0;S<h.length;S+=16){const P=g,b=m,w=v,A=y;g=c(g,m,v,y,h[S],7,-680876936),y=c(y,g,m,v,h[S+1],12,-389564586),v=c(v,y,g,m,h[S+2],17,606105819),m=c(m,v,y,g,h[S+3],22,-1044525330),g=c(g,m,v,y,h[S+4],7,-176418897),y=c(y,g,m,v,h[S+5],12,1200080426),v=c(v,y,g,m,h[S+6],17,-1473231341),m=c(m,v,y,g,h[S+7],22,-45705983),g=c(g,m,v,y,h[S+8],7,1770035416),y=c(y,g,m,v,h[S+9],12,-1958414417),v=c(v,y,g,m,h[S+10],17,-42063),m=c(m,v,y,g,h[S+11],22,-1990404162),g=c(g,m,v,y,h[S+12],7,1804603682),y=c(y,g,m,v,h[S+13],12,-40341101),v=c(v,y,g,m,h[S+14],17,-1502002290),m=c(m,v,y,g,h[S+15],22,1236535329),g=u(g,m,v,y,h[S+1],5,-165796510),y=u(y,g,m,v,h[S+6],9,-1069501632),v=u(v,y,g,m,h[S+11],14,643717713),m=u(m,v,y,g,h[S],20,-373897302),g=u(g,m,v,y,h[S+5],5,-701558691),y=u(y,g,m,v,h[S+10],9,38016083),v=u(v,y,g,m,h[S+15],14,-660478335),m=u(m,v,y,g,h[S+4],20,-405537848),g=u(g,m,v,y,h[S+9],5,568446438),y=u(y,g,m,v,h[S+14],9,-1019803690),v=u(v,y,g,m,h[S+3],14,-187363961),m=u(m,v,y,g,h[S+8],20,1163531501),g=u(g,m,v,y,h[S+13],5,-1444681467),y=u(y,g,m,v,h[S+2],9,-51403784),v=u(v,y,g,m,h[S+7],14,1735328473),m=u(m,v,y,g,h[S+12],20,-1926607734),g=l(g,m,v,y,h[S+5],4,-378558),y=l(y,g,m,v,h[S+8],11,-2022574463),v=l(v,y,g,m,h[S+11],16,1839030562),m=l(m,v,y,g,h[S+14],23,-35309556),g=l(g,m,v,y,h[S+1],4,-1530992060),y=l(y,g,m,v,h[S+4],11,1272893353),v=l(v,y,g,m,h[S+7],16,-155497632),m=l(m,v,y,g,h[S+10],23,-1094730640),g=l(g,m,v,y,h[S+13],4,681279174),y=l(y,g,m,v,h[S],11,-358537222),v=l(v,y,g,m,h[S+3],16,-722521979),m=l(m,v,y,g,h[S+6],23,76029189),g=l(g,m,v,y,h[S+9],4,-640364487),y=l(y,g,m,v,h[S+12],11,-421815835),v=l(v,y,g,m,h[S+15],16,530742520),m=l(m,v,y,g,h[S+2],23,-995338651),g=p(g,m,v,y,h[S],6,-198630844),y=p(y,g,m,v,h[S+7],10,1126891415),v=p(v,y,g,m,h[S+14],15,-1416354905),m=p(m,v,y,g,h[S+5],21,-57434055),g=p(g,m,v,y,h[S+12],6,1700485571),y=p(y,g,m,v,h[S+3],10,-1894986606),v=p(v,y,g,m,h[S+10],15,-1051523),m=p(m,v,y,g,h[S+1],21,-2054922799),g=p(g,m,v,y,h[S+8],6,1873313359),y=p(y,g,m,v,h[S+15],10,-30611744),v=p(v,y,g,m,h[S+6],15,-1560198380),m=p(m,v,y,g,h[S+13],21,1309151649),g=p(g,m,v,y,h[S+4],6,-145523070),y=p(y,g,m,v,h[S+11],10,-1120210379),v=p(v,y,g,m,h[S+2],15,718787259),m=p(m,v,y,g,h[S+9],21,-343485551),g=a(g,P),m=a(m,b),v=a(v,w),y=a(y,A)}return[g,m,v,y]}function i(h){if(h.length===0)return[];const f=h.length*8,g=new Uint32Array(r(f));for(let m=0;m<f;m+=8)g[m>>5]|=(h[m/8]&255)<<m%32;return g}function a(h,f){const g=(h&65535)+(f&65535);return(h>>16)+(f>>16)+(g>>16)<<16|g&65535}function s(h,f){return h<<f|h>>>32-f}function n(h,f,g,m,v,y){return a(s(a(a(f,h),a(m,y)),v),g)}function c(h,f,g,m,v,y,S){return n(f&g|~f&m,h,f,v,y,S)}function u(h,f,g,m,v,y,S){return n(f&m|g&~m,h,f,v,y,S)}function l(h,f,g,m,v,y,S){return n(f^g^m,h,f,v,y,S)}function p(h,f,g,m,v,y,S){return n(g^(f|~m),h,f,v,y,S)}var d=e;return cr.default=d,cr}var wu;function kS(){if(wu)return or;wu=1,Object.defineProperty(or,"__esModule",{value:!0}),or.default=void 0;var e=r(Ru()),t=r(_S());function r(a){return a&&a.__esModule?a:{default:a}}var i=(0,e.default)("v3",48,t.default);return or.default=i,or}var ur={},lr={},Eu;function OS(){if(Eu)return lr;Eu=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.default=void 0;var t={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};return lr.default=t,lr}var Iu;function MS(){if(Iu)return ur;Iu=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.default=void 0;var e=o(OS()),t=o(fu()),r=Ns();function o(s){return s&&s.__esModule?s:{default:s}}function i(s,n,c){if(e.default.randomUUID&&!n&&!s)return e.default.randomUUID();s=s||{};const u=s.random||(s.rng||t.default)();if(u[6]=u[6]&15|64,u[8]=u[8]&63|128,n){c=c||0;for(let l=0;l<16;++l)n[c+l]=u[l];return n}return(0,r.unsafeStringify)(u)}var a=i;return ur.default=a,ur}var pr={},dr={},Au;function DS(){if(Au)return dr;Au=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.default=void 0;function e(i,a,s,n){switch(i){case 0:return a&s^~a&n;case 1:return a^s^n;case 2:return a&s^a&n^s&n;case 3:return a^s^n}}function t(i,a){return i<<a|i>>>32-a}function r(i){const a=[1518500249,1859775393,2400959708,3395469782],s=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof i=="string"){const l=unescape(encodeURIComponent(i));i=[];for(let p=0;p<l.length;++p)i.push(l.charCodeAt(p))}else Array.isArray(i)||(i=Array.prototype.slice.call(i));i.push(128);const n=i.length/4+2,c=Math.ceil(n/16),u=new Array(c);for(let l=0;l<c;++l){const p=new Uint32Array(16);for(let d=0;d<16;++d)p[d]=i[l*64+d*4]<<24|i[l*64+d*4+1]<<16|i[l*64+d*4+2]<<8|i[l*64+d*4+3];u[l]=p}u[c-1][14]=(i.length-1)*8/Math.pow(2,32),u[c-1][14]=Math.floor(u[c-1][14]),u[c-1][15]=(i.length-1)*8&4294967295;for(let l=0;l<c;++l){const p=new Uint32Array(80);for(let v=0;v<16;++v)p[v]=u[l][v];for(let v=16;v<80;++v)p[v]=t(p[v-3]^p[v-8]^p[v-14]^p[v-16],1);let d=s[0],h=s[1],f=s[2],g=s[3],m=s[4];for(let v=0;v<80;++v){const y=Math.floor(v/20),S=t(d,5)+e(y,h,f,g)+m+a[y]+p[v]>>>0;m=g,g=f,f=t(h,30)>>>0,h=d,d=S}s[0]=s[0]+d>>>0,s[1]=s[1]+h>>>0,s[2]=s[2]+f>>>0,s[3]=s[3]+g>>>0,s[4]=s[4]+m>>>0}return[s[0]>>24&255,s[0]>>16&255,s[0]>>8&255,s[0]&255,s[1]>>24&255,s[1]>>16&255,s[1]>>8&255,s[1]&255,s[2]>>24&255,s[2]>>16&255,s[2]>>8&255,s[2]&255,s[3]>>24&255,s[3]>>16&255,s[3]>>8&255,s[3]&255,s[4]>>24&255,s[4]>>16&255,s[4]>>8&255,s[4]&255]}var o=r;return dr.default=o,dr}var Tu;function NS(){if(Tu)return pr;Tu=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.default=void 0;var e=r(Ru()),t=r(DS());function r(a){return a&&a.__esModule?a:{default:a}}var i=(0,e.default)("v5",80,t.default);return pr.default=i,pr}var hr={},_u;function xS(){if(_u)return hr;_u=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.default=void 0;var e="00000000-0000-0000-0000-000000000000";return hr.default=e,hr}var fr={},ku;function zS(){if(ku)return fr;ku=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.default=void 0;var e=t(Ds());function t(i){return i&&i.__esModule?i:{default:i}}function r(i){if(!(0,e.default)(i))throw TypeError("Invalid UUID");return parseInt(i.slice(14,15),16)}var o=r;return fr.default=o,fr}var Ou;function LS(){return Ou||(Ou=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return s.default}});var t=l(TS()),r=l(kS()),o=l(MS()),i=l(NS()),a=l(xS()),s=l(zS()),n=l(Ds()),c=l(Ns()),u=l(Cu());function l(p){return p&&p.__esModule?p:{default:p}}}(mo)),mo}var Mu;function ut(){if(Mu)return ct;Mu=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.createNoDashGuid=ct.createGuid=void 0;const e=LS(),t=()=>(0,e.v4)();ct.createGuid=t;const r=()=>t().replace(new RegExp("-","g"),"").toUpperCase();return ct.createNoDashGuid=r,ct}var Du;function vr(){return Du||(Du=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PlatformEvent=e.EventType=void 0;const t=ut();(function(o){o[o.Debug=0]="Debug",o[o.Info=1]="Info",o[o.Warning=2]="Warning",o[o.Error=3]="Error",o[o.None=4]="None"})(e.EventType||(e.EventType={}));class r{constructor(i,a){this.privName=i,this.privEventId=(0,t.createNoDashGuid)(),this.privEventTime=new Date().toISOString(),this.privEventType=a,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}e.PlatformEvent=r}(go)),go}var Nu;function jS(){if(Nu)return J;Nu=1,Object.defineProperty(J,"__esModule",{value:!0}),J.AudioStreamNodeErrorEvent=J.AudioStreamNodeDetachedEvent=J.AudioStreamNodeAttachedEvent=J.AudioStreamNodeAttachingEvent=J.AudioStreamNodeEvent=J.AudioSourceErrorEvent=J.AudioSourceOffEvent=J.AudioSourceReadyEvent=J.AudioSourceInitializingEvent=J.AudioSourceEvent=void 0;const e=vr();class t extends e.PlatformEvent{constructor(d,h,f=e.EventType.Info){super(d,f),this.privAudioSourceId=h}get audioSourceId(){return this.privAudioSourceId}}J.AudioSourceEvent=t;class r extends t{constructor(d){super("AudioSourceInitializingEvent",d)}}J.AudioSourceInitializingEvent=r;class o extends t{constructor(d){super("AudioSourceReadyEvent",d)}}J.AudioSourceReadyEvent=o;class i extends t{constructor(d){super("AudioSourceOffEvent",d)}}J.AudioSourceOffEvent=i;class a extends t{constructor(d,h){super("AudioSourceErrorEvent",d,e.EventType.Error),this.privError=h}get error(){return this.privError}}J.AudioSourceErrorEvent=a;class s extends t{constructor(d,h,f){super(d,h),this.privAudioNodeId=f}get audioNodeId(){return this.privAudioNodeId}}J.AudioStreamNodeEvent=s;class n extends s{constructor(d,h){super("AudioStreamNodeAttachingEvent",d,h)}}J.AudioStreamNodeAttachingEvent=n;class c extends s{constructor(d,h){super("AudioStreamNodeAttachedEvent",d,h)}}J.AudioStreamNodeAttachedEvent=c;class u extends s{constructor(d,h){super("AudioStreamNodeDetachedEvent",d,h)}}J.AudioStreamNodeDetachedEvent=u;class l extends s{constructor(d,h,f){super("AudioStreamNodeErrorEvent",d,h),this.privError=f}get error(){return this.privError}}return J.AudioStreamNodeErrorEvent=l,J}var G={},xu;function qS(){if(xu)return G;xu=1,Object.defineProperty(G,"__esModule",{value:!0}),G.ConnectionRedirectEvent=G.ConnectionMessageSentEvent=G.ConnectionMessageReceivedEvent=G.ConnectionEstablishErrorEvent=G.ConnectionErrorEvent=G.ConnectionClosedEvent=G.ConnectionEstablishedEvent=G.ConnectionStartEvent=G.ConnectionEvent=G.ServiceEvent=void 0;const e=vr();class t extends e.PlatformEvent{constructor(d,h,f=e.EventType.Info){super(d,f),this.privJsonResult=h}get jsonString(){return this.privJsonResult}}G.ServiceEvent=t;class r extends e.PlatformEvent{constructor(d,h,f=e.EventType.Info){super(d,f),this.privConnectionId=h}get connectionId(){return this.privConnectionId}}G.ConnectionEvent=r;class o extends r{constructor(d,h,f){super("ConnectionStartEvent",d),this.privUri=h,this.privHeaders=f}get uri(){return this.privUri}get headers(){return this.privHeaders}}G.ConnectionStartEvent=o;class i extends r{constructor(d){super("ConnectionEstablishedEvent",d)}}G.ConnectionEstablishedEvent=i;class a extends r{constructor(d,h,f){super("ConnectionClosedEvent",d,e.EventType.Debug),this.privReason=f,this.privStatusCode=h}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}G.ConnectionClosedEvent=a;class s extends r{constructor(d,h,f){super("ConnectionErrorEvent",d,e.EventType.Debug),this.privMessage=h,this.privType=f}get message(){return this.privMessage}get type(){return this.privType}}G.ConnectionErrorEvent=s;class n extends r{constructor(d,h,f){super("ConnectionEstablishErrorEvent",d,e.EventType.Error),this.privStatusCode=h,this.privReason=f}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}G.ConnectionEstablishErrorEvent=n;class c extends r{constructor(d,h,f){super("ConnectionMessageReceivedEvent",d),this.privNetworkReceivedTime=h,this.privMessage=f}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}G.ConnectionMessageReceivedEvent=c;class u extends r{constructor(d,h,f){super("ConnectionMessageSentEvent",d),this.privNetworkSentTime=h,this.privMessage=f}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}G.ConnectionMessageSentEvent=u;class l extends r{constructor(d,h,f,g){super("ConnectionRedirectEvent",d,e.EventType.Info),this.privRedirectUrl=h,this.privOriginalUrl=f,this.privContext=g}get redirectUrl(){return this.privRedirectUrl}get originalUrl(){return this.privOriginalUrl}get context(){return this.privContext}}return G.ConnectionRedirectEvent=l,G}var yo={},qe={},zu;function Me(){if(zu)return qe;zu=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.ObjectDisposedError=qe.InvalidOperationError=qe.ArgumentNullError=void 0;class e extends Error{constructor(i){super(i),this.name="ArgumentNull",this.message=i}}qe.ArgumentNullError=e;class t extends Error{constructor(i){super(i),this.name="InvalidOperation",this.message=i}}qe.InvalidOperationError=t;class r extends Error{constructor(i,a){super(a),this.name=i+"ObjectDisposed",this.message=a}}return qe.ObjectDisposedError=r,qe}var Lu;function ju(){return Lu||(Lu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionMessage=e.MessageType=void 0;const t=Me(),r=ut();var o;(function(a){a[a.Text=0]="Text",a[a.Binary=1]="Binary"})(o=e.MessageType||(e.MessageType={}));class i{constructor(s,n,c,u){if(this.privBody=null,s===o.Text&&n&&typeof n!="string")throw new t.InvalidOperationError("Payload must be a string");if(s===o.Binary&&n&&!(n instanceof ArrayBuffer))throw new t.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=s,this.privBody=n,this.privHeaders=c||{},this.privId=u||(0,r.createNoDashGuid)(),this.messageType){case o.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case o.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===o.Binary)throw new t.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===o.Text)throw new t.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}}e.ConnectionMessage=i}(yo)),yo}var gr={},qu;function FS(){if(qu)return gr;qu=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.ConnectionOpenResponse=void 0;let e=class{constructor(r,o){this.privStatusCode=r,this.privReason=o}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};return gr.ConnectionOpenResponse=e,gr}var mr={},Fu;function BS(){if(Fu)return mr;Fu=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.DeferralMap=void 0;let e=class{constructor(){this.privMap={}}add(r,o){this.privMap[r]=o}getId(r){return this.privMap[r]}complete(r,o){try{this.privMap[r].resolve(o)}catch(i){this.privMap[r].reject(i)}finally{this.privMap[r]=void 0}}};return mr.DeferralMap=e,mr}var lt={},Bu;function Uu(){if(Bu)return lt;Bu=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.SendingAgentContextMessageEvent=lt.DialogEvent=void 0;const e=vr();class t extends e.PlatformEvent{constructor(i,a=e.EventType.Info){super(i,a)}}lt.DialogEvent=t;class r extends t{constructor(i){super("SendingAgentContextMessageEvent"),this.privAgentConfig=i}get agentConfig(){return this.privAgentConfig}}return lt.SendingAgentContextMessageEvent=r,lt}var yr={},Sr={},$u;function Vu(){if($u)return Sr;$u=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.EventSource=void 0;const e=Me(),t=ut();let r=class{constructor(i){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=i}onEvent(i){if(this.isDisposed())throw new e.ObjectDisposedError("EventSource");if(this.metadata)for(const a in this.metadata)a&&i.metadata&&(i.metadata[a]||(i.metadata[a]=this.metadata[a]));for(const a in this.privEventListeners)a&&this.privEventListeners[a]&&this.privEventListeners[a](i)}attach(i){const a=(0,t.createNoDashGuid)();return this.privEventListeners[a]=i,{detach:()=>(delete this.privEventListeners[a],Promise.resolve())}}attachListener(i){return this.attach(a=>i.onEvent(a))}attachConsoleListener(i){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(a=>i.onEvent(a)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}};return Sr.EventSource=r,Sr}var Wu;function US(){if(Wu)return yr;Wu=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.Events=void 0;const e=Me(),t=Vu();let r=class cc{static setEventSource(i){if(!i)throw new e.ArgumentNullError("eventSource");cc.privInstance=i}static get instance(){return cc.privInstance}};return yr.Events=r,r.privInstance=new t.EventSource,yr}var So={},Hu;function $S(){return Hu||(Hu=1,Object.defineProperty(So,"__esModule",{value:!0})),So}var Co={},Ku;function VS(){return Ku||(Ku=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionState=void 0,function(t){t[t.None=0]="None",t[t.Connected=1]="Connected",t[t.Connecting=2]="Connecting",t[t.Disconnected=3]="Disconnected"}(e.ConnectionState||(e.ConnectionState={}))}(Co)),Co}var Po={},Ju;function WS(){return Ju||(Ju=1,Object.defineProperty(Po,"__esModule",{value:!0})),Po}var Ro={},Gu;function HS(){return Gu||(Gu=1,Object.defineProperty(Ro,"__esModule",{value:!0})),Ro}var bo={},Qu;function KS(){return Qu||(Qu=1,Object.defineProperty(bo,"__esModule",{value:!0})),bo}var wo={},Yu;function JS(){return Yu||(Yu=1,Object.defineProperty(wo,"__esModule",{value:!0})),wo}var Eo={},Zu;function GS(){return Zu||(Zu=1,Object.defineProperty(Eo,"__esModule",{value:!0})),Eo}var Io={},Xu;function QS(){return Xu||(Xu=1,Object.defineProperty(Io,"__esModule",{value:!0})),Io}var Ao={},el;function YS(){return el||(el=1,Object.defineProperty(Ao,"__esModule",{value:!0})),Ao}var To={},tl;function ZS(){return tl||(tl=1,Object.defineProperty(To,"__esModule",{value:!0})),To}var Cr={},rl;function nl(){if(rl)return Cr;rl=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.List=void 0;const e=Me();let t=class Lt{constructor(o){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],o)for(const i of o)this.privList.push(i)}get(o){return this.throwIfDisposed(),this.privList[o]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(o){this.throwIfDisposed(),this.insertAt(this.privList.length,o)}insertAt(o,i){this.throwIfDisposed(),o===0?this.privList.unshift(i):o===this.privList.length?this.privList.push(i):this.privList.splice(o,0,i),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(o){return this.throwIfDisposed(),this.remove(o,1)[0]}remove(o,i){this.throwIfDisposed();const a=this.privList.splice(o,i);return this.triggerSubscriptions(this.privRemoveSubscriptions),a}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(o){this.throwIfDisposed();const i=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[i]=o,{detach:()=>(delete this.privAddSubscriptions[i],Promise.resolve())}}onRemoved(o){this.throwIfDisposed();const i=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[i]=o,{detach:()=>(delete this.privRemoveSubscriptions[i],Promise.resolve())}}onDisposed(o){this.throwIfDisposed();const i=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[i]=o,{detach:()=>(delete this.privDisposedSubscriptions[i],Promise.resolve())}}join(o){return this.throwIfDisposed(),this.privList.join(o)}toArray(){const o=Array();return this.privList.forEach(i=>{o.push(i)}),o}any(o){return this.throwIfDisposed(),o?this.where(o).length()>0:this.length()>0}all(o){return this.throwIfDisposed(),this.where(o).length()===this.length()}forEach(o){this.throwIfDisposed();for(let i=0;i<this.length();i++)o(this.privList[i],i)}select(o){this.throwIfDisposed();const i=[];for(let a=0;a<this.privList.length;a++)i.push(o(this.privList[a],a));return new Lt(i)}where(o){this.throwIfDisposed();const i=new Lt;for(let a=0;a<this.privList.length;a++)o(this.privList[a],a)&&i.add(this.privList[a]);return i}orderBy(o){this.throwIfDisposed();const a=this.toArray().sort(o);return new Lt(a)}orderByDesc(o){return this.throwIfDisposed(),this.orderBy((i,a)=>o(a,i))}clone(){return this.throwIfDisposed(),new Lt(this.toArray())}concat(o){return this.throwIfDisposed(),new Lt(this.privList.concat(o.toArray()))}concatArray(o){return this.throwIfDisposed(),new Lt(this.privList.concat(o))}isDisposed(){return this.privList==null}dispose(o){this.isDisposed()||(this.privDisposeReason=o,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new e.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(o){if(o)for(const i in o)i&&o[i]()}};return Cr.List=t,Cr}var _o={},il;function sl(){return il||(il=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.marshalPromiseToCallbacks=e.Sink=e.Deferred=e.PromiseResultEventSource=e.PromiseResult=e.PromiseState=void 0;var t;(function(n){n[n.None=0]="None",n[n.Resolved=1]="Resolved",n[n.Rejected=2]="Rejected"})(t=e.PromiseState||(e.PromiseState={}));class r{constructor(c){this.throwIfError=()=>{if(this.isError)throw this.error},c.on(u=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=u)},u=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=u)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}e.PromiseResult=r;class o{constructor(){this.setResult=c=>{this.privOnSetResult(c)},this.setError=c=>{this.privOnSetError(c)},this.on=(c,u)=>{this.privOnSetResult=c,this.privOnSetError=u}}}e.PromiseResultEventSource=o;class i{constructor(){this.resolve=c=>(this.privResolve(c),this),this.reject=c=>(this.privReject(c),this),this.privPromise=new Promise((c,u)=>{this.privResolve=c,this.privReject=u})}get promise(){return this.privPromise}}e.Deferred=i;class a{constructor(){this.privState=t.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new o,this.privPromiseResult=new r(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(c){if(this.privState!==t.None)throw new Error("'Cannot resolve a completed promise'");this.privState=t.Resolved,this.privPromiseResultEvents.setResult(c);for(let u=0;u<this.privSuccessHandlers.length;u++)this.executeSuccessCallback(c,this.privSuccessHandlers[u],this.privErrorHandlers[u]);this.detachHandlers()}reject(c){if(this.privState!==t.None)throw new Error("'Cannot reject a completed promise'");this.privState=t.Rejected,this.privPromiseResultEvents.setError(c);for(const u of this.privErrorHandlers)this.executeErrorCallback(c,u);this.detachHandlers()}on(c,u){c==null&&(c=()=>{}),this.privState===t.None?(this.privSuccessHandlers.push(c),this.privErrorHandlers.push(u)):(this.privState===t.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,c,u):this.privState===t.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,u),this.detachHandlers())}executeSuccessCallback(c,u,l){try{u(c)}catch(p){this.executeErrorCallback(`'Unhandled callback error: ${p}'`,l)}}executeErrorCallback(c,u){if(u)try{u(c)}catch(l){throw new Error(`'Unhandled callback error: ${l}. InnerError: ${c}'`)}else throw new Error(`'Unhandled error: ${c}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}}e.Sink=a;function s(n,c,u){n.then(l=>{try{c&&c(l)}catch(p){if(u)try{if(p instanceof Error){const d=p;u(d.name+": "+d.message)}else u(p)}catch{}}},l=>{if(u)try{if(l instanceof Error){const p=l;u(p.name+": "+p.message)}else u(l)}catch{}})}e.marshalPromiseToCallbacks=s}(_o)),_o}var Pr={},ol;function al(){if(ol)return Pr;ol=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.Queue=void 0;const e=Me(),t=nl(),r=sl();var o;(function(a){a[a.Dequeue=0]="Dequeue",a[a.Peek=1]="Peek"})(o||(o={}));let i=class{constructor(s){this.privPromiseStore=new t.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=s||new t.List,this.privDetachables=[],this.privSubscribers=new t.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(s){this.throwIfDispose(),this.enqueueFromPromise(new Promise(n=>n(s)))}enqueueFromPromise(s){this.throwIfDispose(),s.then(n=>{this.privList.add(n)},()=>{})}dequeue(){this.throwIfDispose();const s=new r.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:s,type:o.Dequeue}),this.drain()),s.promise}peek(){this.throwIfDispose();const s=new r.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:s,type:o.Peek}),this.drain()),s.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}async drainAndDispose(s,n){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=n,this.privIsDisposing=!0;const c=this.privSubscribers;if(c){for(;c.length()>0;)c.removeFirst().deferral.resolve(void 0);this.privSubscribers===c&&(this.privSubscribers=c)}for(const u of this.privDetachables)await u.detach();if(this.privPromiseStore.length()>0&&s){const u=[];return this.privPromiseStore.toArray().forEach(l=>{u.push(l)}),Promise.all(u).finally(()=>{this.privSubscribers=null,this.privList.forEach(l=>{s(l)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}}async dispose(s){await this.drainAndDispose(null,s)}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const s=this.privSubscribers,n=this.privList;if(s&&n){for(;n.length()>0&&s.length()>0&&!this.privIsDisposing;){const c=s.removeFirst();if(c.type===o.Peek)c.deferral.resolve(n.first());else{const u=n.removeFirst();c.deferral.resolve(u)}}this.privSubscribers===s&&(this.privSubscribers=s),this.privList===n&&(this.privList=n)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new e.InvalidOperationError(this.privDisposeReason):new e.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new e.InvalidOperationError("Queue disposing")}};return Pr.Queue=i,Pr}var Rr={},cl;function XS(){if(cl)return Rr;cl=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.RawWebsocketMessage=void 0;const e=ju(),t=Me(),r=ut();let o=class{constructor(a,s,n){if(this.privPayload=null,!s)throw new t.ArgumentNullError("payload");if(a===e.MessageType.Binary&&Object.getPrototypeOf(s).constructor.name!=="ArrayBuffer")throw new t.InvalidOperationError("Payload must be ArrayBuffer");if(a===e.MessageType.Text&&typeof s!="string")throw new t.InvalidOperationError("Payload must be a string");this.privMessageType=a,this.privPayload=s,this.privId=n||(0,r.createNoDashGuid)()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===e.MessageType.Binary)throw new t.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===e.MessageType.Text)throw new t.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}};return Rr.RawWebsocketMessage=o,Rr}var br={},ul;function eC(){if(ul)return br;ul=1,Object.defineProperty(br,"__esModule",{value:!0}),br.RiffPcmEncoder=void 0;let e=class{constructor(r,o){this.privActualSampleRate=r,this.privDesiredSampleRate=o}encode(r){const o=this.downSampleAudioFrame(r,this.privActualSampleRate,this.privDesiredSampleRate);if(!o)return null;const i=o.length*2,a=new ArrayBuffer(i),s=new DataView(a);return this.floatTo16BitPCM(s,0,o),a}setString(r,o,i){for(let a=0;a<i.length;a++)r.setUint8(o+a,i.charCodeAt(a))}floatTo16BitPCM(r,o,i){for(let a=0;a<i.length;a++,o+=2){const s=Math.max(-1,Math.min(1,i[a]));r.setInt16(o,s<0?s*32768:s*32767,!0)}}downSampleAudioFrame(r,o,i){if(!r)return null;if(i===o||i>o)return r;const a=o/i,s=Math.round(r.length/a),n=new Float32Array(s);let c=0,u=0;for(;u<s;){const l=Math.round((u+1)*a);let p=0,d=0;for(;c<l&&c<r.length;)p+=r[c++],d++;n[u++]=p/d}return n}};return br.RiffPcmEncoder=e,br}var wr={},ll;function tC(){if(ll)return wr;ll=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.Stream=void 0;const e=Me(),t=ut(),r=al();let o=class{constructor(a){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=a||(0,t.createNoDashGuid)(),this.privReaderQueue=new r.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(a){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(a)}catch{}}read(){if(this.privIsReadEnded)throw new e.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(async a=>((a===void 0||a.isEnd)&&await this.privReaderQueue.dispose("End of stream reached"),a))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new r.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new e.InvalidOperationError("Stream closed")}};return wr.Stream=o,wr}var ko={},pl;function Oo(){return pl||(pl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationStatus=void 0,function(t){t[t.Success=0]="Success",t[t.Error=1]="Error"}(e.TranslationStatus||(e.TranslationStatus={}))}(ko)),ko}var Er={},dl;function rC(){if(dl)return Er;dl=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.ChunkedArrayBufferStream=void 0;const e=O();let t=class extends e.Stream{constructor(o,i){super(i),this.privTargetChunkSize=Math.round(o),this.privNextBufferReadyBytes=0}writeStreamChunk(o){if(o.isEnd||this.privNextBufferReadyBytes===0&&o.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(o);return}let i=0;for(;i<o.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=o.timeReceived);const a=Math.min(o.buffer.byteLength-i,this.privTargetChunkSize-this.privNextBufferReadyBytes),s=new Uint8Array(this.privNextBufferToWrite),n=new Uint8Array(o.buffer.slice(i,a+i));s.set(n,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=a,i+=a,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};return Er.ChunkedArrayBufferStream=t,Er}var Mo={},hl;function nC(){return hl||(hl=1,Object.defineProperty(Mo,"__esModule",{value:!0})),Mo}var Ir={},fl;function iC(){if(fl)return Ir;fl=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.Timeout=void 0;let e=class tt{static load(){const r=new Map([[0,()=>{}]]),o=new Map,a="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),s=new Worker(a);return s.addEventListener("message",({data:u})=>{if(tt.isCallNotification(u)){const{params:{timerId:l}}=u,p=r.get(l);if(typeof p=="number"){const d=o.get(p);if(d===void 0||d!==l)throw new Error("The timer is in an undefined state.")}else if(typeof p<"u")p(),r.delete(l);else throw new Error("The timer is in an undefined state.")}else if(tt.isClearResponse(u)){const{id:l}=u,p=o.get(l);if(p===void 0)throw new Error("The timer is in an undefined state.");o.delete(l),r.delete(p)}else{const{error:{message:l}}=u;throw new Error(l)}}),{clearTimeout:u=>{const l=Math.random();o.set(l,u),r.set(u,l),s.postMessage({id:l,method:"clear",params:{timerId:u}})},setTimeout:(u,l)=>{const p=Math.random();return r.set(p,u),s.postMessage({id:null,method:"set",params:{delay:l,now:performance.now(),timerId:p}}),p}}}static loadWorkerTimers(){return()=>(tt.workerTimers!==null||(tt.workerTimers=tt.load()),tt.workerTimers)}static isCallNotification(r){return r.method!==void 0&&r.method==="call"}static isClearResponse(r){return r.error===null&&typeof r.id=="number"}};return Ir.Timeout=e,e.workerTimers=null,e.clearTimeout=t=>e.timers().clearTimeout(t),e.setTimeout=(t,r)=>e.timers().setTimeout(t,r),e.timers=e.loadWorkerTimers(),Ir}var j={},vl;function sC(){if(vl)return j;vl=1,Object.defineProperty(j,"__esModule",{value:!0}),j.OCSPCacheUpdateErrorEvent=j.OCSPResponseRetrievedEvent=j.OCSPCacheFetchErrorEvent=j.OCSPVerificationFailedEvent=j.OCSPCacheHitEvent=j.OCSPCacheEntryNeedsRefreshEvent=j.OCSPCacheEntryExpiredEvent=j.OCSPWSUpgradeStartedEvent=j.OCSPStapleReceivedEvent=j.OCSPCacheUpdateCompleteEvent=j.OCSPDiskCacheStoreEvent=j.OCSPMemoryCacheStoreEvent=j.OCSPCacheUpdateNeededEvent=j.OCSPDiskCacheHitEvent=j.OCSPCacheMissEvent=j.OCSPMemoryCacheHitEvent=j.OCSPEvent=void 0;const e=vr();class t extends e.PlatformEvent{constructor(S,P,b){super(S,P),this.privSignature=b}}j.OCSPEvent=t;class r extends t{constructor(S){super("OCSPMemoryCacheHitEvent",e.EventType.Debug,S)}}j.OCSPMemoryCacheHitEvent=r;class o extends t{constructor(S){super("OCSPCacheMissEvent",e.EventType.Debug,S)}}j.OCSPCacheMissEvent=o;class i extends t{constructor(S){super("OCSPDiskCacheHitEvent",e.EventType.Debug,S)}}j.OCSPDiskCacheHitEvent=i;class a extends t{constructor(S){super("OCSPCacheUpdateNeededEvent",e.EventType.Debug,S)}}j.OCSPCacheUpdateNeededEvent=a;class s extends t{constructor(S){super("OCSPMemoryCacheStoreEvent",e.EventType.Debug,S)}}j.OCSPMemoryCacheStoreEvent=s;class n extends t{constructor(S){super("OCSPDiskCacheStoreEvent",e.EventType.Debug,S)}}j.OCSPDiskCacheStoreEvent=n;class c extends t{constructor(S){super("OCSPCacheUpdateCompleteEvent",e.EventType.Debug,S)}}j.OCSPCacheUpdateCompleteEvent=c;class u extends t{constructor(){super("OCSPStapleReceivedEvent",e.EventType.Debug,"")}}j.OCSPStapleReceivedEvent=u;class l extends t{constructor(S){super("OCSPWSUpgradeStartedEvent",e.EventType.Debug,S)}}j.OCSPWSUpgradeStartedEvent=l;class p extends t{constructor(S,P){super("OCSPCacheEntryExpiredEvent",e.EventType.Debug,S),this.privExpireTime=P}}j.OCSPCacheEntryExpiredEvent=p;class d extends t{constructor(S,P,b){super("OCSPCacheEntryNeedsRefreshEvent",e.EventType.Debug,S),this.privExpireTime=b,this.privStartTime=P}}j.OCSPCacheEntryNeedsRefreshEvent=d;class h extends t{constructor(S,P,b){super("OCSPCacheHitEvent",e.EventType.Debug,S),this.privExpireTime=b,this.privExpireTimeString=new Date(b).toLocaleDateString(),this.privStartTime=P,this.privStartTimeString=new Date(P).toLocaleTimeString()}}j.OCSPCacheHitEvent=h;class f extends t{constructor(S,P){super("OCSPVerificationFailedEvent",e.EventType.Debug,S),this.privError=P}}j.OCSPVerificationFailedEvent=f;class g extends t{constructor(S,P){super("OCSPCacheFetchErrorEvent",e.EventType.Debug,S),this.privError=P}}j.OCSPCacheFetchErrorEvent=g;class m extends t{constructor(S){super("OCSPResponseRetrievedEvent",e.EventType.Debug,S)}}j.OCSPResponseRetrievedEvent=m;class v extends t{constructor(S,P){super("OCSPCacheUpdateErrorEvent",e.EventType.Debug,S),this.privError=P}}return j.OCSPCacheUpdateErrorEvent=v,j}var Ar={},gl;function oC(){if(gl)return Ar;gl=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.BackgroundEvent=void 0;const e=O();class t extends e.PlatformEvent{constructor(o){super("BackgroundEvent",e.EventType.Error),this.privError=o}get error(){return this.privError}}return Ar.BackgroundEvent=t,Ar}var ml;function O(){return ml||(ml=1,function(e){var t=at&&at.__createBinding||(Object.create?function(i,a,s,n){n===void 0&&(n=s),Object.defineProperty(i,n,{enumerable:!0,get:function(){return a[s]}})}:function(i,a,s,n){n===void 0&&(n=s),i[n]=a[s]}),r=at&&at.__exportStar||function(i,a){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&t(a,i,s)};Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationStatus=void 0,r(jS(),e),r(qS(),e),r(ju(),e),r(FS(),e),r(BS(),e),r(Uu(),e),r(Me(),e),r(US(),e),r(Vu(),e),r(ut(),e),r($S(),e),r(VS(),e),r(WS(),e),r(HS(),e),r(KS(),e),r(JS(),e),r(GS(),e),r(QS(),e),r(YS(),e),r(ZS(),e),r(nl(),e),r(vr(),e),r(sl(),e),r(al(),e),r(XS(),e),r(eC(),e),r(tC(),e);var o=Oo();Object.defineProperty(e,"TranslationStatus",{enumerable:!0,get:function(){return o.TranslationStatus}}),r(rC(),e),r(nC(),e),r(iC(),e),r(sC(),e),r(oC(),e)}(at)),at}var Tr={},yl;function le(){if(yl)return Tr;yl=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.HeaderNames=void 0;let e=class{};return Tr.HeaderNames=e,e.AuthKey="Ocp-Apim-Subscription-Key",e.Authorization="Authorization",e.SpIDAuthKey="Apim-Subscription-Id",e.ConnectionId="X-ConnectionId",e.ContentType="Content-Type",e.CustomCommandsAppId="X-CommandsAppId",e.Path="Path",e.RequestId="X-RequestId",e.RequestStreamId="X-StreamId",e.RequestTimestamp="X-Timestamp",Tr}var _r={},Sl;function Do(){if(Sl)return _r;Sl=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.AuthInfo=void 0;class e{constructor(r,o){this.privHeaderName=r,this.privToken=o}get headerName(){return this.privHeaderName}get token(){return this.privToken}}return _r.AuthInfo=e,_r}var Cl;function aC(){if(Cl)return rr;Cl=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.CognitiveSubscriptionKeyAuthentication=void 0;const e=O(),t=le(),r=Do();let o=class{constructor(a){if(!a)throw new e.ArgumentNullError("subscriptionKey");this.privAuthInfo=new r.AuthInfo(t.HeaderNames.AuthKey,a)}fetch(a){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(a){return Promise.resolve(this.privAuthInfo)}};return rr.CognitiveSubscriptionKeyAuthentication=o,rr}var kr={},Pl;function cC(){if(Pl)return kr;Pl=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.CognitiveTokenAuthentication=void 0;const e=O(),t=Do(),r=le();let o=class uc{constructor(a,s){if(!a)throw new e.ArgumentNullError("fetchCallback");if(!s)throw new e.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=a,this.privFetchOnExpiryCallback=s}fetch(a){return this.privFetchCallback(a).then(s=>new t.AuthInfo(r.HeaderNames.Authorization,s===void 0?void 0:uc.privTokenPrefix+s))}fetchOnExpiry(a){return this.privFetchOnExpiryCallback(a).then(s=>new t.AuthInfo(r.HeaderNames.Authorization,s===void 0?void 0:uc.privTokenPrefix+s))}};return kr.CognitiveTokenAuthentication=o,o.privTokenPrefix="Bearer ",kr}var No={},Rl;function uC(){return Rl||(Rl=1,Object.defineProperty(No,"__esModule",{value:!0})),No}var xo={},bl;function lC(){return bl||(bl=1,Object.defineProperty(xo,"__esModule",{value:!0})),xo}var Or={},pt={},be={};const dt=IS(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var zo={},wl;function El(){return wl||(wl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LogLevel=void 0;const t=O();Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return t.EventType}})}(zo)),zo}var Mr={},Il;function x(){if(Il)return Mr;Il=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.Contracts=void 0;let e=class jt{static throwIfNullOrUndefined(r,o){if(r==null)throw new Error("throwIfNullOrUndefined:"+o)}static throwIfNull(r,o){if(r===null)throw new Error("throwIfNull:"+o)}static throwIfNullOrWhitespace(r,o){if(jt.throwIfNullOrUndefined(r,o),(""+r).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+o)}static throwIfNullOrTooLong(r,o,i){if(jt.throwIfNullOrUndefined(r,o),(""+r).length>i)throw new Error("throwIfNullOrTooLong:"+o+" (more than "+i.toString()+" characters)")}static throwIfNullOrTooShort(r,o,i){if(jt.throwIfNullOrUndefined(r,o),(""+r).length<i)throw new Error("throwIfNullOrTooShort:"+o+" (less than "+i.toString()+" characters)")}static throwIfDisposed(r){if(r)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(r,o){if(jt.throwIfNullOrUndefined(r,o),r.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+o);for(const i of r)jt.throwIfNullOrWhitespace(i,o)}static throwIfFileDoesNotExist(r,o){jt.throwIfNullOrWhitespace(r,o)}static throwIfNotUndefined(r,o){if(r!==void 0)throw new Error("throwIfNotUndefined:"+o)}};return Mr.Contracts=e,Mr}var Al;function pC(){if(Al)return be;Al=1;var e=be&&be.__createBinding||(Object.create?function(n,c,u,l){l===void 0&&(l=u),Object.defineProperty(n,l,{enumerable:!0,get:function(){return c[u]}})}:function(n,c,u,l){l===void 0&&(l=u),n[l]=c[u]}),t=be&&be.__setModuleDefault||(Object.create?function(n,c){Object.defineProperty(n,"default",{enumerable:!0,value:c})}:function(n,c){n.default=c}),r=be&&be.__importStar||function(n){if(n&&n.__esModule)return n;var c={};if(n!=null)for(var u in n)u!=="default"&&Object.prototype.hasOwnProperty.call(n,u)&&e(c,n,u);return t(c,n),c};Object.defineProperty(be,"__esModule",{value:!0}),be.ConsoleLoggingListener=void 0;const o=r(dt),i=El(),a=x();let s=class{constructor(c=i.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=c}set logPath(c){a.Contracts.throwIfNullOrUndefined(o.openSync,`
File System access not available`),this.privLogPath=c}set enableConsoleOutput(c){this.privEnableConsoleOutput=c}onEvent(c){if(c.eventType>=this.privLogLevelFilter){const u=this.toString(c);if(this.logCallback&&this.logCallback(u),this.privLogPath&&o.writeFileSync(this.privLogPath,u+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(c.eventType){case i.LogLevel.Debug:console.debug(u);break;case i.LogLevel.Info:console.info(u);break;case i.LogLevel.Warning:console.warn(u);break;case i.LogLevel.Error:console.error(u);break;default:console.log(u);break}}}toString(c){const u=[`${c.eventTime}`,`${c.name}`],l=c;for(const p in l)if(p&&c.hasOwnProperty(p)&&p!=="eventTime"&&p!=="eventType"&&p!=="eventId"&&p!=="name"&&p!=="constructor"){const d=l[p];let h="<NULL>";d!=null&&(typeof d=="number"||typeof d=="string"?h=d.toString():h=JSON.stringify(d)),u.push(`${p}: ${h}`)}return u.join(" | ")}};return be.ConsoleLoggingListener=s,be}var Lo={},Tl;function dC(){return Tl||(Tl=1,Object.defineProperty(Lo,"__esModule",{value:!0})),Lo}var jo={},qo={},_l;function ht(){return _l||(_l=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AudioStreamFormatImpl=e.AudioStreamFormat=e.AudioFormatTag=void 0;var t;(function(i){i[i.PCM=1]="PCM",i[i.MuLaw=2]="MuLaw",i[i.Siren=3]="Siren",i[i.MP3=4]="MP3",i[i.SILKSkype=5]="SILKSkype",i[i.OGG_OPUS=6]="OGG_OPUS",i[i.WEBM_OPUS=7]="WEBM_OPUS",i[i.ALaw=8]="ALaw",i[i.FLAC=9]="FLAC",i[i.OPUS=10]="OPUS",i[i.AMR_WB=11]="AMR_WB",i[i.G722=12]="G722"})(t=e.AudioFormatTag||(e.AudioFormatTag={}));class r{static getDefaultInputFormat(){return o.getDefaultInputFormat()}static getWaveFormat(a,s,n,c){return new o(a,s,n,c)}static getWaveFormatPCM(a,s,n){return new o(a,s,n)}}e.AudioStreamFormat=r;class o extends r{constructor(a=16e3,s=16,n=1,c=t.PCM){super();let u=!0;switch(c){case t.PCM:this.formatTag=1;break;case t.ALaw:this.formatTag=6;break;case t.MuLaw:this.formatTag=7;break;default:u=!1}if(this.bitsPerSample=s,this.samplesPerSec=a,this.channels=n,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),u){this.privHeader=new ArrayBuffer(44);const l=new DataView(this.privHeader);this.setString(l,0,"RIFF"),l.setUint32(4,0,!0),this.setString(l,8,"WAVEfmt "),l.setUint32(16,16,!0),l.setUint16(20,this.formatTag,!0),l.setUint16(22,this.channels,!0),l.setUint32(24,this.samplesPerSec,!0),l.setUint32(28,this.avgBytesPerSec,!0),l.setUint16(32,this.channels*(this.bitsPerSample/8),!0),l.setUint16(34,this.bitsPerSample,!0),this.setString(l,36,"data"),l.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new o}static getAudioContext(a){const s=window.AudioContext||window.webkitAudioContext||!1;if(s)return a!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new s({sampleRate:a}):new s;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(a,s,n){for(let c=0;c<n.length;c++)a.setUint8(s+c,n.charCodeAt(c))}}e.AudioStreamFormatImpl=o}(qo)),qo}var kl;function hC(){return kl||(kl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MicAudioSource=e.AudioWorkletSourceURLPropertyName=void 0;const t=k(),r=O(),o=ht();e.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";class i{constructor(s,n,c,u){this.privRecorder=s,this.deviceId=n,this.privStreams={},this.privOutputChunkSize=i.AUDIOFORMAT.avgBytesPerSec/10,this.privId=c||(0,r.createNoDashGuid)(),this.privEvents=new r.EventSource,this.privMediaStream=u||null,this.privIsClosing=!1}get format(){return Promise.resolve(i.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new r.Deferred;try{this.createAudioContext()}catch(c){if(c instanceof Error){const u=c;this.privInitializeDeferral.reject(u.name+": "+u.message)}else this.privInitializeDeferral.reject(c);return this.privInitializeDeferral.promise}const s=window.navigator;let n=s.getUserMedia||s.webkitGetUserMedia||s.mozGetUserMedia||s.msGetUserMedia;if(s.mediaDevices&&(n=(c,u,l)=>{s.mediaDevices.getUserMedia(c).then(u).catch(l)}),n){const c=()=>{this.onEvent(new r.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new r.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):n({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},u=>{this.privMediaStream=u,this.onEvent(new r.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},u=>{const l=`Error occurred during microphone initialization: ${u}`;this.privInitializeDeferral.reject(l),this.onEvent(new r.AudioSourceErrorEvent(this.privId,l))})};this.privContext.state==="suspended"?this.privContext.resume().then(c).catch(u=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${u}`)}):c()}else{const c="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(c),this.onEvent(new r.AudioSourceErrorEvent(c,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(s){return this.onEvent(new r.AudioStreamNodeAttachingEvent(this.privId,s)),this.listen(s).then(n=>(this.onEvent(new r.AudioStreamNodeAttachedEvent(this.privId,s)),{detach:async()=>(n.readEnded(),delete this.privStreams[s],this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,s)),this.turnOff()),id:()=>s,read:()=>n.read()}))}detach(s){s&&this.privStreams[s]&&(this.privStreams[s].close(),delete this.privStreams[s],this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,s)))}async turnOff(){for(const s in this.privStreams)if(s){const n=this.privStreams[s];n&&n.close()}this.onEvent(new r.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(await this.privInitializeDeferral,this.privInitializeDeferral=null),await this.destroyAudioContext()}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(s=>({bitspersample:i.AUDIOFORMAT.bitsPerSample,channelcount:i.AUDIOFORMAT.channels,connectivity:t.connectivity.Unknown,manufacturer:"Speech SDK",model:s,samplerate:i.AUDIOFORMAT.samplesPerSec,type:t.type.Microphones}))}setProperty(s,n){if(s===e.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(n);else throw new Error("Property '"+s+"' is not supported on Microphone.")}getMicrophoneLabel(){const s="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(s);this.privMicrophoneLabel=s;const n=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(n===void 0)return Promise.resolve(this.privMicrophoneLabel);const c=new r.Deferred;return navigator.mediaDevices.enumerateDevices().then(u=>{for(const l of u)if(l.deviceId===n){this.privMicrophoneLabel=l.label;break}c.resolve(this.privMicrophoneLabel)},()=>c.resolve(this.privMicrophoneLabel)),c.promise}async listen(s){await this.turnOn();const n=new r.ChunkedArrayBufferStream(this.privOutputChunkSize,s);this.privStreams[s]=n;try{this.privRecorder.record(this.privContext,this.privMediaStream,n)}catch(u){throw this.onEvent(new r.AudioStreamNodeErrorEvent(this.privId,s,u)),u}return n}onEvent(s){this.privEvents.onEvent(s),r.Events.instance.onEvent(s)}createAudioContext(){this.privContext||(this.privContext=o.AudioStreamFormatImpl.getAudioContext(i.AUDIOFORMAT.samplesPerSec))}async destroyAudioContext(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let s=!1;"close"in this.privContext&&(s=!0),s?this.privIsClosing||(this.privIsClosing=!0,await this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&await this.privContext.suspend()}}e.MicAudioSource=i,i.AUDIOFORMAT=o.AudioStreamFormat.getDefaultInputFormat()}(jo)),jo}var Dr={},Ol;function fC(){if(Ol)return Dr;Ol=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.FileAudioSource=void 0;const e=k(),t=O(),r=ht();let o=class{constructor(a,s,n){this.privStreams={},this.privHeaderEnd=44,this.privId=n||(0,t.createNoDashGuid)(),this.privEvents=new t.EventSource,this.privSource=a,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=a.name:this.privFilename=s||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const a=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new t.AudioSourceErrorEvent(a,"")),Promise.reject(a)}this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}id(){return this.privId}async attach(a){this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,a));const s=await this.upload(a);return this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,a)),Promise.resolve({detach:async()=>{s.readEnded(),delete this.privStreams[a],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,a)),await this.turnOff()},id:()=>a,read:()=>s.read()})}detach(a){a&&this.privStreams[a]&&(this.privStreams[a].close(),delete this.privStreams[a],this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,a)))}turnOff(){for(const a in this.privStreams)if(a){const s=this.privStreams[a];s&&!s.isClosed&&s.close()}return this.onEvent(new t.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(a=>Promise.resolve({bitspersample:a.bitsPerSample,channelcount:a.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:a.samplesPerSec,type:e.type.File}))}readHeader(){const s=this.privSource.slice(0,4296),n=new t.Deferred,c=u=>{const l=new DataView(u),p=v=>String.fromCharCode(l.getUint8(v),l.getUint8(v+1),l.getUint8(v+2),l.getUint8(v+3));if(p(0)!=="RIFF"){n.reject("Invalid WAV header in file, RIFF was not found");return}if(p(8)!=="WAVE"||p(12)!=="fmt "){n.reject("Invalid WAV header in file, WAVEfmt was not found");return}const d=l.getInt32(16,!0),h=l.getUint16(22,!0),f=l.getUint32(24,!0),g=l.getUint16(34,!0);let m=36+Math.max(d-16,0);for(;p(m)!=="data";m+=2)if(m>4288){n.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=m+8,n.resolve(r.AudioStreamFormat.getWaveFormatPCM(f,g,h))};if(typeof window<"u"&&typeof Blob<"u"&&s instanceof Blob){const u=new FileReader;u.onload=l=>{const p=l.target.result;c(p)},u.readAsArrayBuffer(s)}else{const u=s;c(u.buffer.slice(u.byteOffset,u.byteOffset+u.byteLength))}return n.promise}async upload(a){const s=n=>{const c=`Error occurred while processing '${this.privFilename}'. ${n}`;throw this.onEvent(new t.AudioStreamNodeErrorEvent(this.privId,a,c)),new Error(c)};try{await this.turnOn();const n=await this.privAudioFormatPromise,c=new t.ChunkedArrayBufferStream(n.avgBytesPerSec/10,a);this.privStreams[a]=c;const u=this.privSource.slice(this.privHeaderEnd),l=p=>{c.isClosed||(c.writeStreamChunk({buffer:p,isEnd:!1,timeReceived:Date.now()}),c.close())};if(typeof window<"u"&&typeof Blob<"u"&&u instanceof Blob){const p=new FileReader;p.onerror=d=>s(d.toString()),p.onload=d=>{const h=d.target.result;l(h)},p.readAsArrayBuffer(u)}else{const p=u;l(p.buffer.slice(p.byteOffset,p.byteOffset+p.byteLength))}return c}catch(n){s(n)}}onEvent(a){this.privEvents.onEvent(a),t.Events.instance.onEvent(a)}};return Dr.FileAudioSource=o,Dr}var Nr={},Ml;function vC(){if(Ml)return Nr;Ml=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.PcmRecorder=void 0;const e=O();class t{constructor(o){this.privStopInputOnRelease=o}record(o,i,a){const n=new e.RiffPcmEncoder(o.sampleRate,16e3),c=o.createMediaStreamSource(i),u=()=>{const p=(()=>{let d=0;try{return o.createScriptProcessor(d,1,1)}catch{d=2048;let f=o.sampleRate;for(;d<16384&&f>=32e3;)d<<=1,f>>=1;return o.createScriptProcessor(d,1,1)}})();p.onaudioprocess=d=>{const h=d.inputBuffer.getChannelData(0);if(a&&!a.isClosed){const f=n.encode(h);f&&a.writeStreamChunk({buffer:f,isEnd:!1,timeReceived:Date.now()})}},c.connect(p),p.connect(o.destination),this.privMediaResources={scriptProcessorNode:p,source:c,stream:i}},l=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(o.audioWorklet&&!l){if(!this.privSpeechProcessorScript){const p=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,d=new Blob([p],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(d)}o.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const p=new AudioWorkletNode(o,"speech-processor");p.port.onmessage=d=>{const h=d.data;if(a&&!a.isClosed){const f=n.encode(h);f&&a.writeStreamChunk({buffer:f,isEnd:!1,timeReceived:Date.now()})}},c.connect(p),p.connect(o.destination),this.privMediaResources={scriptProcessorNode:p,source:c,stream:i}}).catch(()=>{u()})}else try{u()}catch(p){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${p}`)}}releaseMediaResources(o){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(o.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(i=>i.stop()),this.privMediaResources.source=null))}setWorkletUrl(o){this.privSpeechProcessorScript=o}}return Nr.PcmRecorder=t,Nr}var xr={},fe={},Dl;function Nl(){if(Dl)return fe;Dl=1;var e=fe&&fe.__createBinding||(Object.create?function(d,h,f,g){g===void 0&&(g=f),Object.defineProperty(d,g,{enumerable:!0,get:function(){return h[f]}})}:function(d,h,f,g){g===void 0&&(g=f),d[g]=h[f]}),t=fe&&fe.__setModuleDefault||(Object.create?function(d,h){Object.defineProperty(d,"default",{enumerable:!0,value:h})}:function(d,h){d.default=h}),r=fe&&fe.__importStar||function(d){if(d&&d.__esModule)return d;var h={};if(d!=null)for(var f in d)f!=="default"&&Object.prototype.hasOwnProperty.call(d,f)&&e(h,d,f);return t(h,d),h},o=fe&&fe.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(fe,"__esModule",{value:!0}),fe.WebsocketMessageAdapter=void 0;const i=r(dt),a=r(dt),s=o(dt),n=o(dt),c=o(dt),u=le(),l=O();let p=class lc{constructor(h,f,g,m,v,y){if(!h)throw new l.ArgumentNullError("uri");if(!g)throw new l.ArgumentNullError("messageFormatter");this.proxyInfo=m,this.privConnectionEvents=new l.EventSource,this.privConnectionId=f,this.privMessageFormatter=g,this.privConnectionState=l.ConnectionState.None,this.privUri=h,this.privHeaders=v,this.privEnableCompression=y,this.privHeaders[u.HeaderNames.ConnectionId]=this.privConnectionId,this.privHeaders.connectionId=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===l.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new l.Deferred,this.privCertificateValidatedDeferral=new l.Deferred,this.privConnectionState=l.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!lc.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{let f=new URL(this.privUri).protocol;f?.toLocaleLowerCase()==="wss:"?f="https:":f?.toLocaleLowerCase()==="ws:"&&(f="http:");const g={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression,followRedirects:f.toLocaleLowerCase()==="https:"};this.privCertificateValidatedDeferral.resolve(),g.agent=this.getAgent(),g.agent.protocol=f,this.privWebsocketClient=new c.default(this.privUri,g),this.privWebsocketClient.on("redirect",m=>{const v=new l.ConnectionRedirectEvent(this.privConnectionId,m,this.privUri,`Getting redirect URL from endpoint ${this.privUri} with redirect URL '${m}'`);l.Events.instance.onEvent(v)})}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new l.Queue,this.privDisconnectDeferral=new l.Deferred,this.privSendMessageQueue=new l.Queue,this.processSendQueue().catch(h=>{l.Events.instance.onEvent(new l.BackgroundEvent(h))})}catch(h){return this.privConnectionEstablishDeferral.resolve(new l.ConnectionOpenResponse(500,h)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new l.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=l.ConnectionState.Connected,this.onEvent(new l.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new l.ConnectionOpenResponse(200,""))},h=>{this.privConnectionEstablishDeferral.reject(h)})},this.privWebsocketClient.onerror=h=>{this.onEvent(new l.ConnectionErrorEvent(this.privConnectionId,h.message,h.type)),this.privLastErrorReceived=h.message},this.privWebsocketClient.onclose=h=>{this.privConnectionState===l.ConnectionState.Connecting?(this.privConnectionState=l.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new l.ConnectionOpenResponse(h.code,h.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=l.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new l.ConnectionClosedEvent(this.privConnectionId,h.code,h.reason))),this.onClose(h.code,h.reason).catch(f=>{l.Events.instance.onEvent(new l.BackgroundEvent(f))})},this.privWebsocketClient.onmessage=h=>{const f=new Date().toISOString();if(this.privConnectionState===l.ConnectionState.Connected){const g=new l.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(g.promise),h.data instanceof ArrayBuffer){const m=new l.RawWebsocketMessage(l.MessageType.Binary,h.data);this.privMessageFormatter.toConnectionMessage(m).then(v=>{this.onEvent(new l.ConnectionMessageReceivedEvent(this.privConnectionId,f,v)),g.resolve(v)},v=>{g.reject(`Invalid binary message format. Error: ${v}`)})}else{const m=new l.RawWebsocketMessage(l.MessageType.Text,h.data);this.privMessageFormatter.toConnectionMessage(m).then(v=>{this.onEvent(new l.ConnectionMessageReceivedEvent(this.privConnectionId,f,v)),g.resolve(v)},v=>{g.reject(`Invalid text message format. Error: ${v}`)})}}},this.privConnectionEstablishDeferral.promise}send(h){if(this.privConnectionState!==l.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${l.ConnectionState[this.privConnectionState]} state`);const f=new l.Deferred,g=new l.Deferred;return this.privSendMessageQueue.enqueueFromPromise(g.promise),this.privMessageFormatter.fromConnectionMessage(h).then(m=>{g.resolve({Message:h,RawWebsocketMessage:m,sendStatusDeferral:f})},m=>{g.reject(`Error formatting the message. ${m}`)}),f.promise}read(){return this.privConnectionState!==l.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(h){if(this.privWebsocketClient)this.privConnectionState!==l.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,h||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(h){try{if(!h)return Promise.resolve();if(this.onEvent(new l.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),h.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(h.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+h.Message.id+" "+new Error().stack);return Promise.resolve()}catch(f){return Promise.reject(`websocket send error: ${f}`)}}async onClose(h,f){const g=`Connection closed. ${h}: ${f}`;this.privConnectionState=l.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),await this.privReceivingMessageQueue.drainAndDispose(()=>{},g),await this.privSendMessageQueue.drainAndDispose(m=>{m.sendStatusDeferral.reject(g)},g)}async processSendQueue(){for(;;){const f=await this.privSendMessageQueue.dequeue();if(!f)return;try{await this.sendRawMessage(f),f.sendStatusDeferral.resolve()}catch(g){f.sendStatusDeferral.reject(g)}}}onEvent(h){this.privConnectionEvents.onEvent(h),l.Events.instance.onEvent(h)}getAgent(){const h=new s.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(h.proxyInfo=this.proxyInfo),h}static GetProxyAgent(h){const f={host:h.HostName,port:h.Port};return h.UserName?f.headers={"Proxy-Authentication":"Basic "+new Buffer(`${h.UserName}:${h.Password===void 0?"":h.Password}`).toString("base64")}:f.headers={},f.headers.requestOCSP="true",new n.default(f)}createConnection(h,f){let g;if(f={...f,requestOCSP:!0,servername:f.host},this.proxyInfo){const v=lc.GetProxyAgent(this.proxyInfo);g=new Promise((y,S)=>{v.callback(h,f,(P,b)=>{P?S(P):y(b)})})}else f.secureEndpoint?g=Promise.resolve(a.connect(f)):g=Promise.resolve(i.connect(f));return g}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};return fe.WebsocketMessageAdapter=p,p.forceNpmWebSocket=!1,fe}var xl;function gC(){if(xl)return xr;xl=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.WebsocketConnection=void 0;const e=O(),t=Nl();let r=class{constructor(i,a,s,n,c,u=!1,l){if(this.privIsDisposed=!1,!i)throw new e.ArgumentNullError("uri");if(!n)throw new e.ArgumentNullError("messageFormatter");this.privMessageFormatter=n;let p="",d=0;if(a){for(const h in a)if(h){p+=d===0&&i.indexOf("?")===-1?"?":"&";const f=encodeURIComponent(h);p+=f;let g=a[h];g&&(g=encodeURIComponent(g),p+=`=${g}`),d++}}if(s){for(const h in s)if(h){p+=d===0&&i.indexOf("?")===-1?"?":"&";const f=encodeURIComponent(s[h]);p+=`${h}=${f}`,d++}}this.privUri=i+p,this.privId=l||(0,e.createNoDashGuid)(),this.privConnectionMessageAdapter=new t.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,c,s,u)}async dispose(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&await this.privConnectionMessageAdapter.close()}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(i){return this.privConnectionMessageAdapter.send(i)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}};return xr.WebsocketConnection=r,xr}var zr={},zl;function mC(){if(zl)return zr;zl=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.ReplayableAudioNode=void 0;let e=class{constructor(o,i){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=o,this.privBytesPerSecond=i}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){const o=this.privReplayOffset-this.privBufferStartOffset;let i=Math.round(o*this.privBytesPerSecond*1e-7);i%2!==0&&i++;let a=0;for(;a<this.privBuffers.length&&i>=this.privBuffers[a].chunk.buffer.byteLength;)i-=this.privBuffers[a++].chunk.buffer.byteLength;if(a<this.privBuffers.length){const s=this.privBuffers[a].chunk.buffer.slice(i);return this.privReplayOffset+=s.byteLength/this.privBytesPerSecond*1e7,a===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:s,isEnd:!1,timeReceived:this.privBuffers[a].chunk.timeReceived})}}return this.privAudioNode.read().then(o=>(o&&o.buffer&&this.privBuffers&&(this.privBuffers.push(new t(o,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=o.buffer.byteLength),o))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(o){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=o;const i=o-this.privBufferStartOffset;let a=Math.round(i*this.privBytesPerSecond*1e-7),s=0;for(;s<this.privBuffers.length&&a>=this.privBuffers[s].chunk.buffer.byteLength;)a-=this.privBuffers[s++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(o-a/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(s)}findTimeAtOffset(o){if(o<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(const i of this.privBuffers){const a=i.byteOffset/this.privBytesPerSecond*1e7,s=a+i.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(o>=a&&o<=s)return i.chunk.timeReceived}return 0}};zr.ReplayableAudioNode=e;class t{constructor(o,i,a){this.chunk=o,this.serial=i,this.byteOffset=a}}return zr}var Lr={},Fo={},Fe={},we={},Ll;function jl(){if(Ll)return we;Ll=1;var e=we&&we.__createBinding||(Object.create?function(s,n,c,u){u===void 0&&(u=c),Object.defineProperty(s,u,{enumerable:!0,get:function(){return n[c]}})}:function(s,n,c,u){u===void 0&&(u=c),s[u]=n[c]}),t=we&&we.__setModuleDefault||(Object.create?function(s,n){Object.defineProperty(s,"default",{enumerable:!0,value:n})}:function(s,n){s.default=n}),r=we&&we.__importStar||function(s){if(s&&s.__esModule)return s;var n={};if(s!=null)for(var c in s)c!=="default"&&Object.prototype.hasOwnProperty.call(s,c)&&e(n,s,c);return t(n,s),n};Object.defineProperty(we,"__esModule",{value:!0}),we.AudioFileWriter=void 0;const o=r(dt),i=x();let a=class{constructor(n){i.Contracts.throwIfNullOrUndefined(o.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=o.openSync(n,"w")}set format(n){i.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=n;let c=0;this.privAudioFormat.hasHeader&&(c=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=o.createWriteStream("",{fd:this.privFd,start:c,autoClose:!1}))}write(n){i.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(n.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),o.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),o.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}};return we.AudioFileWriter=a,we}var ve={},ql;function Fl(){if(ql)return ve;ql=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.PullAudioInputStreamImpl=ve.PullAudioInputStream=ve.PushAudioInputStreamImpl=ve.PushAudioInputStream=ve.AudioInputStream=void 0;const e=k(),t=O(),r=ut(),o=T(),i=ht();let a=class{constructor(){}static createPushStream(p){return s.create(p)}static createPullStream(p,d){return c.create(p,d)}};ve.AudioInputStream=a;class s extends a{static create(p){return new n(p)}}ve.PushAudioInputStream=s;class n extends s{constructor(p){super(),p===void 0?this.privFormat=i.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=p,this.privEvents=new t.EventSource,this.privId=(0,r.createNoDashGuid)(),this.privStream=new t.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(p){this.privStream.writeStreamChunk({buffer:p,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}async attach(p){this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,p)),await this.turnOn();const d=this.privStream;return this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,p)),{detach:async()=>(this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,p)),this.turnOff()),id:()=>p,read:()=>d.read()}}detach(p){this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,p))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:e.type.Stream})}onEvent(p){this.privEvents.onEvent(p),t.Events.instance.onEvent(p)}toBuffer(p){const d=Buffer.alloc(p.byteLength),h=new Uint8Array(p);for(let f=0;f<d.length;++f)d[f]=h[f];return d}}ve.PushAudioInputStreamImpl=n;class c extends a{constructor(){super()}static create(p,d){return new u(p,d)}}ve.PullAudioInputStream=c;class u extends c{constructor(p,d){super(),d===void 0?this.privFormat=o.AudioStreamFormat.getDefaultInputFormat():this.privFormat=d,this.privEvents=new t.EventSource,this.privId=(0,r.createNoDashGuid)(),this.privCallback=p,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new t.AudioSourceInitializingEvent(this.privId)),this.onEvent(new t.AudioSourceReadyEvent(this.privId))}async attach(p){return this.onEvent(new t.AudioStreamNodeAttachingEvent(this.privId,p)),await this.turnOn(),this.onEvent(new t.AudioStreamNodeAttachedEvent(this.privId,p)),{detach:()=>(this.privCallback.close(),this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,p)),this.turnOff()),id:()=>p,read:()=>{let d=0,h;for(;d<this.privBufferSize;){const f=new ArrayBuffer(this.privBufferSize-d),g=this.privCallback.read(f);if(h===void 0?h=f:new Int8Array(h).set(new Int8Array(f),d),g===0)break;d+=g}return Promise.resolve({buffer:h.slice(0,d),isEnd:this.privIsClosed||d===0,timeReceived:Date.now()})}}}detach(p){this.onEvent(new t.AudioStreamNodeDetachedEvent(this.privId,p))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:e.type.Stream})}onEvent(p){this.privEvents.onEvent(p),t.Events.instance.onEvent(p)}}return ve.PullAudioInputStreamImpl=u,ve}var ge={},jr={},Bo={},Bl;function Ul(){return Bl||(Bl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisOutputFormat=void 0,function(t){t[t.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",t[t.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",t[t.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",t[t.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",t[t.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",t[t.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",t[t.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",t[t.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",t[t.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",t[t.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",t[t.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",t[t.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",t[t.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",t[t.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",t[t.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",t[t.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",t[t.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",t[t.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",t[t.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",t[t.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",t[t.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",t[t.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",t[t.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",t[t.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",t[t.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",t[t.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",t[t.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",t[t.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",t[t.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",t[t.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",t[t.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",t[t.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",t[t.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",t[t.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",t[t.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",t[t.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",t[t.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",t[t.AmrWb16000Hz=37]="AmrWb16000Hz",t[t.G72216Khz64Kbps=38]="G72216Khz64Kbps"}(e.SpeechSynthesisOutputFormat||(e.SpeechSynthesisOutputFormat={}))}(Bo)),Bo}var $l;function qr(){if($l)return jr;$l=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.AudioOutputFormatImpl=void 0;const e=Ul(),t=ht();class r extends t.AudioStreamFormatImpl{constructor(i,a,s,n,c,u,l,p,d){super(s,u,a,i),this.formatTag=i,this.avgBytesPerSec=n,this.blockAlign=c,this.priAudioFormatString=l,this.priRequestAudioFormatString=p,this.priHasHeader=d}static fromSpeechSynthesisOutputFormat(i){return i===void 0?r.getDefaultOutputFormat():r.fromSpeechSynthesisOutputFormatString(r.SpeechSynthesisOutputFormatToString[i])}static fromSpeechSynthesisOutputFormatString(i){switch(i){case"raw-8khz-8bit-mono-mulaw":return new r(t.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,i,i,!1);case"riff-16khz-16kbps-mono-siren":return new r(t.AudioFormatTag.Siren,1,16e3,2e3,40,0,i,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new r(t.AudioFormatTag.Siren,1,16e3,2e3,40,0,i,i,!1);case"audio-16khz-32kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,16e3,4096,2,16,i,i,!1);case"audio-16khz-128kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,16e3,16384,2,16,i,i,!1);case"audio-16khz-64kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,16e3,8192,2,16,i,i,!1);case"audio-24khz-48kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,24e3,6144,2,16,i,i,!1);case"audio-24khz-96kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,24e3,12288,2,16,i,i,!1);case"audio-24khz-160kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,24e3,20480,2,16,i,i,!1);case"raw-16khz-16bit-mono-truesilk":return new r(t.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,i,i,!1);case"riff-8khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,8e3,16e3,2,16,i,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,24e3,48e3,2,16,i,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new r(t.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,i,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,16e3,32e3,2,16,i,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,24e3,48e3,2,16,i,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,8e3,16e3,2,16,i,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new r(t.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,i,i,!1);case"ogg-24khz-16bit-mono-opus":return new r(t.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,i,i,!1);case"raw-48khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,48e3,96e3,2,16,i,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,48e3,96e3,2,16,i,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,48e3,12288,2,16,i,i,!1);case"audio-48khz-192kbitrate-mono-mp3":return new r(t.AudioFormatTag.MP3,1,48e3,24576,2,16,i,i,!1);case"ogg-48khz-16bit-mono-opus":return new r(t.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,i,i,!1);case"webm-16khz-16bit-mono-opus":return new r(t.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,i,i,!1);case"webm-24khz-16bit-mono-opus":return new r(t.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,i,i,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new r(t.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,i,i,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new r(t.AudioFormatTag.OPUS,1,16e3,4e3,2,16,i,i,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new r(t.AudioFormatTag.OPUS,1,24e3,6e3,2,16,i,i,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new r(t.AudioFormatTag.OPUS,1,24e3,3e3,2,16,i,i,!1);case"audio-24khz-16bit-mono-flac":return new r(t.AudioFormatTag.FLAC,1,24e3,24e3,2,16,i,i,!1);case"audio-48khz-16bit-mono-flac":return new r(t.AudioFormatTag.FLAC,1,48e3,3e4,2,16,i,i,!1);case"raw-24khz-16bit-mono-truesilk":return new r(t.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,i,i,!1);case"raw-8khz-8bit-mono-alaw":return new r(t.AudioFormatTag.ALaw,1,8e3,8e3,1,8,i,i,!1);case"riff-8khz-8bit-mono-alaw":return new r(t.AudioFormatTag.ALaw,1,8e3,8e3,1,8,i,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,22050,44100,2,16,i,i,!1);case"riff-22050hz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,22050,44100,2,16,i,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,44100,88200,2,16,i,i,!1);case"riff-44100hz-16bit-mono-pcm":return new r(t.AudioFormatTag.PCM,1,44100,88200,2,16,i,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new r(t.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,i,i,!1);case"g722-16khz-64kbps":return new r(t.AudioFormatTag.G722,1,16e3,8e3,2,16,i,i,!1);case"riff-16khz-16bit-mono-pcm":default:return new r(t.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return r.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(i){if(this.priHasHeader){const a=new DataView(this.privHeader);a.setUint32(4,i+this.privHeader.byteLength-8,!0),a.setUint32(40,i,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(i){if(!this.hasHeader)return i;this.updateHeader(i.byteLength);const a=new Uint8Array(i.byteLength+this.header.byteLength);return a.set(new Uint8Array(this.header),0),a.set(new Uint8Array(i),this.header.byteLength),a.buffer}}return jr.AudioOutputFormatImpl=r,r.SpeechSynthesisOutputFormatToString={[e.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[e.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[e.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[e.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[e.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[e.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[e.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[e.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[e.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[e.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"},jr}var Vl;function Vt(){if(Vl)return ge;Vl=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.PushAudioOutputStreamImpl=ge.PushAudioOutputStream=ge.PullAudioOutputStreamImpl=ge.PullAudioOutputStream=ge.AudioOutputStream=void 0;const e=O(),t=x(),r=qr();let o=class{constructor(){}static createPullStream(){return i.create()}};ge.AudioOutputStream=o;class i extends o{static create(){return new a}}ge.PullAudioOutputStream=i;class a extends i{constructor(){super(),this.privId=(0,e.createNoDashGuid)(),this.privStream=new e.Stream}set format(u){u==null&&(this.privFormat=r.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=u}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}async read(u){const l=new Int8Array(u);let p=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>u.byteLength)return l.set(this.privLastChunkView.slice(0,u.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(u.byteLength),Promise.resolve(u.byteLength);l.set(this.privLastChunkView),p=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;p<u.byteLength&&!this.privStream.isReadEnded;){const d=await this.privStream.read();if(d!==void 0&&!d.isEnd){let h;d.buffer.byteLength>u.byteLength-p?(h=d.buffer.slice(0,u.byteLength-p),this.privLastChunkView=new Int8Array(d.buffer.slice(u.byteLength-p))):h=d.buffer,l.set(new Int8Array(h),p),p+=h.byteLength}else this.privStream.readEnded()}return p}write(u){t.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:u,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}ge.PullAudioOutputStreamImpl=a;class s extends o{constructor(){super()}static create(u){return new n(u)}}ge.PushAudioOutputStream=s;class n extends s{constructor(u){super(),this.privId=(0,e.createNoDashGuid)(),this.privCallback=u}set format(u){}write(u){this.privCallback.write&&this.privCallback.write(u)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}return ge.PushAudioOutputStreamImpl=n,ge}var Wl;function Hl(){if(Wl)return Fe;Wl=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.AudioOutputConfigImpl=Fe.AudioConfigImpl=Fe.AudioConfig=void 0;const e=ie(),t=x(),r=T(),o=jl(),i=Fl(),a=Vt();let s=class zv{static fromDefaultMicrophoneInput(){const l=new e.PcmRecorder(!0);return new n(new e.MicAudioSource(l))}static fromMicrophoneInput(l){const p=new e.PcmRecorder(!0);return new n(new e.MicAudioSource(p,l))}static fromWavFileInput(l,p="unnamedBuffer.wav"){return new n(new e.FileAudioSource(l,p))}static fromStreamInput(l){if(l instanceof r.PullAudioInputStreamCallback)return new n(new i.PullAudioInputStreamImpl(l));if(l instanceof r.AudioInputStream)return new n(l);if(typeof MediaStream<"u"&&l instanceof MediaStream){const p=new e.PcmRecorder(!1);return new n(new e.MicAudioSource(p,null,null,l))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new c(new r.SpeakerAudioDestination)}static fromSpeakerOutput(l){if(l===void 0)return zv.fromDefaultSpeakerOutput();if(l instanceof r.SpeakerAudioDestination)return new c(l);throw new Error("Not Supported Type")}static fromAudioFileOutput(l){return new c(new o.AudioFileWriter(l))}static fromStreamOutput(l){if(l instanceof r.PushAudioOutputStreamCallback)return new c(new a.PushAudioOutputStreamImpl(l));if(l instanceof r.PushAudioOutputStream)return new c(l);if(l instanceof r.PullAudioOutputStream)return new c(l);throw new Error("Not Supported Type")}};Fe.AudioConfig=s;class n extends s{constructor(l){super(),this.privSource=l}get format(){return this.privSource.format}close(l,p){this.privSource.turnOff().then(()=>{l&&l()},d=>{p&&p(d)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(l){return this.privSource.attach(l)}detach(l){return this.privSource.detach(l)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(l,p){if(t.Contracts.throwIfNull(p,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(l,p);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(l,p){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(l,p);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}Fe.AudioConfigImpl=n;class c extends s{constructor(l){super(),this.privDestination=l}set format(l){this.privDestination.format=l}write(l){this.privDestination.write(l)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}return Fe.AudioOutputConfigImpl=c,Fe}var Uo={},Kl;function yC(){return Kl||(Kl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationReason=void 0,function(t){t[t.Error=0]="Error",t[t.EndOfStream=1]="EndOfStream"}(e.CancellationReason||(e.CancellationReason={}))}(Uo)),Uo}var Fr={},Jl;function SC(){if(Jl)return Fr;Jl=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.PullAudioInputStreamCallback=void 0;let e=class{};return Fr.PullAudioInputStreamCallback=e,Fr}var Br={},Gl;function CC(){if(Gl)return Br;Gl=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.PushAudioOutputStreamCallback=void 0;let e=class{};return Br.PushAudioOutputStreamCallback=e,Br}var Ur={},Ql;function PC(){if(Ql)return Ur;Ql=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.KeywordRecognitionModel=void 0;const e=x();let t=class{constructor(){this.privDisposed=!1}static fromFile(o){throw e.Contracts.throwIfFileDoesNotExist(o,"fileName"),new Error("Not yet implemented.")}static fromStream(o){throw e.Contracts.throwIfNull(o,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}};return Ur.KeywordRecognitionModel=t,Ur}var $r={},Yl;function RC(){if(Yl)return $r;Yl=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.SessionEventArgs=void 0;let e=class{constructor(r){this.privSessionId=r}get sessionId(){return this.privSessionId}};return $r.SessionEventArgs=e,$r}var Vr={},Zl;function bC(){if(Zl)return Vr;Zl=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.RecognitionEventArgs=void 0;const e=T();let t=class extends e.SessionEventArgs{constructor(o,i){super(i),this.privOffset=o}get offset(){return this.privOffset}};return Vr.RecognitionEventArgs=t,Vr}var $o={},Xl;function wC(){return Xl||(Xl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OutputFormat=void 0,function(t){t[t.Simple=0]="Simple",t[t.Detailed=1]="Detailed"}(e.OutputFormat||(e.OutputFormat={}))}($o)),$o}var Wr={},ep;function EC(){if(ep)return Wr;ep=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.IntentRecognitionEventArgs=void 0;const e=T();let t=class extends e.RecognitionEventArgs{constructor(o,i,a){super(i,a),this.privResult=o}get result(){return this.privResult}};return Wr.IntentRecognitionEventArgs=t,Wr}var Hr={},tp;function IC(){if(tp)return Hr;tp=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.RecognitionResult=void 0;let e=class{constructor(r,o,i,a,s,n,c,u,l,p){this.privResultId=r,this.privReason=o,this.privText=i,this.privDuration=a,this.privOffset=s,this.privLanguage=n,this.privLanguageDetectionConfidence=c,this.privErrorDetails=u,this.privJson=l,this.privProperties=p}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}};return Hr.RecognitionResult=e,Hr}var Kr={},rp;function AC(){if(rp)return Kr;rp=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.SpeechRecognitionResult=void 0;const e=T();let t=class extends e.RecognitionResult{constructor(o,i,a,s,n,c,u,l,p,d,h){super(o,i,a,s,n,c,u,p,d,h),this.privSpeakerId=l}get speakerId(){return this.privSpeakerId}};return Kr.SpeechRecognitionResult=t,Kr}var Jr={},np;function TC(){if(np)return Jr;np=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.IntentRecognitionResult=void 0;const e=T();let t=class extends e.SpeechRecognitionResult{constructor(o,i,a,s,n,c,u,l,p,d,h){super(i,a,s,n,c,u,l,void 0,p,d,h),this.privIntentId=o}get intentId(){return this.privIntentId}};return Jr.IntentRecognitionResult=t,Jr}var ft={},ip;function _C(){if(ip)return ft;ip=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.LanguageUnderstandingModelImpl=ft.LanguageUnderstandingModel=void 0;const e=x();let t=class{constructor(){}static fromEndpoint(i){e.Contracts.throwIfNull(i,"uri"),e.Contracts.throwIfNullOrWhitespace(i.hostname,"uri");const a=new r,s=i.host.indexOf(".");if(s===-1)throw new Error("Could not determine region from endpoint");a.region=i.host.substr(0,s);const n=i.pathname.lastIndexOf("/")+1;if(n===-1)throw new Error("Could not determine appId from endpoint");if(a.appId=i.pathname.substr(n),a.subscriptionKey=i.searchParams.get("subscription-key"),a.subscriptionKey===void 0)throw new Error("Could not determine subscription key from endpoint");return a}static fromAppId(i){e.Contracts.throwIfNullOrWhitespace(i,"appId");const a=new r;return a.appId=i,a}static fromSubscription(i,a,s){e.Contracts.throwIfNullOrWhitespace(i,"subscriptionKey"),e.Contracts.throwIfNullOrWhitespace(a,"appId"),e.Contracts.throwIfNullOrWhitespace(s,"region");const n=new r;return n.appId=a,n.region=s,n.subscriptionKey=i,n}};ft.LanguageUnderstandingModel=t;class r extends t{}return ft.LanguageUnderstandingModelImpl=r,ft}var Be={},sp;function kC(){if(sp)return Be;sp=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.MeetingTranscriptionEventArgs=Be.ConversationTranscriptionEventArgs=Be.SpeechRecognitionEventArgs=void 0;const e=T();let t=class extends e.RecognitionEventArgs{constructor(a,s,n){super(s,n),this.privResult=a}get result(){return this.privResult}};Be.SpeechRecognitionEventArgs=t;class r extends e.RecognitionEventArgs{constructor(a,s,n){super(s,n),this.privResult=a}get result(){return this.privResult}}Be.ConversationTranscriptionEventArgs=r;class o extends t{}return Be.MeetingTranscriptionEventArgs=o,Be}var Gr={},Qr={},op;function Yr(){if(op)return Qr;op=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.CancellationEventArgsBase=void 0;const e=T();let t=class extends e.RecognitionEventArgs{constructor(o,i,a,s,n){super(s,n),this.privReason=o,this.privErrorDetails=i,this.privErrorCode=a}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return Qr.CancellationEventArgsBase=t,Qr}var ap;function OC(){if(ap)return Gr;ap=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.SpeechRecognitionCanceledEventArgs=void 0;const e=Yr();let t=class extends e.CancellationEventArgsBase{};return Gr.SpeechRecognitionCanceledEventArgs=t,Gr}var Zr={},cp;function MC(){if(cp)return Zr;cp=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.TranslationRecognitionEventArgs=void 0;const e=T();let t=class extends e.RecognitionEventArgs{constructor(o,i,a){super(i,a),this.privResult=o}get result(){return this.privResult}};return Zr.TranslationRecognitionEventArgs=t,Zr}var Xr={},up;function DC(){if(up)return Xr;up=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.TranslationSynthesisEventArgs=void 0;const e=T();let t=class extends e.SessionEventArgs{constructor(o,i){super(i),this.privResult=o}get result(){return this.privResult}};return Xr.TranslationSynthesisEventArgs=t,Xr}var en={},lp;function pp(){if(lp)return en;lp=1,Object.defineProperty(en,"__esModule",{value:!0}),en.TranslationRecognitionResult=void 0;const e=T();let t=class Lv extends e.SpeechRecognitionResult{constructor(o,i,a,s,n,c,u,l,p,d,h){super(i,a,s,n,c,u,l,void 0,p,d,h),this.privTranslations=o}static fromSpeechRecognitionResult(o){return new Lv(void 0,o.resultId,o.reason,o.text,o.duration,o.offset,o.language,o.languageDetectionConfidence,o.errorDetails,o.json,o.properties)}get translations(){return this.privTranslations}};return en.TranslationRecognitionResult=t,en}var tn={},dp;function NC(){if(dp)return tn;dp=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.TranslationSynthesisResult=void 0;let e=class{constructor(r,o){this.privReason=r,this.privAudio=o}get audio(){return this.privAudio}get reason(){return this.privReason}};return tn.TranslationSynthesisResult=e,tn}var Vo={},hp;function xC(){return hp||(hp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ResultReason=void 0,function(t){t[t.NoMatch=0]="NoMatch",t[t.Canceled=1]="Canceled",t[t.RecognizingSpeech=2]="RecognizingSpeech",t[t.RecognizedSpeech=3]="RecognizedSpeech",t[t.RecognizedKeyword=4]="RecognizedKeyword",t[t.RecognizingIntent=5]="RecognizingIntent",t[t.RecognizedIntent=6]="RecognizedIntent",t[t.TranslatingSpeech=7]="TranslatingSpeech",t[t.TranslatedSpeech=8]="TranslatedSpeech",t[t.SynthesizingAudio=9]="SynthesizingAudio",t[t.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",t[t.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",t[t.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",t[t.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",t[t.RecognizedSpeakers=14]="RecognizedSpeakers",t[t.RecognizedSpeaker=15]="RecognizedSpeaker",t[t.ResetVoiceProfile=16]="ResetVoiceProfile",t[t.DeletedVoiceProfile=17]="DeletedVoiceProfile",t[t.VoicesListRetrieved=18]="VoicesListRetrieved",t[t.TranslatingParticipantSpeech=19]="TranslatingParticipantSpeech",t[t.TranslatedParticipantSpeech=20]="TranslatedParticipantSpeech",t[t.TranslatedInstantMessage=21]="TranslatedInstantMessage",t[t.TranslatedParticipantInstantMessage=22]="TranslatedParticipantInstantMessage"}(e.ResultReason||(e.ResultReason={}))}(Vo)),Vo}var vt={},fp;function zC(){if(fp)return vt;fp=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.SpeechConfigImpl=vt.SpeechConfig=void 0;const e=k(),t=x(),r=T();let o=class{constructor(){}static fromSubscription(s,n){t.Contracts.throwIfNullOrWhitespace(s,"subscriptionKey"),t.Contracts.throwIfNullOrWhitespace(n,"region");const c=new i;return c.setProperty(r.PropertyId.SpeechServiceConnection_Region,n),c.setProperty(r.PropertyId.SpeechServiceConnection_IntentRegion,n),c.setProperty(r.PropertyId.SpeechServiceConnection_Key,s),c}static fromEndpoint(s,n){t.Contracts.throwIfNull(s,"endpoint");const c=typeof n=="string"&&n.trim().length>0,u=typeof n=="object"&&n!==null&&typeof n.getToken=="function";if(n!==void 0&&!c&&!u)throw new Error("Invalid 'auth' parameter: must be a non-empty key string or a valid TokenCredential object.");const l=typeof n=="object"?new i(n):new i;return l.setProperty(r.PropertyId.SpeechServiceConnection_Endpoint,s.href),typeof n=="string"&&n.trim().length>0&&l.setProperty(r.PropertyId.SpeechServiceConnection_Key,n),l}static fromHost(s,n){t.Contracts.throwIfNull(s,"hostName");const c=new i;return c.setProperty(r.PropertyId.SpeechServiceConnection_Host,s.protocol+"//"+s.hostname+(s.port===""?"":":"+s.port)),c.setProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),n!==void 0&&c.setProperty(r.PropertyId.SpeechServiceConnection_Key,n),c}static fromAuthorizationToken(s,n){t.Contracts.throwIfNull(s,"authorizationToken"),t.Contracts.throwIfNullOrWhitespace(n,"region");const c=new i;return c.setProperty(r.PropertyId.SpeechServiceConnection_Region,n),c.setProperty(r.PropertyId.SpeechServiceConnection_IntentRegion,n),c.authorizationToken=s,c}close(){}};vt.SpeechConfig=o;class i extends o{constructor(s){super(),this.privProperties=new r.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=r.OutputFormat.Simple,this.privTokenCredential=s}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(s){this.privProperties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,s)}get speechRecognitionLanguage(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(s){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,s)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(s){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,s)}get outputFormat(){return r.OutputFormat[this.privProperties.getProperty(e.OutputFormatPropertyName,void 0)]}set outputFormat(s){this.privProperties.setProperty(e.OutputFormatPropertyName,r.OutputFormat[s])}get endpointId(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(s){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_EndpointId,s)}get tokenCredential(){return this.privTokenCredential}setProperty(s,n){t.Contracts.throwIfNull(n,"value"),this.privProperties.setProperty(s,n)}getProperty(s,n){return this.privProperties.getProperty(s,n)}setProxy(s,n,c,u){this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyHostName],s),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPort],n),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyUserName],c),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPassword],u)}setServiceProperty(s,n){const c=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));c[s]=n,this.privProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(c))}setProfanity(s){this.privProperties.setProperty(r.PropertyId.SpeechServiceResponse_ProfanityOption,r.ProfanityOption[s])}enableAudioLogging(){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true"),this.privProperties.setProperty(e.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Detailed])}enableDictation(){this.privProperties.setProperty(e.ForceDictationPropertyName,"true")}clone(){const s=new i(this.tokenCredential);return s.privProperties=this.privProperties.clone(),s}get speechSynthesisLanguage(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(s){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage,s)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(s){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthVoice,s)}get speechSynthesisOutputFormat(){return r.SpeechSynthesisOutputFormat[this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(s){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,r.SpeechSynthesisOutputFormat[s])}}return vt.SpeechConfigImpl=i,vt}var gt={},vp;function LC(){if(vp)return gt;vp=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.SpeechTranslationConfigImpl=gt.SpeechTranslationConfig=void 0;const e=k(),t=x(),r=T();let o=class extends r.SpeechConfig{constructor(){super()}static fromSubscription(s,n){t.Contracts.throwIfNullOrWhitespace(s,"subscriptionKey"),t.Contracts.throwIfNullOrWhitespace(n,"region");const c=new i;return c.properties.setProperty(r.PropertyId.SpeechServiceConnection_Key,s),c.properties.setProperty(r.PropertyId.SpeechServiceConnection_Region,n),c}static fromAuthorizationToken(s,n){t.Contracts.throwIfNullOrWhitespace(s,"authorizationToken"),t.Contracts.throwIfNullOrWhitespace(n,"region");const c=new i;return c.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,s),c.properties.setProperty(r.PropertyId.SpeechServiceConnection_Region,n),c}static fromHost(s,n){t.Contracts.throwIfNull(s,"hostName");const c=new i;return c.setProperty(r.PropertyId.SpeechServiceConnection_Host,s.protocol+"//"+s.hostname+(s.port===""?"":":"+s.port)),n!==void 0&&c.setProperty(r.PropertyId.SpeechServiceConnection_Key,n),c}static fromEndpoint(s,n){t.Contracts.throwIfNull(s,"endpoint");const c=typeof n=="string"&&n.trim().length>0,u=typeof n=="object"&&n!==null&&typeof n.getToken=="function";if(n!==void 0&&!c&&!u)throw new Error("Invalid 'auth' parameter: must be a non-empty key string or a valid TokenCredential object.");const l=typeof n=="object"?new i(n):new i;return l.setProperty(r.PropertyId.SpeechServiceConnection_Endpoint,s.href),typeof n=="string"&&n.trim().length>0&&l.setProperty(r.PropertyId.SpeechServiceConnection_Key,n),l}};gt.SpeechTranslationConfig=o;class i extends o{constructor(s){super(),this.privSpeechProperties=new r.PropertyCollection,this.outputFormat=r.OutputFormat.Simple,this.privTokenCredential=s}set authorizationToken(s){t.Contracts.throwIfNullOrWhitespace(s,"value"),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,s)}set speechRecognitionLanguage(s){t.Contracts.throwIfNullOrWhitespace(s,"value"),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,s)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return r.OutputFormat[this.privSpeechProperties.getProperty(e.OutputFormatPropertyName,void 0)]}set outputFormat(s){this.privSpeechProperties.setProperty(e.OutputFormatPropertyName,r.OutputFormat[s])}get endpointId(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(s){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_EndpointId,s)}addTargetLanguage(s){t.Contracts.throwIfNullOrWhitespace(s,"value");const n=this.targetLanguages;n.includes(s)||(n.push(s),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,n.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(s){t.Contracts.throwIfNullOrWhitespace(s,"value"),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,s)}get region(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_Region)}get tokenCredential(){return this.privTokenCredential}setProxy(s,n,c,u){this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyHostName],s),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPort],n),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyUserName],c),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPassword],u)}getProperty(s,n){return this.privSpeechProperties.getProperty(s,n)}setProperty(s,n){this.privSpeechProperties.setProperty(s,n)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(s,n){const c=JSON.parse(this.privSpeechProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));c[s]=n,this.privSpeechProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(c))}setProfanity(s){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceResponse_ProfanityOption,r.ProfanityOption[s])}enableAudioLogging(){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(e.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(s){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage,s)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(s){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthVoice,s)}get speechSynthesisOutputFormat(){return r.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(s){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,r.SpeechSynthesisOutputFormat[s])}}return gt.SpeechTranslationConfigImpl=i,gt}var rn={},gp;function mp(){if(gp)return rn;gp=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.PropertyCollection=void 0;const e=T();let t=class jv{constructor(){this.privKeys=[],this.privValues=[]}getProperty(o,i){let a;typeof o=="string"?a=o:a=e.PropertyId[o];for(let s=0;s<this.privKeys.length;s++)if(this.privKeys[s]===a)return this.privValues[s];if(i!==void 0)return String(i)}setProperty(o,i){let a;typeof o=="string"?a=o:a=e.PropertyId[o];for(let s=0;s<this.privKeys.length;s++)if(this.privKeys[s]===a){this.privValues[s]=i;return}this.privKeys.push(a),this.privValues.push(i)}clone(){const o=new jv;for(let i=0;i<this.privKeys.length;i++)o.privKeys.push(this.privKeys[i]),o.privValues.push(this.privValues[i]);return o}mergeTo(o){this.privKeys.forEach(i=>{if(o.getProperty(i,void 0)===void 0){const a=this.getProperty(i);o.setProperty(i,a)}})}get keys(){return this.privKeys}};return rn.PropertyCollection=t,rn}var Wo={},yp;function Ho(){return yp||(yp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PropertyId=void 0,function(t){t[t.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",t[t.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",t[t.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",t[t.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",t[t.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",t[t.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",t[t.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",t[t.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",t[t.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",t[t.SpeechServiceConnection_TranslationCategoryId=9]="SpeechServiceConnection_TranslationCategoryId",t[t.SpeechServiceConnection_IntentRegion=10]="SpeechServiceConnection_IntentRegion",t[t.SpeechServiceConnection_ProxyHostName=11]="SpeechServiceConnection_ProxyHostName",t[t.SpeechServiceConnection_ProxyPort=12]="SpeechServiceConnection_ProxyPort",t[t.SpeechServiceConnection_ProxyUserName=13]="SpeechServiceConnection_ProxyUserName",t[t.SpeechServiceConnection_ProxyPassword=14]="SpeechServiceConnection_ProxyPassword",t[t.SpeechServiceConnection_RecoMode=15]="SpeechServiceConnection_RecoMode",t[t.SpeechServiceConnection_RecoLanguage=16]="SpeechServiceConnection_RecoLanguage",t[t.Speech_SessionId=17]="Speech_SessionId",t[t.SpeechServiceConnection_SynthLanguage=18]="SpeechServiceConnection_SynthLanguage",t[t.SpeechServiceConnection_SynthVoice=19]="SpeechServiceConnection_SynthVoice",t[t.SpeechServiceConnection_SynthOutputFormat=20]="SpeechServiceConnection_SynthOutputFormat",t[t.SpeechServiceConnection_AutoDetectSourceLanguages=21]="SpeechServiceConnection_AutoDetectSourceLanguages",t[t.SpeechServiceResponse_RequestDetailedResultTrueFalse=22]="SpeechServiceResponse_RequestDetailedResultTrueFalse",t[t.SpeechServiceResponse_RequestProfanityFilterTrueFalse=23]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",t[t.SpeechServiceResponse_JsonResult=24]="SpeechServiceResponse_JsonResult",t[t.SpeechServiceResponse_JsonErrorDetails=25]="SpeechServiceResponse_JsonErrorDetails",t[t.CancellationDetails_Reason=26]="CancellationDetails_Reason",t[t.CancellationDetails_ReasonText=27]="CancellationDetails_ReasonText",t[t.CancellationDetails_ReasonDetailedText=28]="CancellationDetails_ReasonDetailedText",t[t.LanguageUnderstandingServiceResponse_JsonResult=29]="LanguageUnderstandingServiceResponse_JsonResult",t[t.SpeechServiceConnection_Url=30]="SpeechServiceConnection_Url",t[t.SpeechServiceConnection_InitialSilenceTimeoutMs=31]="SpeechServiceConnection_InitialSilenceTimeoutMs",t[t.SpeechServiceConnection_EndSilenceTimeoutMs=32]="SpeechServiceConnection_EndSilenceTimeoutMs",t[t.Speech_SegmentationSilenceTimeoutMs=33]="Speech_SegmentationSilenceTimeoutMs",t[t.Speech_SegmentationMaximumTimeMs=34]="Speech_SegmentationMaximumTimeMs",t[t.Speech_SegmentationStrategy=35]="Speech_SegmentationStrategy",t[t.SpeechServiceConnection_EnableAudioLogging=36]="SpeechServiceConnection_EnableAudioLogging",t[t.SpeechServiceConnection_LanguageIdMode=37]="SpeechServiceConnection_LanguageIdMode",t[t.SpeechServiceConnection_RecognitionEndpointVersion=38]="SpeechServiceConnection_RecognitionEndpointVersion",t[t.SpeechServiceConnection_SpeakerIdMode=39]="SpeechServiceConnection_SpeakerIdMode",t[t.SpeechServiceResponse_ProfanityOption=40]="SpeechServiceResponse_ProfanityOption",t[t.SpeechServiceResponse_PostProcessingOption=41]="SpeechServiceResponse_PostProcessingOption",t[t.SpeechServiceResponse_RequestWordLevelTimestamps=42]="SpeechServiceResponse_RequestWordLevelTimestamps",t[t.SpeechServiceResponse_StablePartialResultThreshold=43]="SpeechServiceResponse_StablePartialResultThreshold",t[t.SpeechServiceResponse_OutputFormatOption=44]="SpeechServiceResponse_OutputFormatOption",t[t.SpeechServiceResponse_TranslationRequestStablePartialResult=45]="SpeechServiceResponse_TranslationRequestStablePartialResult",t[t.SpeechServiceResponse_RequestWordBoundary=46]="SpeechServiceResponse_RequestWordBoundary",t[t.SpeechServiceResponse_RequestPunctuationBoundary=47]="SpeechServiceResponse_RequestPunctuationBoundary",t[t.SpeechServiceResponse_RequestSentenceBoundary=48]="SpeechServiceResponse_RequestSentenceBoundary",t[t.SpeechServiceResponse_DiarizeIntermediateResults=49]="SpeechServiceResponse_DiarizeIntermediateResults",t[t.Conversation_ApplicationId=50]="Conversation_ApplicationId",t[t.Conversation_DialogType=51]="Conversation_DialogType",t[t.Conversation_Initial_Silence_Timeout=52]="Conversation_Initial_Silence_Timeout",t[t.Conversation_From_Id=53]="Conversation_From_Id",t[t.Conversation_Conversation_Id=54]="Conversation_Conversation_Id",t[t.Conversation_Custom_Voice_Deployment_Ids=55]="Conversation_Custom_Voice_Deployment_Ids",t[t.Conversation_Speech_Activity_Template=56]="Conversation_Speech_Activity_Template",t[t.Conversation_Request_Bot_Status_Messages=57]="Conversation_Request_Bot_Status_Messages",t[t.Conversation_Agent_Connection_Id=58]="Conversation_Agent_Connection_Id",t[t.SpeechServiceConnection_Host=59]="SpeechServiceConnection_Host",t[t.ConversationTranslator_Host=60]="ConversationTranslator_Host",t[t.ConversationTranslator_Name=61]="ConversationTranslator_Name",t[t.ConversationTranslator_CorrelationId=62]="ConversationTranslator_CorrelationId",t[t.ConversationTranslator_Token=63]="ConversationTranslator_Token",t[t.PronunciationAssessment_ReferenceText=64]="PronunciationAssessment_ReferenceText",t[t.PronunciationAssessment_GradingSystem=65]="PronunciationAssessment_GradingSystem",t[t.PronunciationAssessment_Granularity=66]="PronunciationAssessment_Granularity",t[t.PronunciationAssessment_EnableMiscue=67]="PronunciationAssessment_EnableMiscue",t[t.PronunciationAssessment_Json=68]="PronunciationAssessment_Json",t[t.PronunciationAssessment_Params=69]="PronunciationAssessment_Params",t[t.SpeakerRecognition_Api_Version=70]="SpeakerRecognition_Api_Version",t[t.WebWorkerLoadType=71]="WebWorkerLoadType",t[t.TalkingAvatarService_WebRTC_SDP=72]="TalkingAvatarService_WebRTC_SDP"}(e.PropertyId||(e.PropertyId={}))}(Wo)),Wo}var nn={},Sp;function jC(){if(Sp)return nn;Sp=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.Recognizer=void 0;const e=k(),t=O(),r=x(),o=T();let i=class qv{constructor(s,n,c,u){this.audioConfig=s!==void 0?s:o.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=n.clone(),this.privConnectionFactory=c,this.tokenCredential=u,this.implCommonRecognizerSetup()}close(s,n){r.Contracts.throwIfDisposed(this.privDisposed),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),s,n)}get internalData(){return this.privReco}async dispose(s){this.privDisposed||(this.privDisposed=!0,s&&this.privReco&&(await this.privReco.audioSource.turnOff(),await this.privReco.dispose()))}static get telemetryEnabled(){return e.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(s){e.ServiceRecognizerBase.telemetryDataEnabled=s}implCommonRecognizerSetup(){let s=typeof window<"u"?"Browser":"Node",n="unknown",c="unknown";typeof navigator<"u"&&(s=s+"/"+navigator.platform,n=navigator.userAgent,c=navigator.appVersion);const u=this.createRecognizerConfig(new e.SpeechServiceConfig(new e.Context(new e.OS(s,n,c))));this.privReco=this.createServiceRecognizer(qv.getAuth(this.privProperties,this.tokenCredential),this.privConnectionFactory,this.audioConfig,u)}async recognizeOnceAsyncImpl(s){r.Contracts.throwIfDisposed(this.privDisposed);const n=new t.Deferred;await this.implRecognizerStop(),await this.privReco.recognize(s,n.resolve,n.reject);const c=await n.promise;return await this.implRecognizerStop(),c}async startContinuousRecognitionAsyncImpl(s){r.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop(),await this.privReco.recognize(s,void 0,void 0)}async stopContinuousRecognitionAsyncImpl(){r.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop()}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}static getAuth(s,n){const c=s.getProperty(o.PropertyId.SpeechServiceConnection_Key,void 0);return c&&c!==""?new e.CognitiveSubscriptionKeyAuthentication(c):n?new e.CognitiveTokenAuthentication(async()=>{try{return(await n.getToken("https://cognitiveservices.azure.com/.default"))?.token??""}catch(u){throw u}},async()=>{try{return(await n.getToken("https://cognitiveservices.azure.com/.default"))?.token??""}catch(u){throw u}}):new e.CognitiveTokenAuthentication(()=>{const u=s.getProperty(o.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(u)},()=>{const u=s.getProperty(o.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(u)})}};return nn.Recognizer=i,nn}var sn={},Ko={},Cp;function Ce(){return Cp||(Cp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionMode=void 0,function(t){t.Interactive="Interactive",t.Dictation="Dictation",t.Conversation="Conversation",t.None="None"}(e.RecognitionMode||(e.RecognitionMode={}))}(Ko)),Ko}var Pp;function qC(){if(Pp)return sn;Pp=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.SpeechRecognizer=void 0;const e=k(),t=Ce(),r=O(),o=x(),i=T();let a=class Fv extends i.Recognizer{constructor(n,c){const u=n;o.Contracts.throwIfNull(u,"speechConfig"),o.Contracts.throwIfNullOrWhitespace(u.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),super(c,u.properties,new e.SpeechConnectionFactory,n.tokenCredential),this.privDisposedRecognizer=!1}static FromConfig(n,c,u){const l=n;return c.properties.mergeTo(l.properties),new Fv(n,u)}get endpointId(){return o.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){o.Contracts.throwIfNullOrWhitespace(n,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,n)}get speechRecognitionLanguage(){return o.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return o.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(e.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple])===i.OutputFormat[i.OutputFormat.Simple]?i.OutputFormat.Simple:i.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(n,c){(0,r.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(t.RecognitionMode.Interactive),n,c)}startContinuousRecognitionAsync(n,c){(0,r.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(this.properties.getProperty(e.ForceDictationPropertyName,void 0)===void 0?t.RecognitionMode.Conversation:t.RecognitionMode.Dictation),n,c)}stopContinuousRecognitionAsync(n,c){(0,r.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),n,c)}startKeywordRecognitionAsync(n,c,u){o.Contracts.throwIfNull(n,"model"),u&&u("Not yet implemented.")}stopKeywordRecognitionAsync(n){n&&n()}close(n,c){o.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),n,c)}async dispose(n){this.privDisposedRecognizer||(n&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(n))}createRecognizerConfig(n){return new e.RecognizerConfig(n,this.privProperties)}createServiceRecognizer(n,c,u,l){const p=u;return new e.SpeechServiceRecognizer(n,c,p,l,this)}};return sn.SpeechRecognizer=a,sn}var on={},Rp;function FC(){if(Rp)return on;Rp=1,Object.defineProperty(on,"__esModule",{value:!0}),on.IntentRecognizer=void 0;const e=k(),t=Ce(),r=O(),o=x(),i=T();let a=class extends i.Recognizer{constructor(n,c){o.Contracts.throwIfNullOrUndefined(n,"speechConfig");const u=n;o.Contracts.throwIfNullOrUndefined(u,"speechConfig"),super(c,u.properties,new e.IntentConnectionFactory),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=u.properties,o.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return o.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,n)}get properties(){return this.privProperties}recognizeOnceAsync(n,c){if(o.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){const u=this.buildSpeechContext();this.privReco.speechContext.getContext().intent=u.Intent,this.privReco.dynamicGrammar.addReferenceGrammar(u.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}(0,r.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(t.RecognitionMode.Interactive),n,c)}startContinuousRecognitionAsync(n,c){if(Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){const u=this.buildSpeechContext();this.privReco.speechContext.getContext().intent=u.Intent,this.privReco.dynamicGrammar.addReferenceGrammar(u.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}(0,r.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(t.RecognitionMode.Conversation),n,c)}stopContinuousRecognitionAsync(n,c){(0,r.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),n,c)}startKeywordRecognitionAsync(n,c,u){o.Contracts.throwIfNull(n,"model"),u&&u("Not yet implemented.")}stopKeywordRecognitionAsync(n,c){if(n)try{n()}catch(u){c&&c(u)}}addIntent(n,c){o.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),o.Contracts.throwIfNullOrWhitespace(c,"intentId"),o.Contracts.throwIfNullOrWhitespace(n,"simplePhrase"),this.privAddedIntents.push([c,n])}addIntentWithLanguageModel(n,c,u){o.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),o.Contracts.throwIfNullOrWhitespace(n,"intentId"),o.Contracts.throwIfNull(c,"model");const l=c;o.Contracts.throwIfNullOrWhitespace(l.appId,"model.appId"),this.privAddedLmIntents[n]=new e.AddedLmIntent(l,u)}addAllIntents(n,c){o.Contracts.throwIfNull(n,"model");const u=n;o.Contracts.throwIfNullOrWhitespace(u.appId,"model.appId"),this.privUmbrellaIntent=new e.AddedLmIntent(u,c)}close(n,c){o.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),n,c)}createRecognizerConfig(n){return new e.RecognizerConfig(n,this.privProperties)}createServiceRecognizer(n,c,u,l){const p=u;return new e.IntentServiceRecognizer(n,c,p,l,this)}async dispose(n){this.privDisposedIntentRecognizer||n&&(this.privDisposedIntentRecognizer=!0,await super.dispose(n))}buildSpeechContext(){let n,c,u;const l=[];this.privUmbrellaIntent!==void 0&&(n=this.privUmbrellaIntent.modelImpl.appId,c=this.privUmbrellaIntent.modelImpl.region,u=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(const p of Object.keys(this.privAddedLmIntents)){const d=this.privAddedLmIntents[p];if(n===void 0)n=d.modelImpl.appId;else if(n!==d.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(c===void 0)c=d.modelImpl.region;else if(c!==d.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(u===void 0)u=d.modelImpl.subscriptionKey;else if(u!==d.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");const h="luis/"+n+"-PRODUCTION#"+p;l.push(h)}return{Intent:{id:n,key:u===void 0?this.privProperties.getProperty(i.PropertyId[i.PropertyId.SpeechServiceConnection_Key]):u,provider:"LUIS"},ReferenceGrammars:this.privUmbrellaIntent===void 0?l:["luis/"+n+"-PRODUCTION"]}}};return on.IntentRecognizer=a,on}var Jo={},bp;function BC(){return bp||(bp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceProfileType=void 0,function(t){t[t.TextIndependentIdentification=0]="TextIndependentIdentification",t[t.TextDependentVerification=1]="TextDependentVerification",t[t.TextIndependentVerification=2]="TextIndependentVerification"}(e.VoiceProfileType||(e.VoiceProfileType={}))}(Jo)),Jo}var an={},cn={},mt={},wp;function Ep(){if(wp)return mt;wp=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.ConnectionMessageImpl=mt.ConnectionMessage=void 0;const e=le(),t=O(),r=mp(),o=Ho();let i=class{};mt.ConnectionMessage=i;class a{constructor(n){this.privConnectionMessage=n,this.privProperties=new r.PropertyCollection,this.privConnectionMessage.headers[e.HeaderNames.ConnectionId]&&this.privProperties.setProperty(o.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[e.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(c=>{this.privProperties.setProperty(c,this.privConnectionMessage.headers[c])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(n=>n.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===t.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===t.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}return mt.ConnectionMessageImpl=a,mt}var Ip;function Ap(){if(Ip)return cn;Ip=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.Connection=void 0;const e=k(),t=O(),r=Ep(),o=x(),i=T();let a=class pc{static fromRecognizer(n){const c=n.internalData,u=new pc;return u.privInternalData=c,u.setupEvents(),u}static fromSynthesizer(n){const c=n.internalData,u=new pc;return u.privInternalData=c,u.setupEvents(),u}openConnection(n,c){(0,t.marshalPromiseToCallbacks)(this.privInternalData.connect(),n,c)}closeConnection(n,c){if(this.privInternalData instanceof e.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");(0,t.marshalPromiseToCallbacks)(this.privInternalData.disconnect(),n,c)}setMessageProperty(n,c,u){if(o.Contracts.throwIfNullOrWhitespace(c,"propertyName"),this.privInternalData instanceof e.ServiceRecognizerBase){if(n.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");{const l=this.privInternalData.speechContext.getContext();l[c]=u}}else if(this.privInternalData instanceof e.SynthesisAdapterBase){if(n.toLowerCase()!=="synthesis.context")throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(c,u)}}sendMessageAsync(n,c,u,l){(0,t.marshalPromiseToCallbacks)(this.privInternalData.sendNetworkMessage(n,c),u,l)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(n=>{n.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new i.ConnectionEventArgs(n.connectionId)):n.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new i.ConnectionEventArgs(n.connectionId)):n.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new i.ConnectionMessageEventArgs(new r.ConnectionMessageImpl(n.message))):n.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new i.ConnectionMessageEventArgs(new r.ConnectionMessageImpl(n.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(n=>{this.receivedServiceMessage&&this.receivedServiceMessage(new i.ServiceEventArgs(n.jsonString,n.name))})}};return cn.Connection=a,cn}var Tp;function UC(){if(Tp)return an;Tp=1,Object.defineProperty(an,"__esModule",{value:!0}),an.TranslationRecognizer=void 0;const e=k(),t=Ce(),r=O(),o=Ap(),i=x(),a=T();let s=class Bv extends a.Recognizer{constructor(c,u,l){const p=c;i.Contracts.throwIfNull(p,"speechConfig"),super(u,p.properties,l||new e.TranslationConnectionFactory,c.tokenCredential),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice),a.PropertyId[a.PropertyId.SpeechServiceConnection_TranslationVoice]),i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages),a.PropertyId[a.PropertyId.SpeechServiceConnection_TranslationToLanguages]),i.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage),a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(c,u,l){const p=c;return u.properties.mergeTo(p.properties),u.properties.getProperty(a.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)===e.AutoDetectSourceLanguagesOpenRangeOptionName&&p.properties.setProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),new Bv(c,l)}get speechRecognitionLanguage(){return i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,c)}recognizeOnceAsync(c,u){i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,r.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(t.RecognitionMode.Interactive),c,u)}startContinuousRecognitionAsync(c,u){(0,r.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(t.RecognitionMode.Conversation),c,u)}stopContinuousRecognitionAsync(c,u){(0,r.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),c,u)}removeTargetLanguage(c){if(i.Contracts.throwIfNullOrUndefined(c,"language to be removed"),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){const u=this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),l=u.indexOf(c);l>-1&&(u.splice(l,1),this.properties.setProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,u.join(",")),this.updateLanguages(u))}}addTargetLanguage(c){i.Contracts.throwIfNullOrUndefined(c,"language to be added");let u=[];this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(u=this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),u.includes(c)||(u.push(c),this.properties.setProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,u.join(",")))):(this.properties.setProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,c),u=[c]),this.updateLanguages(u)}close(c,u){i.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),c,u)}onConnection(){}async dispose(c){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,c&&(await this.implRecognizerStop(),await super.dispose(c)))}createRecognizerConfig(c){return new e.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,u,l,p){const d=l;return new e.TranslationServiceRecognizer(c,u,d,p,this)}updateLanguages(c){const u=o.Connection.fromRecognizer(this);u&&(u.setMessageProperty("speech.context","translationcontext",{to:c}),u.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:c})))}};return an.TranslationRecognizer=s,an}var un={},_p;function $C(){if(_p)return un;_p=1,Object.defineProperty(un,"__esModule",{value:!0}),un.Translations=void 0;const e=T();let t=class{constructor(){this.privMap=new e.PropertyCollection}get languages(){return this.privMap.keys}get(o,i){return this.privMap.getProperty(o,i)}set(o,i){this.privMap.setProperty(o,i)}};return un.Translations=t,un}var Go={},kp;function VC(){return kp||(kp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NoMatchReason=void 0,function(t){t[t.NotRecognized=0]="NotRecognized",t[t.InitialSilenceTimeout=1]="InitialSilenceTimeout",t[t.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(e.NoMatchReason||(e.NoMatchReason={}))}(Go)),Go}var ln={},Op;function WC(){if(Op)return ln;Op=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.NoMatchDetails=void 0;const e=k(),t=T();let r=class Uv{constructor(i){this.privReason=i}static fromResult(i){const a=e.SimpleSpeechPhrase.fromJSON(i.json,0);let s=t.NoMatchReason.NotRecognized;switch(a.RecognitionStatus){case e.RecognitionStatus.BabbleTimeout:s=t.NoMatchReason.InitialBabbleTimeout;break;case e.RecognitionStatus.InitialSilenceTimeout:s=t.NoMatchReason.InitialSilenceTimeout;break;default:s=t.NoMatchReason.NotRecognized;break}return new Uv(s)}get reason(){return this.privReason}};return ln.NoMatchDetails=r,ln}var pn={},Mp;function HC(){if(Mp)return pn;Mp=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.TranslationRecognitionCanceledEventArgs=void 0;let e=class{constructor(r,o,i,a,s){this.privCancelReason=o,this.privErrorDetails=i,this.privResult=s,this.privSessionId=r,this.privErrorCode=a}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return pn.TranslationRecognitionCanceledEventArgs=e,pn}var dn={},Dp;function KC(){if(Dp)return dn;Dp=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.IntentRecognitionCanceledEventArgs=void 0;const e=T();let t=class extends e.IntentRecognitionEventArgs{constructor(o,i,a,s,n,c){super(s,n,c),this.privReason=o,this.privErrorDetails=i,this.privErrorCode=a}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return dn.IntentRecognitionCanceledEventArgs=t,dn}var hn={},Np;function xp(){if(Np)return hn;Np=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.CancellationDetailsBase=void 0;let e=class{constructor(r,o,i){this.privReason=r,this.privErrorDetails=o,this.privErrorCode=i}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}};return hn.CancellationDetailsBase=e,hn}var fn={},zp;function JC(){if(zp)return fn;zp=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.CancellationDetails=void 0;const e=k(),t=xp(),r=T();let o=class $v extends t.CancellationDetailsBase{constructor(a,s,n){super(a,s,n)}static fromResult(a){let s=r.CancellationReason.Error,n=r.CancellationErrorCode.NoError;if(a instanceof r.RecognitionResult&&a.json){const c=e.SimpleSpeechPhrase.fromJSON(a.json,0);s=e.EnumTranslation.implTranslateCancelResult(c.RecognitionStatus)}return a.properties&&(n=r.CancellationErrorCode[a.properties.getProperty(e.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.NoError])]),new $v(s,a.errorDetails||e.EnumTranslation.implTranslateErrorDetails(n),n)}};return fn.CancellationDetails=o,fn}var Qo={},Lp;function GC(){return Lp||(Lp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationErrorCode=void 0,function(t){t[t.NoError=0]="NoError",t[t.AuthenticationFailure=1]="AuthenticationFailure",t[t.BadRequestParameters=2]="BadRequestParameters",t[t.TooManyRequests=3]="TooManyRequests",t[t.ConnectionFailure=4]="ConnectionFailure",t[t.ServiceTimeout=5]="ServiceTimeout",t[t.ServiceError=6]="ServiceError",t[t.RuntimeError=7]="RuntimeError",t[t.Forbidden=8]="Forbidden"}(e.CancellationErrorCode||(e.CancellationErrorCode={}))}(Qo)),Qo}var vn={},jp;function QC(){if(jp)return vn;jp=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.ConnectionEventArgs=void 0;const e=T();let t=class extends e.SessionEventArgs{};return vn.ConnectionEventArgs=t,vn}var gn={},qp;function YC(){if(qp)return gn;qp=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.ServiceEventArgs=void 0;const e=T();let t=class extends e.SessionEventArgs{constructor(o,i,a){super(a),this.privJsonResult=o,this.privEventName=i}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};return gn.ServiceEventArgs=t,gn}var mn={},Fp;function ZC(){if(Fp)return mn;Fp=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.PhraseListGrammar=void 0;let e=class Vv{constructor(r){this.privGrammerBuilder=r.dynamicGrammar}static fromRecognizer(r){const o=r.internalData;return new Vv(o)}addPhrase(r){this.privGrammerBuilder.addPhrase(r)}addPhrases(r){this.privGrammerBuilder.addPhrase(r)}clear(){this.privGrammerBuilder.clearPhrases()}};return mn.PhraseListGrammar=e,mn}var yt={},Bp;function Yo(){if(Bp)return yt;Bp=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.DialogServiceConfigImpl=yt.DialogServiceConfig=void 0;const e=x(),t=T();let r=class{constructor(){}set applicationId(a){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};yt.DialogServiceConfig=r;class o extends r{constructor(){super(),this.privSpeechConfig=new t.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(a){e.Contracts.throwIfNullOrWhitespace(a,"value"),this.privSpeechConfig.speechRecognitionLanguage=a}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(a){this.privSpeechConfig.outputFormat=a}setProperty(a,s){this.privSpeechConfig.setProperty(a,s)}getProperty(a,s){return this.privSpeechConfig.getProperty(a)}setProxy(a,s,n,c){this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyHostName,a),this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyPort,`${s}`),n&&this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyUserName,n),c&&this.setProperty(t.PropertyId.SpeechServiceConnection_ProxyPassword,c)}setServiceProperty(a,s,n){this.privSpeechConfig.setServiceProperty(a,s)}close(){}}return yt.DialogServiceConfigImpl=o,yt}var yn={},Up;function XC(){if(Up)return yn;Up=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.BotFrameworkConfig=void 0;const e=x(),t=Yo(),r=T();let o=class extends t.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(a,s,n){e.Contracts.throwIfNullOrWhitespace(a,"subscription"),e.Contracts.throwIfNullOrWhitespace(s,"region");const c=new t.DialogServiceConfigImpl;return c.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),c.setProperty(r.PropertyId.SpeechServiceConnection_Key,a),c.setProperty(r.PropertyId.SpeechServiceConnection_Region,s),n&&c.setProperty(r.PropertyId.Conversation_ApplicationId,n),c}static fromAuthorizationToken(a,s,n){e.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(s,"region");const c=new t.DialogServiceConfigImpl;return c.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),c.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a),c.setProperty(r.PropertyId.SpeechServiceConnection_Region,s),n&&c.setProperty(r.PropertyId.Conversation_ApplicationId,n),c}static fromHost(a,s,n){e.Contracts.throwIfNullOrUndefined(a,"host");const c=a instanceof URL?a:new URL(`wss://${a}.convai.speech.azure.us`);e.Contracts.throwIfNullOrUndefined(c,"resolvedHost");const u=new t.DialogServiceConfigImpl;return u.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),u.setProperty(r.PropertyId.SpeechServiceConnection_Host,c.toString()),s!==void 0&&u.setProperty(r.PropertyId.SpeechServiceConnection_Key,s),u}static fromEndpoint(a,s){e.Contracts.throwIfNull(a,"endpoint");const n=new t.DialogServiceConfigImpl;return n.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.BotFramework),n.setProperty(r.PropertyId.SpeechServiceConnection_Endpoint,a.toString()),s!==void 0&&n.setProperty(r.PropertyId.SpeechServiceConnection_Key,s),n}};return yn.BotFrameworkConfig=o,yn}var Sn={},$p;function eP(){if($p)return Sn;$p=1,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.CustomCommandsConfig=void 0;const e=x(),t=Yo(),r=T();let o=class extends t.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(a,s,n){e.Contracts.throwIfNullOrWhitespace(a,"applicationId"),e.Contracts.throwIfNullOrWhitespace(s,"subscription"),e.Contracts.throwIfNullOrWhitespace(n,"region");const c=new t.DialogServiceConfigImpl;return c.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.CustomCommands),c.setProperty(r.PropertyId.Conversation_ApplicationId,a),c.setProperty(r.PropertyId.SpeechServiceConnection_Key,s),c.setProperty(r.PropertyId.SpeechServiceConnection_Region,n),c}static fromAuthorizationToken(a,s,n){e.Contracts.throwIfNullOrWhitespace(a,"applicationId"),e.Contracts.throwIfNullOrWhitespace(s,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(n,"region");const c=new t.DialogServiceConfigImpl;return c.setProperty(r.PropertyId.Conversation_DialogType,t.DialogServiceConfig.DialogTypes.CustomCommands),c.setProperty(r.PropertyId.Conversation_ApplicationId,a),c.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,s),c.setProperty(r.PropertyId.SpeechServiceConnection_Region,n),c}set applicationId(a){e.Contracts.throwIfNullOrWhitespace(a,"value"),this.setProperty(r.PropertyId.Conversation_ApplicationId,a)}get applicationId(){return this.getProperty(r.PropertyId.Conversation_ApplicationId)}};return Sn.CustomCommandsConfig=o,Sn}var Cn={},Pn={},Rn={},bn={},Vp;function Ge(){if(Vp)return bn;Vp=1,Object.defineProperty(bn,"__esModule",{value:!0}),bn.QueryParameterNames=void 0;let e=class{};return bn.QueryParameterNames=e,e.BotId="botid",e.CustomSpeechDeploymentId="cid",e.CustomVoiceDeploymentId="deploymentId",e.EnableAudioLogging="storeAudio",e.EnableLanguageId="lidEnabled",e.EnableWordLevelTimestamps="wordLevelTimestamps",e.EndSilenceTimeoutMs="endSilenceTimeoutMs",e.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",e.SegmentationMaximumTimeMs="segmentationMaximumTimeMs",e.SegmentationStrategy="segmentationStrategy",e.Format="format",e.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",e.Language="language",e.Profanity="profanity",e.RequestBotStatusMessages="enableBotMessageStatus",e.StableIntermediateThreshold="stableIntermediateThreshold",e.StableTranslation="stableTranslation",e.TestHooks="testhooks",e.Postprocessing="postprocessing",e.CtsMeetingId="meetingId",e.CtsDeviceId="deviceId",e.CtsIsParticipant="isParticipant",e.EnableAvatar="enableTalkingAvatar",bn}var Wp;function Ee(){if(Wp)return Rn;Wp=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.ConnectionFactoryBase=void 0;const e=k(),t=O(),r=T(),o=Ge();let i=class{static getHostSuffix(s){if(s){if(s.toLowerCase().startsWith("china"))return".azure.cn";if(s.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(s,n,c){new Map([[r.PropertyId.Speech_SegmentationSilenceTimeoutMs,o.QueryParameterNames.SegmentationSilenceTimeoutMs],[r.PropertyId.SpeechServiceConnection_EnableAudioLogging,o.QueryParameterNames.EnableAudioLogging],[r.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,o.QueryParameterNames.EndSilenceTimeoutMs],[r.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,o.QueryParameterNames.InitialSilenceTimeoutMs],[r.PropertyId.SpeechServiceResponse_PostProcessingOption,o.QueryParameterNames.Postprocessing],[r.PropertyId.SpeechServiceResponse_ProfanityOption,o.QueryParameterNames.Profanity],[r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,o.QueryParameterNames.EnableWordLevelTimestamps],[r.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,o.QueryParameterNames.StableIntermediateThreshold]]).forEach((p,d)=>{this.setUrlParameter(d,p,s,n,c)});const l=JSON.parse(s.parameters.getProperty(e.ServicePropertiesPropertyName,"{}"));Object.keys(l).forEach(p=>{n[p]=l[p]})}setUrlParameter(s,n,c,u,l){const p=c.parameters.getProperty(s,void 0);p&&(!l||l.search(n)===-1)&&(u[n]=p.toLocaleLowerCase())}static async getRedirectUrlFromEndpoint(s){let n;if(typeof window<"u"&&typeof window.fetch<"u"){const c=new URL(s);c.protocol="https:",c.port="443",c.searchParams.append("GenerateRedirectResponse","true");const l=c.toString();t.Events.instance.onEvent(new t.ConnectionRedirectEvent("",l,void 0,"ConnectionFactoryBase: redirectUrl request"));const p=await fetch(l);if(p.status!==200)return s;n=await p.text()}else n=s;t.Events.instance.onEvent(new t.ConnectionRedirectEvent("",n,s,"ConnectionFactoryBase: redirectUrlString"));try{return new URL(n.trim()).toString()}catch{return s}}};return Rn.ConnectionFactoryBase=i,Rn}var Hp;function tP(){if(Hp)return Pn;Hp=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.DialogConnectionFactory=void 0;const e=ie(),t=k(),r=T(),o=Ee(),i=k(),a=le(),s=Ge();class n extends o.ConnectionFactoryBase{create(u,l,p){const d=u.parameters.getProperty(r.PropertyId.Conversation_ApplicationId,""),h=u.parameters.getProperty(r.PropertyId.Conversation_DialogType),f=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region),g=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),m=u.parameters.getProperty(r.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),v={};v[a.HeaderNames.ConnectionId]=p,v[s.QueryParameterNames.Format]=u.parameters.getProperty(t.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple]).toLowerCase(),v[s.QueryParameterNames.Language]=g,v[s.QueryParameterNames.RequestBotStatusMessages]=m,d&&(v[s.QueryParameterNames.BotId]=d,h===r.DialogServiceConfig.DialogTypes.CustomCommands&&(v[a.HeaderNames.CustomCommandsAppId]=d));const y=h===r.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",S=h===r.DialogServiceConfig.DialogTypes.CustomCommands?"v1":h===r.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",P={};l.token!=null&&l.token!==""&&(P[l.headerName]=l.token);let b=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,"");if(!b){const A=o.ConnectionFactoryBase.getHostSuffix(f),E=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,`wss://${f}.${n.BaseUrl}${A}`);b=`${E.endsWith("/")?E:E+"/"}${y}${n.ApiKey}/${S}`}this.setCommonUrlParams(u,v,b);const w=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(b,v,P,new i.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(u),w,p))}}return Pn.DialogConnectionFactory=n,n.ApiKey="api",n.BaseUrl="convai.speech",Pn}var Kp;function rP(){if(Kp)return Cn;Kp=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.DialogServiceConnector=void 0;const e=tP(),t=k(),r=Ce(),o=O(),i=x(),a=T(),s=Ho();let n=class extends a.Recognizer{constructor(u,l){const p=u;i.Contracts.throwIfNull(u,"dialogConfig"),super(l,p.properties,new e.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=p.properties.clone();const d=this.buildAgentConfig();this.privReco.agentConfig.set(d)}connect(u,l){(0,o.marshalPromiseToCallbacks)(this.privReco.connect(),u,l)}disconnect(u,l){(0,o.marshalPromiseToCallbacks)(this.privReco.disconnect(),u,l)}get authorizationToken(){return this.properties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(u){i.Contracts.throwIfNullOrWhitespace(u,"token"),this.properties.setProperty(s.PropertyId.SpeechServiceAuthorization_Token,u)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(s.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(u){this.properties.setProperty(s.PropertyId.Conversation_Speech_Activity_Template,u)}listenOnceAsync(u,l){if(this.isTurnComplete){i.Contracts.throwIfDisposed(this.privIsDisposed);const d=(async()=>{await this.privReco.connect(),await this.implRecognizerStop(),this.isTurnComplete=!1;const h=new o.Deferred;await this.privReco.recognize(r.RecognitionMode.Conversation,h.resolve,h.reject);const f=await h.promise;return await this.implRecognizerStop(),f})();d.catch(()=>{this.dispose(!0).catch(()=>{})}),(0,o.marshalPromiseToCallbacks)(d.finally(()=>{this.isTurnComplete=!0}),u,l)}}sendActivityAsync(u,l,p){(0,o.marshalPromiseToCallbacks)(this.privReco.sendMessage(u),l,p)}close(u,l){i.Contracts.throwIfDisposed(this.privIsDisposed),(0,o.marshalPromiseToCallbacks)(this.dispose(!0),u,l)}async dispose(u){this.privIsDisposed||u&&(this.privIsDisposed=!0,await this.implRecognizerStop(),await super.dispose(u))}createRecognizerConfig(u){return new t.RecognizerConfig(u,this.privProperties)}createServiceRecognizer(u,l,p,d){const h=p;return new t.DialogServiceAdapter(u,l,h,d,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(s.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(s.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(s.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(s.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};return Cn.DialogServiceConnector=n,Cn}var wn={},Jp;function nP(){if(Jp)return wn;Jp=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.ActivityReceivedEventArgs=void 0;let e=class{constructor(r,o){this.privActivity=r,this.privAudioStream=o}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};return wn.ActivityReceivedEventArgs=e,wn}var En={},In={},Gp;function iP(){if(Gp)return In;Gp=1,Object.defineProperty(In,"__esModule",{value:!0}),In.TurnStatusResponsePayload=void 0;class e{constructor(r){this.privMessageStatusResponse=JSON.parse(r)}static fromJSON(r){return new e(r)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}return In.TurnStatusResponsePayload=e,In}var Qp;function sP(){if(Qp)return En;Qp=1,Object.defineProperty(En,"__esModule",{value:!0}),En.TurnStatusReceivedEventArgs=void 0;const e=iP();let t=class{constructor(o){this.privTurnStatus=e.TurnStatusResponsePayload.fromJSON(o)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};return En.TurnStatusReceivedEventArgs=t,En}var Zo={},Yp;function oP(){return Yp||(Yp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ServicePropertyChannel=void 0,function(t){t[t.UriQueryParameter=0]="UriQueryParameter"}(e.ServicePropertyChannel||(e.ServicePropertyChannel={}))}(Zo)),Zo}var Xo={},Zp;function aP(){return Zp||(Zp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProfanityOption=void 0,function(t){t[t.Masked=0]="Masked",t[t.Removed=1]="Removed",t[t.Raw=2]="Raw"}(e.ProfanityOption||(e.ProfanityOption={}))}(Xo)),Xo}var An={},Xp;function cP(){if(Xp)return An;Xp=1,Object.defineProperty(An,"__esModule",{value:!0}),An.BaseAudioPlayer=void 0;const e=Me(),t=T(),r=ht();let o=class{constructor(a){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,a===void 0&&(a=t.AudioStreamFormat.getDefaultInputFormat()),this.init(a)}playAudioSample(a,s,n){try{this.ensureInitializedContext();const c=this.formatAudioData(a),u=new Float32Array(this.samples.length+c.length);u.set(this.samples,0),u.set(c,this.samples.length),this.samples=u,s&&s()}catch(c){n&&n(c)}}stopAudio(a,s){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{a&&a()},n=>{s&&s(n)}),this.audioContext=null)}init(a){this.audioFormat=a,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();const a=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},a)}}createAudioContext(){this.audioContext=r.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(a){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(a),128);case 16:return this.formatArrayBuffer(new Int16Array(a),32768);case 32:return this.formatArrayBuffer(new Int32Array(a),2147483648);default:throw new e.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(a,s){const n=new Float32Array(a.length);for(let c=0;c<a.length;c++)n[c]=a[c]/s;return n}updateAudioBuffer(){if(this.samples.length===0)return;const a=this.audioFormat.channels,s=this.audioContext.createBufferSource(),n=this.samples.length/a,c=this.audioContext.createBuffer(a,n,this.audioFormat.samplesPerSec);for(let u=0;u<a;u++){let l=u;const p=c.getChannelData(u);for(let d=0;d<this.samples.length;d++,l+=a)p[d]=this.samples[l]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),s.buffer=c,s.connect(this.gainNode),s.start(this.startTime),this.startTime+=c.duration,this.samples=new Float32Array}async playAudio(a){this.audioContext===null&&this.createAudioContext();const s=this.audioContext.createBufferSource(),n=this.audioContext.destination;await this.audioContext.decodeAudioData(a,c=>{s.buffer=c,s.connect(n),s.start(0)})}};return An.BaseAudioPlayer=o,An}var Tn={},ed;function uP(){if(ed)return Tn;ed=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.ConnectionMessageEventArgs=void 0;let e=class{constructor(r){this.privConnectionMessage=r}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}};return Tn.ConnectionMessageEventArgs=e,Tn}var _n={},td;function lP(){if(td)return _n;td=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.VoiceProfile=void 0;let e=class{constructor(r,o){this.privId=r,this.privProfileType=o}get profileId(){return this.privId}get profileType(){return this.privProfileType}};return _n.VoiceProfile=e,_n}var St={},rd;function pP(){if(rd)return St;rd=1,Object.defineProperty(St,"__esModule",{value:!0}),St.VoiceProfileEnrollmentCancellationDetails=St.VoiceProfileEnrollmentResult=void 0;const e=k(),t=T();let r=class dc{constructor(a,s,n){this.privReason=a,this.privProperties=new t.PropertyCollection,this.privReason!==t.ResultReason.Canceled?s&&(this.privDetails=JSON.parse(s),this.privDetails.enrollmentStatus.toLowerCase()==="enrolling"&&(this.privReason=t.ResultReason.EnrollingVoiceProfile)):(this.privErrorDetails=n,this.privProperties.setProperty(e.CancellationErrorCodePropertyName,t.CancellationErrorCode[t.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get enrollmentResultDetails(){return this.privDetails}get errorDetails(){return this.privErrorDetails}static FromIdentificationProfileList(a){const s=[];for(const n of a.value){const c=n.enrollmentStatus.toLowerCase()==="enrolling"?t.ResultReason.EnrollingVoiceProfile:n.enrollmentStatus.toLowerCase()==="enrolled"?t.ResultReason.EnrolledVoiceProfile:t.ResultReason.Canceled,u=new dc(c,null,null);u.privDetails=this.getIdentificationDetails(n),s.push(u)}return s}static FromVerificationProfileList(a){const s=[];for(const n of a.value){const c=n.enrollmentStatus.toLowerCase()==="enrolling"?t.ResultReason.EnrollingVoiceProfile:n.enrollmentStatus.toLowerCase()==="enrolled"?t.ResultReason.EnrolledVoiceProfile:t.ResultReason.Canceled,u=new dc(c,null,null);u.privDetails=this.getVerificationDetails(n),s.push(u)}return s}static getIdentificationDetails(a){return{audioLength:a.audioLength?parseFloat(a.audioLength):0,audioSpeechLength:a.audioSpeechLength?parseFloat(a.audioSpeechLength):0,enrollmentStatus:a.enrollmentStatus,enrollmentsCount:a.enrollmentsCount||0,enrollmentsLength:a.enrollmentsLength?parseFloat(a.enrollmentsLength):0,enrollmentsSpeechLength:a.enrollmentsSpeechLength?parseFloat(a.enrollmentsSpeechLength):0,profileId:a.profileId||a.identificationProfileId,remainingEnrollmentsSpeechLength:a.remainingEnrollmentsSpeechLength?parseFloat(a.remainingEnrollmentsSpeechLength):0}}static getVerificationDetails(a){return{audioLength:a.audioLength?parseFloat(a.audioLength):0,audioSpeechLength:a.audioSpeechLength?parseFloat(a.audioSpeechLength):0,enrollmentStatus:a.enrollmentStatus,enrollmentsCount:a.enrollmentsCount,enrollmentsLength:a.enrollmentsLength?parseFloat(a.enrollmentsLength):0,enrollmentsSpeechLength:a.enrollmentsSpeechLength?parseFloat(a.enrollmentsSpeechLength):0,profileId:a.profileId||a.verificationProfileId,remainingEnrollmentsCount:a.remainingEnrollments||a.remainingEnrollmentsCount,remainingEnrollmentsSpeechLength:a.remainingEnrollmentsSpeechLength?parseFloat(a.remainingEnrollmentsSpeechLength):0}}};St.VoiceProfileEnrollmentResult=r;class o extends t.CancellationDetailsBase{constructor(a,s,n){super(a,s,n)}static fromResult(a){const s=t.CancellationReason.Error;let n=t.CancellationErrorCode.NoError;return a.properties&&(n=t.CancellationErrorCode[a.properties.getProperty(e.CancellationErrorCodePropertyName,t.CancellationErrorCode[t.CancellationErrorCode.NoError])]),new o(s,a.errorDetails,n)}}return St.VoiceProfileEnrollmentCancellationDetails=o,St}var Ct={},nd;function dP(){if(nd)return Ct;nd=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.VoiceProfileCancellationDetails=Ct.VoiceProfileResult=void 0;const e=k(),t=x(),r=T();let o=class{constructor(s,n){this.privReason=s,this.privProperties=new r.PropertyCollection,s===r.ResultReason.Canceled&&(t.Contracts.throwIfNullOrUndefined(n,"statusText"),this.privErrorDetails=n,this.privProperties.setProperty(e.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}};Ct.VoiceProfileResult=o;class i extends r.CancellationDetailsBase{constructor(s,n,c){super(s,n,c)}static fromResult(s){const n=r.CancellationReason.Error;let c=r.CancellationErrorCode.NoError;return s.properties&&(c=r.CancellationErrorCode[s.properties.getProperty(e.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.NoError])]),new i(n,s.errorDetails,c)}}return Ct.VoiceProfileCancellationDetails=i,Ct}var kn={},id;function hP(){if(id)return kn;id=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.VoiceProfilePhraseResult=void 0;const e=x(),t=T();let r=class extends t.VoiceProfileResult{constructor(i,a,s,n){super(i,a),this.privPhrases=[],e.Contracts.throwIfNullOrUndefined(n,"phrase array"),this.privType=s,n&&n[0]&&(this.privPhrases=n)}get phrases(){return this.privPhrases}get type(){return this.privType}};return kn.VoiceProfilePhraseResult=r,kn}var On={},sd;function fP(){if(sd)return On;sd=1,Object.defineProperty(On,"__esModule",{value:!0}),On.VoiceProfileClient=void 0;const e=k(),t=Hl(),r=x(),o=T();let i=class extends o.Recognizer{constructor(s){r.Contracts.throwIfNullOrUndefined(s,"speechConfig");const n=s;r.Contracts.throwIfNull(n,"speechConfig"),super(t.AudioConfig.fromStreamInput(o.AudioInputStream.createPushStream()),n.properties,new e.VoiceProfileConnectionFactory),this.privProperties=n.properties.clone(),this.privVoiceAdapter=this.privReco,this.privDisposedVoiceAdapter=!1}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(s){r.Contracts.throwIfNullOrWhitespace(s,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,s)}async createProfileAsync(s,n){const c=await this.privVoiceAdapter.createProfile(s,n);return new o.VoiceProfile(c[0],s)}async retrieveEnrollmentResultAsync(s){return this.privVoiceAdapter.retrieveEnrollmentResult(s)}async getAllProfilesAsync(s){return this.privVoiceAdapter.getAllProfiles(s)}async getActivationPhrasesAsync(s,n){return this.privVoiceAdapter.getActivationPhrases(s,n)}async enrollProfileAsync(s,n){const c=n;return r.Contracts.throwIfNullOrUndefined(c,"audioConfig"),this.audioConfig=n,this.privVoiceAdapter.SpeakerAudioSource=c,this.privVoiceAdapter.enrollProfile(s)}async deleteProfileAsync(s){return this.privVoiceAdapter.deleteProfile(s)}async resetProfileAsync(s){return this.privVoiceAdapter.resetProfile(s)}async close(){await this.dispose(!0)}createServiceRecognizer(s,n,c,u){const l=c;return new e.VoiceServiceRecognizer(s,n,l,u,this)}async dispose(s){this.privDisposedVoiceAdapter||(this.privDisposedVoiceAdapter=!0,s&&await super.dispose(s))}createRecognizerConfig(s){return new e.RecognizerConfig(s,this.properties)}getResult(s,n){return new o.VoiceProfileResult(s.ok?n:o.ResultReason.Canceled,s.statusText)}};return On.VoiceProfileClient=i,On}var Mn={},od;function vP(){if(od)return Mn;od=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.SpeakerRecognizer=void 0;const e=k(),t=x(),r=T();let o=class extends r.Recognizer{constructor(a,s){t.Contracts.throwIfNullOrUndefined(a,"speechConfig");const n=a;t.Contracts.throwIfNullOrUndefined(n,"speechConfig"),super(s,n.properties,new e.SpeakerRecognitionConnectionFactory),this.privAudioConfigImpl=s,t.Contracts.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privDisposedSpeakerRecognizer=!1,this.privProperties=n.properties}get authorizationToken(){return this.properties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){t.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a)}get properties(){return this.privProperties}async recognizeOnceAsync(a){return t.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),this.recognizeSpeakerOnceAsyncImpl(a)}async close(){t.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.dispose(!0)}async recognizeSpeakerOnceAsyncImpl(a){t.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.implRecognizerStop();const s=await this.privReco.recognizeSpeaker(a);return await this.implRecognizerStop(),s}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}createRecognizerConfig(a){return new e.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,s,n,c){const u=n;return new e.SpeakerServiceRecognizer(a,s,u,c,this)}async dispose(a){this.privDisposedSpeakerRecognizer||a&&(this.privDisposedSpeakerRecognizer=!0,await super.dispose(a))}};return Mn.SpeakerRecognizer=o,Mn}var Dn={},ad;function gP(){if(ad)return Dn;ad=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.SpeakerIdentificationModel=void 0;const e=x(),t=T();let r=class Wv{constructor(i){if(this.privVoiceProfiles=[],this.privProfileIds=[],e.Contracts.throwIfNullOrUndefined(i,"VoiceProfiles"),i.length===0)throw new Error("Empty Voice Profiles array");for(const a of i){if(a.profileType!==t.VoiceProfileType.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+a.profileId);this.privVoiceProfiles.push(a),this.privProfileIds.push(a.profileId)}}static fromProfiles(i){return new Wv(i)}get voiceProfileIds(){return this.privProfileIds.join(",")}get profileIds(){return this.privProfileIds}get scenario(){return"TextIndependentIdentification"}};return Dn.SpeakerIdentificationModel=r,Dn}var Nn={},cd;function mP(){if(cd)return Nn;cd=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.SpeakerVerificationModel=void 0;const e=x(),t=T();let r=class Hv{constructor(i){if(e.Contracts.throwIfNullOrUndefined(i,"VoiceProfile"),i.profileType===t.VoiceProfileType.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=i}static fromProfile(i){return new Hv(i)}get voiceProfile(){return this.privVoiceProfile}get profileIds(){return[this.voiceProfile.profileId]}get scenario(){return this.voiceProfile.profileType===t.VoiceProfileType.TextDependentVerification?"TextDependentVerification":"TextIndependentVerification"}};return Nn.SpeakerVerificationModel=r,Nn}var xn={},ea={},ud;function ld(){return ud||(ud=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageIdMode=void 0,function(t){t[t.AtStart=0]="AtStart",t[t.Continuous=1]="Continuous"}(e.LanguageIdMode||(e.LanguageIdMode={}))}(ea)),ea}var pd;function yP(){if(pd)return xn;pd=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.AutoDetectSourceLanguageConfig=void 0;const e=k(),t=x(),r=T(),o=ld();let i=class Zs{constructor(){this.privProperties=new r.PropertyCollection,this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=o.LanguageIdMode.AtStart}static fromOpenRange(){const s=new Zs;return s.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,e.AutoDetectSourceLanguagesOpenRangeOptionName),s.properties.setProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),s}static fromLanguages(s){t.Contracts.throwIfArrayEmptyOrWhitespace(s,"languages");const n=new Zs;return n.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,s.join()),n}static fromSourceLanguageConfigs(s){if(s.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const n=new Zs,c=[];return s.forEach(u=>{if(c.push(u.language),u.endpointId!==void 0&&u.endpointId!==""){const l=u.language+r.PropertyId.SpeechServiceConnection_EndpointId.toString();n.properties.setProperty(l,u.endpointId)}}),n.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,c.join()),n}get properties(){return this.privProperties}set mode(s){s===o.LanguageIdMode.Continuous?(this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=s}};return xn.AutoDetectSourceLanguageConfig=i,xn}var zn={},dd;function SP(){if(dd)return zn;dd=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.AutoDetectSourceLanguageResult=void 0;const e=x();let t=class hc{constructor(o,i){e.Contracts.throwIfNullOrUndefined(o,"language"),e.Contracts.throwIfNullOrUndefined(i,"languageDetectionConfidence"),this.privLanguage=o,this.privLanguageDetectionConfidence=i}static fromResult(o){return new hc(o.language,o.languageDetectionConfidence)}static fromConversationTranscriptionResult(o){return new hc(o.language,o.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}};return zn.AutoDetectSourceLanguageResult=t,zn}var Ln={},hd;function CP(){if(hd)return Ln;hd=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.SourceLanguageConfig=void 0;const e=x();let t=class Kv{constructor(o,i){e.Contracts.throwIfNullOrUndefined(o,"language"),this.privLanguage=o,this.privEndpointId=i}static fromLanguage(o,i){return new Kv(o,i)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}};return Ln.SourceLanguageConfig=t,Ln}var ta={},fd;function PP(){return fd||(fd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SpeakerRecognitionCancellationDetails=e.SpeakerRecognitionResult=e.SpeakerRecognitionResultType=void 0;const t=k(),r=T();var o;(function(s){s[s.Verify=0]="Verify",s[s.Identify=1]="Identify"})(o=e.SpeakerRecognitionResultType||(e.SpeakerRecognitionResultType={}));class i{constructor(n,c=r.ResultReason.RecognizedSpeaker,u=r.CancellationErrorCode.NoError,l=""){this.privProperties=new r.PropertyCollection;const p=n.scenario==="TextIndependentIdentification"?o.Identify:o.Verify;this.privReason=c,this.privReason!==r.ResultReason.Canceled?p===o.Identify?(this.privProfileId=n.identificationResult.identifiedProfile.profileId,this.privScore=n.identificationResult.identifiedProfile.score,this.privReason=r.ResultReason.RecognizedSpeakers):(this.privScore=n.verificationResult.score,n.verificationResult.recognitionResult.toLowerCase()!=="accept"&&(this.privReason=r.ResultReason.NoMatch),n.verificationResult.profileId!==void 0&&n.verificationResult.profileId!==""&&(this.privProfileId=n.verificationResult.profileId)):(this.privErrorDetails=l,this.privProperties.setProperty(t.CancellationErrorCodePropertyName,r.CancellationErrorCode[u])),this.privProperties.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,JSON.stringify(n))}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}}e.SpeakerRecognitionResult=i;class a extends r.CancellationDetailsBase{constructor(n,c,u){super(n,c,u)}static fromResult(n){const c=r.CancellationReason.Error;let u=r.CancellationErrorCode.NoError;return n.properties&&(u=r.CancellationErrorCode[n.properties.getProperty(t.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.NoError])]),new a(c,n.errorDetails,u)}}e.SpeakerRecognitionCancellationDetails=a}(ta)),ta}var ra={},Pt={},vd;function gd(){if(vd)return Pt;vd=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.ConversationImpl=Pt.Conversation=void 0;const e=k(),t=O(),r=x(),o=T();let i=class{constructor(){}static createConversationAsync(n,c,u,l){r.Contracts.throwIfNullOrUndefined(n,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),r.Contracts.throwIfNullOrUndefined(n.region,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!n.subscriptionKey&&!n.getProperty(o.PropertyId[o.PropertyId.SpeechServiceAuthorization_Token])&&r.Contracts.throwIfNullOrUndefined(n.subscriptionKey,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let p,d,h;return typeof c=="string"?(p=new a(n,c),(0,t.marshalPromiseToCallbacks)((async()=>{})(),u,l)):(p=new a(n),d=c,h=u,p.createConversationAsync(()=>{d&&d()},f=>{h&&h(f)})),p}};Pt.Conversation=i;class a extends i{constructor(n,c){if(super(),this.privErrors=e.ConversationConnectionConfig.restErrors,this.onConnected=p=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,p)}catch{}},this.onDisconnected=p=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,p)}catch{}finally{this.close(!1)}},this.onCanceled=(p,d)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,d)}catch{}},this.onParticipantUpdateCommandReceived=(p,d)=>{try{const h=this.privParticipants.getParticipant(d.id);if(h!==void 0){switch(d.key){case e.ConversationTranslatorCommandTypes.changeNickname:h.displayName=d.value;break;case e.ConversationTranslatorCommandTypes.setUseTTS:h.isUsingTts=d.value;break;case e.ConversationTranslatorCommandTypes.setProfanityFiltering:h.profanity=d.value;break;case e.ConversationTranslatorCommandTypes.setMute:h.isMuted=d.value;break;case e.ConversationTranslatorCommandTypes.setTranslateToLanguages:h.translateToLanguages=d.value;break}this.privParticipants.addOrUpdateParticipant(h),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.Updated,[this.toParticipant(h)],d.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(p,d)=>{try{this.privParticipants.participants.forEach(h=>h.isMuted=h.isHost?!1:d.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.Updated,this.toParticipants(!1),d.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(p,d)=>{try{const h=this.privParticipants.addOrUpdateParticipant(d.participant);h!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.JoinedConversation,[this.toParticipant(h)],d.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(p,d)=>{try{const h=this.privParticipants.getParticipant(d.participant.id);h!==void 0&&(this.privParticipants.deleteParticipant(d.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.LeftConversation,[this.toParticipant(h)],d.sessionId)))}catch{}},this.onTranslationReceived=(p,d)=>{try{switch(d.command){case e.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new o.ConversationTranslationEventArgs(d.payload,void 0,d.sessionId));break;case e.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new o.ConversationTranslationEventArgs(d.payload,void 0,d.sessionId));break;case e.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new o.ConversationTranslationEventArgs(d.payload,void 0,d.sessionId));break}}catch{}},this.onParticipantsListReceived=(p,d)=>{try{if(d.sessionToken!==void 0&&d.sessionToken!==null&&(this.privRoom.token=d.sessionToken),this.privParticipants.participants=[...d.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),d.sessionId)),this.me.isHost){const h=this.privConversationTranslator?.properties.getProperty(o.PropertyId.ConversationTranslator_Name);h!==void 0&&h.length>0&&h!==this.me.displayName&&this.changeNicknameAsync(h)}}catch{}},this.onConversationExpiration=(p,d)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,d)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new o.PropertyCollection,this.privManager=new e.ConversationManager,n.getProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage])||n.setProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage],e.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=n.getProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage]),c)this.privConversationId=c;else{n.targetLanguages.length===0&&n.addTargetLanguage(this.privLanguage),n.getProperty(o.PropertyId[o.PropertyId.SpeechServiceResponse_ProfanityOption])||n.setProfanity(o.ProfanityOption.Masked);let d=n.getProperty(o.PropertyId[o.PropertyId.ConversationTranslator_Name]);d==null&&(d="Host"),r.Contracts.throwIfNullOrTooLong(d,"nickname",50),r.Contracts.throwIfNullOrTooShort(d,"nickname",2),n.setProperty(o.PropertyId[o.PropertyId.ConversationTranslator_Name],d)}this.privConfig=n;const l=n;r.Contracts.throwIfNull(l,"speechConfig"),this.privProperties=l.properties.clone(),this.privIsConnected=!1,this.privParticipants=new e.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return this.privParticipants.me?.isHost?!1:this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const n=this.conversationId,c=this.participants.map(p=>({id:p.id,preferredLanguage:p.preferredLanguage,voice:p.voice})),u={};for(const p of e.ConversationConnectionConfig.transcriptionEventKeys){const d=this.properties.getProperty(p,"");d!==""&&(u[p]=d)}return{id:n,participants:c,conversationProperties:u}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(n){r.Contracts.throwIfNullOrWhitespace(n,"authorizationToken"),this.privToken=n}set conversationTranslator(n){this.privConversationTranslator=n}onToken(n){this.privConversationTranslator.onToken(n)}createConversationAsync(n,c){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),c),this.privManager.createOrJoin(this.privProperties,void 0,u=>{u||this.handleError(new Error(this.privErrors.permissionDeniedConnect),c),this.privRoom=u,this.handleCallback(n,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}startConversationAsync(n,c){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),c),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=e.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(n,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}addParticipantAsync(n,c,u){r.Contracts.throwIfNullOrUndefined(n,"Participant"),(0,t.marshalPromiseToCallbacks)(this.addParticipantImplAsync(n),c,u)}joinConversationAsync(n,c,u,l,p){try{r.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","conversationId")),r.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,n,d=>{r.Contracts.throwIfNullOrUndefined(d,this.privErrors.permissionDeniedConnect),this.privRoom=d,this.privConfig.authorizationToken=d.cognitiveSpeechAuthToken,l&&l(d.cognitiveSpeechAuthToken)},d=>{this.handleError(d,p)})}catch(d){this.handleError(d,p)}}deleteConversationAsync(n,c){(0,t.marshalPromiseToCallbacks)(this.deleteConversationImplAsync(),n,c)}async deleteConversationImplAsync(){r.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),r.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endConversationAsync(n,c){(0,t.marshalPromiseToCallbacks)(this.endConversationImplAsync(),n,c)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(n,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(n,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}muteAllParticipantsAsync(n,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(n,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}muteParticipantAsync(n,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==n&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(n)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(n,!0),()=>{this.handleCallback(c,u)},p=>{this.handleError(p,u)})}catch(l){this.handleError(l,u)}}removeParticipantAsync(n,c,u){try{if(r.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&n.hasOwnProperty("id"))(0,t.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(n),c,u);else{r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),u);let l="";typeof n=="string"?l=n:n.hasOwnProperty("id")?l=n.id:n.hasOwnProperty("userId")&&(l=n.userId),r.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(d=>d.id===l)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(l),()=>{this.handleCallback(c,u)},d=>{this.handleError(d,u)})}}catch(l){this.handleError(l,u)}}unlockConversationAsync(n,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(n,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}unmuteAllParticipantsAsync(n,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(n,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}unmuteParticipantAsync(n,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==n&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(n)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(n,!1),()=>{this.handleCallback(c,u)},p=>{this.handleError(p,u)})}catch(l){this.handleError(l,u)}}sendTextMessageAsync(n,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","message")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),n.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(n),()=>{this.handleCallback(c,u)},l=>{this.handleError(l,u)})}catch(l){this.handleError(l,u)}}setTranslatedLanguagesAsync(n,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfArrayEmptyOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","languages")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(n),()=>{this.handleCallback(c,u)},l=>{this.handleError(l,u)})}catch(l){this.handleError(l,u)}}changeNicknameAsync(n,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(n),()=>{this.handleCallback(c,u)},l=>{this.handleError(l,u)})}catch(l){this.handleError(l,u)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(n){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await n.enforceAudioGating(),this.privTranscriberRecognizer=n,this.privTranscriberRecognizer.conversation=this}getKeepAlive(){const n=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:n,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(n){if(this.privParticipants.addOrUpdateParticipant(n)!==void 0&&this.privTranscriberRecognizer){const u=this.conversationInfo;return u.participants=[n],this.privTranscriberRecognizer.pushConversationEvent(u,"join")}}removeParticipantImplAsync(n){this.privParticipants.deleteParticipant(n.id);const c=this.conversationInfo;return c.participants=[n],this.privTranscriberRecognizer.pushConversationEvent(c,"leave")}async close(n){try{this.privIsConnected=!1,await this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(c){throw c}n&&this.dispose()}handleCallback(n,c){if(n){try{n()}catch(u){c&&c(u)}n=void 0}}handleError(n,c){if(c)if(n instanceof Error){const u=n;c(u.name+": "+u.message)}else c(n)}toParticipants(n){const c=this.privParticipants.participants.map(u=>this.toParticipant(u));return n?c:c.filter(u=>u.isHost===!1)}toParticipant(n){return new o.Participant(n.id,n.avatar,n.displayName,n.isHost,n.isMuted,n.isUsingTts,n.preferredLanguage,n.voice)}getMuteAllCommand(n){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:n})}getMuteCommand(n,c){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(n,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMute,participantId:n,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:c})}getLockCommand(n){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:n})}getEjectCommand(n){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(n,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.ejectParticipant,participantId:n,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(n){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:n})}getChangeNicknameCommand(n){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(n,"nickname"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.changeNickname,nickname:n,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:n})}getMessageCommand(n){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),r.Contracts.throwIfNullOrWhitespace(n,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:n,type:e.ConversationTranslatorMessageTypes.instantMessage})}}return Pt.ConversationImpl=a,Pt}var jn={},md;function RP(){if(md)return jn;md=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.ConversationCommon=void 0;let e=class{constructor(r){this.privAudioConfig=r}handleCallback(r,o){if(r){try{r()}catch(i){o&&o(i)}r=void 0}}handleError(r,o){if(o)if(r instanceof Error){const i=r;o(i.name+": "+i.message)}else o(r)}};return jn.ConversationCommon=e,jn}var qn={},yd;function bP(){if(yd)return qn;yd=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.ConversationExpirationEventArgs=void 0;const e=T();let t=class extends e.SessionEventArgs{constructor(o,i){super(i),this.privExpirationTime=o}get expirationTime(){return this.privExpirationTime}};return qn.ConversationExpirationEventArgs=t,qn}var Fn={},Sd;function wP(){if(Sd)return Fn;Sd=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.ConversationParticipantsChangedEventArgs=void 0;const e=T();let t=class extends e.SessionEventArgs{constructor(o,i,a){super(a),this.privReason=o,this.privParticipant=i}get reason(){return this.privReason}get participants(){return this.privParticipant}};return Fn.ConversationParticipantsChangedEventArgs=t,Fn}var Bn={},Cd;function EP(){if(Cd)return Bn;Cd=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.ConversationTranslationCanceledEventArgs=void 0;const e=Yr();let t=class extends e.CancellationEventArgsBase{};return Bn.ConversationTranslationCanceledEventArgs=t,Bn}var Un={},Pd;function IP(){if(Pd)return Un;Pd=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.ConversationTranslationEventArgs=void 0;const e=T();let t=class extends e.RecognitionEventArgs{constructor(o,i,a){super(i,a),this.privResult=o}get result(){return this.privResult}};return Un.ConversationTranslationEventArgs=t,Un}var $n={},Rd;function AP(){if(Rd)return $n;Rd=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.ConversationTranslationResult=void 0;const e=pp();let t=class extends e.TranslationRecognitionResult{constructor(o,i,a,s,n,c,u,l,p,d,h){super(i,s,n,c,u,l,void 0,void 0,p,d,h),this.privId=o,this.privOrigLang=a}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};return $n.ConversationTranslationResult=t,$n}var na={},Vn={},Wn={},bd;function wd(){if(bd)return Wn;bd=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.StringUtils=void 0;let e=class{static formatString(r,o){if(!r)return"";if(!o)return r;let i="",a="";const s=u=>{i+=u},n=u=>{a+=u};let c=s;for(let u=0;u<r.length;u++){const l=r[u],p=u+1<r.length?r[u+1]:"";switch(l){case"{":p==="{"?(c("{"),u++):c=n;break;case"}":p==="}"?(c("}"),u++):(o.hasOwnProperty(a)&&(i+=o[a]),c=s,a="");break;default:c(l);break}}return i}};return Wn.StringUtils=e,Wn}var Ed;function TP(){if(Ed)return Vn;Ed=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.ConversationTranslatorConnectionFactory=void 0;const e=ie(),t=wd(),r=x(),o=T(),i=le(),a=Ge(),s=Ee(),n=k();let c=class Jv extends s.ConnectionFactoryBase{constructor(l){super(),r.Contracts.throwIfNullOrUndefined(l,"convGetter"),this.privConvGetter=l}create(l,p,d){const h=l.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",f=this.privConvGetter().room,g=f.cognitiveSpeechRegion||l.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Region,""),m={hostSuffix:s.ConnectionFactoryBase.getHostSuffix(g),path:Jv.CTS_VIRT_MIC_PATH,region:encodeURIComponent(g)};m[a.QueryParameterNames.Language]=encodeURIComponent(l.parameters.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage,"")),m[a.QueryParameterNames.CtsMeetingId]=encodeURIComponent(f.roomId),m[a.QueryParameterNames.CtsDeviceId]=encodeURIComponent(f.participantId),m[a.QueryParameterNames.CtsIsParticipant]=f.isHost?"":"&"+a.QueryParameterNames.CtsIsParticipant;let v="";const y={},S={};if(h){v=l.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Endpoint),v||(v="wss://"+l.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),v=t.StringUtils.formatString(v,m);const b=new URL(v);b.searchParams.forEach((A,E)=>{y[E]=A}),new n.TranscriberConnectionFactory().setQueryParams(y,l,v),y[a.QueryParameterNames.CtsMeetingId]=m[a.QueryParameterNames.CtsMeetingId],y[a.QueryParameterNames.CtsDeviceId]=m[a.QueryParameterNames.CtsDeviceId],f.isHost||(y[a.QueryParameterNames.CtsIsParticipant]=""),a.QueryParameterNames.Format in y||(y[a.QueryParameterNames.Format]="simple"),b.searchParams.forEach((A,E)=>{b.searchParams.set(E,y[E]),delete y[E]}),v=b.toString()}else{const b=new n.TranslationConnectionFactory;v=b.getEndpointUrl(l,!0),v=t.StringUtils.formatString(v,m),b.setQueryParams(y,l,v)}S[i.HeaderNames.ConnectionId]=d,S[e.RestConfigBase.configParams.token]=f.token,p.token&&(S[p.headerName]=p.token);const P=l.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return Promise.resolve(new e.WebsocketConnection(v,y,S,new n.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(l),P,d))}};return Vn.ConversationTranslatorConnectionFactory=c,c.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio",Vn}var Id;function _P(){return Id||(Id=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranslator=e.SpeechState=void 0;const t=k(),r=TP(),o=O(),i=x(),a=T(),s=gd(),n=sa();var c;(function(p){p[p.Inactive=0]="Inactive",p[p.Connecting=1]="Connecting",p[p.Connected=2]="Connected"})(c=e.SpeechState||(e.SpeechState={}));class u extends a.TranslationRecognizer{constructor(d,h,f,g){super(d,h,new r.ConversationTranslatorConnectionFactory(g)),this.privSpeechState=c.Inactive,f&&(this.privTranslator=f,this.sessionStarted=()=>{this.privSpeechState=c.Connected},this.sessionStopped=()=>{this.privSpeechState=c.Inactive},this.recognizing=(m,v)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,v)},this.recognized=async(m,v)=>{v.result?.errorDetails?(await this.cancelSpeech(),this.fireCancelEvent(v.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,v)},this.canceled=async()=>{if(this.privSpeechState!==c.Inactive)try{await this.cancelSpeech()}catch{this.privSpeechState=c.Inactive}})}get state(){return this.privSpeechState}set state(d){this.privSpeechState=d}set authentication(d){this.privReco.authentication=d}onConnection(){this.privSpeechState=c.Connected}async onCancelSpeech(){this.privSpeechState=c.Inactive,await this.cancelSpeech()}fireCancelEvent(d){try{if(this.privTranslator.canceled){const h=new n.ConversationTranslationCanceledEventArgs(a.CancellationReason.Error,d,a.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,h)}}catch{}}async cancelSpeech(){try{this.stopContinuousRecognitionAsync(),await this.privReco?.disconnect(),this.privSpeechState=c.Inactive}catch{}}}class l extends n.ConversationCommon{constructor(d){super(d),this.privErrors=t.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new a.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){return this.privConversation?.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===c.Connected||this.privCTRecognizer.state===c.Connecting||this.privConversation.isMutedByHost)}onToken(d){this.privCTRecognizer.authentication=d}setServiceProperty(d,h){const f=JSON.parse(this.privProperties.getProperty(t.ServicePropertiesPropertyName,"{}"));f[d]=h,this.privProperties.setProperty(t.ServicePropertiesPropertyName,JSON.stringify(f))}joinConversationAsync(d,h,f,g,m){try{if(typeof d=="string"){i.Contracts.throwIfNullOrUndefined(d,this.privErrors.invalidArgs.replace("{arg}","conversation id")),i.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),m);let v=f;(v==null||v==="")&&(v=t.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=a.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(a.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(v),this.privSpeechTranslationConfig.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage],v),this.privSpeechTranslationConfig.setProperty(a.PropertyId[a.PropertyId.ConversationTranslator_Name],h);const y=[a.PropertyId.SpeechServiceConnection_Host,a.PropertyId.ConversationTranslator_Host,a.PropertyId.SpeechServiceConnection_Endpoint,a.PropertyId.SpeechServiceConnection_ProxyHostName,a.PropertyId.SpeechServiceConnection_ProxyPassword,a.PropertyId.SpeechServiceConnection_ProxyPort,a.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const P of y){const b=this.privProperties.getProperty(P);if(b){const w=typeof P=="string"?P:a.PropertyId[P];this.privSpeechTranslationConfig.setProperty(w,b)}}const S=JSON.parse(this.privProperties.getProperty(t.ServicePropertiesPropertyName,"{}"));for(const P of Object.keys(S))this.privSpeechTranslationConfig.setServiceProperty(P,S[P],a.ServicePropertyChannel.UriQueryParameter);this.privConversation=new s.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(d,h,v,P=>{P||this.handleError(new Error(this.privErrors.permissionDeniedConnect),m),this.privSpeechTranslationConfig.authorizationToken=P,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync(()=>{this.handleCallback(g,m)},b=>{this.handleError(b,m)})},P=>{this.handleError(P,m)})}else typeof d=="object"?(i.Contracts.throwIfNullOrUndefined(d,this.privErrors.invalidArgs.replace("{arg}","conversation id")),i.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(a.PropertyId.ConversationTranslator_Name,h),this.privConversation=d,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,i.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),i.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=d.config,this.handleCallback(f,g)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),g)}catch(v){this.handleError(v,typeof f=="string"?m:g)}}leaveConversationAsync(d,h){(0,o.marshalPromiseToCallbacks)((async()=>{await this.cancelSpeech(),await this.privConversation.endConversationImplAsync(),await this.privConversation.deleteConversationImplAsync(),this.dispose()})(),d,h)}sendTextMessageAsync(d,h,f){try{i.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrWhitespace(d,this.privErrors.invalidArgs.replace("{arg}",d)),this.privConversation.sendTextMessageAsync(d,h,f)}catch(g){this.handleError(g,f)}}startTranscribingAsync(d,h){(0,o.marshalPromiseToCallbacks)((async()=>{try{i.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),i.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&await this.connectTranslatorRecognizer(),i.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),h),await this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(f){throw this.privIsSpeaking=!1,await this.cancelSpeech(),f}})(),d,h)}stopTranscribingAsync(d,h){(0,o.marshalPromiseToCallbacks)((async()=>{try{if(!this.privIsSpeaking){await this.cancelSpeech();return}this.privIsSpeaking=!1,await new Promise((f,g)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(f,g)})}catch{await this.cancelSpeech()}})(),d,h)}isDisposed(){return this.privIsDisposed}dispose(d,h,f){(0,o.marshalPromiseToCallbacks)((async()=>{this.isDisposed&&!this.privIsSpeaking||(await this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})(),h,f)}async cancelSpeech(){try{this.privIsSpeaking=!1,await this.privCTRecognizer?.onCancelSpeech(),this.privCTRecognizer=void 0}catch{}}async connectTranslatorRecognizer(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=a.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_Key],"");const d=()=>this.privConversation;this.privCTRecognizer=new u(this.privSpeechTranslationConfig,this.privAudioConfig,this,d)}catch(d){throw await this.cancelSpeech(),d}}startContinuousRecognition(){return new Promise((d,h)=>{this.privCTRecognizer.startContinuousRecognitionAsync(d,h)})}}e.ConversationTranslator=l}(na)),na}var Hn={},Ad;function kP(){if(Ad)return Hn;Ad=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.ConversationTranscriber=void 0;const e=k(),t=Ce(),r=O(),o=x(),i=T();let a=class Gv extends i.Recognizer{constructor(n,c){const u=n;o.Contracts.throwIfNull(u,"speechConfig"),o.Contracts.throwIfNullOrWhitespace(u.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),i.PropertyId[i.PropertyId.SpeechServiceConnection_RecoLanguage]),super(c,u.properties,new e.ConversationTranscriberConnectionFactory,n.tokenCredential),this.privProperties.setProperty(i.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(n,c,u){const l=n;return c.properties.mergeTo(l.properties),new Gv(n,u)}get endpointId(){return o.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){o.Contracts.throwIfNullOrWhitespace(n,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,n)}get speechRecognitionLanguage(){return o.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return o.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(e.OutputFormatPropertyName,i.OutputFormat[i.OutputFormat.Simple])===i.OutputFormat[i.OutputFormat.Simple]?i.OutputFormat.Simple:i.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(n,c){(0,r.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(t.RecognitionMode.Conversation),n,c)}stopTranscribingAsync(n,c){(0,r.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),n,c)}close(n,c){o.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),n,c)}async dispose(n){this.privDisposedRecognizer||(n&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(n))}createRecognizerConfig(n){return new e.RecognizerConfig(n,this.privProperties)}createServiceRecognizer(n,c,u,l){const p=u;return l.isSpeakerDiarizationEnabled=!0,new e.ConversationTranscriptionServiceRecognizer(n,c,p,l,this)}};return Hn.ConversationTranscriber=a,Hn}var Rt={},Td;function OP(){if(Td)return Rt;Td=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.Participant=Rt.User=void 0;const e=T();class t{constructor(i){this.privUserId=i}get userId(){return this.privUserId}}Rt.User=t;class r{constructor(i,a,s,n,c,u,l,p){this.privId=i,this.privAvatar=a,this.privDisplayName=s,this.privIsHost=n,this.privIsMuted=c,this.privIsUsingTts=u,this.privPreferredLanguage=l,this.privVoice=p,this.privProperties=new e.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(i,a,s){return new r(i,"",i,!1,!1,!1,a,s)}}return Rt.Participant=r,Rt}var ia={},_d;function MP(){return _d||(_d=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ParticipantChangedReason=void 0,function(t){t[t.JoinedConversation=0]="JoinedConversation",t[t.LeftConversation=1]="LeftConversation",t[t.Updated=2]="Updated"}(e.ParticipantChangedReason||(e.ParticipantChangedReason={}))}(ia)),ia}var bt={},kd;function DP(){if(kd)return bt;kd=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.MeetingImpl=bt.Meeting=void 0;const e=k(),t=O(),r=x(),o=T();let i=class{constructor(){}static createMeetingAsync(n,c,u,l){if(r.Contracts.throwIfNullOrUndefined(n,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),r.Contracts.throwIfNullOrUndefined(n.region,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),r.Contracts.throwIfNull(c,"meetingId"),c.length===0)throw new Error("meetingId cannot be empty");!n.subscriptionKey&&!n.getProperty(o.PropertyId[o.PropertyId.SpeechServiceAuthorization_Token])&&r.Contracts.throwIfNullOrUndefined(n.subscriptionKey,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const p=new a(n,c);return(0,t.marshalPromiseToCallbacks)((async()=>{})(),u,l),p}};bt.Meeting=i;class a extends i{constructor(n,c){super(),this.privErrors=e.ConversationConnectionConfig.restErrors,this.onConnected=p=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,p)}catch{}},this.onDisconnected=p=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,p)}catch{}finally{this.close(!1)}},this.onCanceled=(p,d)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,d)}catch{}},this.onParticipantUpdateCommandReceived=(p,d)=>{try{const h=this.privParticipants.getParticipant(d.id);if(h!==void 0){switch(d.key){case e.ConversationTranslatorCommandTypes.changeNickname:h.displayName=d.value;break;case e.ConversationTranslatorCommandTypes.setUseTTS:h.isUsingTts=d.value;break;case e.ConversationTranslatorCommandTypes.setProfanityFiltering:h.profanity=d.value;break;case e.ConversationTranslatorCommandTypes.setMute:h.isMuted=d.value;break;case e.ConversationTranslatorCommandTypes.setTranslateToLanguages:h.translateToLanguages=d.value;break}this.privParticipants.addOrUpdateParticipant(h),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.Updated,[this.toParticipant(h)],d.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(p,d)=>{try{this.privParticipants.participants.forEach(h=>h.isMuted=h.isHost?!1:d.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.Updated,this.toParticipants(!1),d.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(p,d)=>{try{const h=this.privParticipants.addOrUpdateParticipant(d.participant);h!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.JoinedConversation,[this.toParticipant(h)],d.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(p,d)=>{try{const h=this.privParticipants.getParticipant(d.participant.id);h!==void 0&&(this.privParticipants.deleteParticipant(d.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.LeftConversation,[this.toParticipant(h)],d.sessionId)))}catch{}},this.onTranslationReceived=(p,d)=>{try{switch(d.command){case e.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new o.ConversationTranslationEventArgs(d.payload,void 0,d.sessionId));break;case e.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new o.ConversationTranslationEventArgs(d.payload,void 0,d.sessionId));break;case e.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new o.ConversationTranslationEventArgs(d.payload,void 0,d.sessionId));break}}catch{}},this.onParticipantsListReceived=(p,d)=>{try{if(d.sessionToken!==void 0&&d.sessionToken!==null&&(this.privRoom.token=d.sessionToken),this.privParticipants.participants=[...d.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),d.sessionId)),this.me.isHost){const h=this.privConversationTranslator?.properties.getProperty(o.PropertyId.ConversationTranslator_Name);h!==void 0&&h.length>0&&h!==this.me.displayName&&this.changeNicknameAsync(h)}}catch{}},this.onConversationExpiration=(p,d)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,d)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new o.PropertyCollection,this.privManager=new e.ConversationManager,n.getProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage])||n.setProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage],e.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=n.getProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=c,this.privConfig=n;const l=n;r.Contracts.throwIfNull(l,"speechConfig"),this.privProperties=l.properties.clone(),this.privIsConnected=!1,this.privParticipants=new e.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return this.privParticipants.me?.isHost?!1:this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){const n=this.meetingId,c=this.participants.map(p=>({id:p.id,preferredLanguage:p.preferredLanguage,voice:p.voice})),u={};for(const p of e.ConversationConnectionConfig.transcriptionEventKeys){const d=this.properties.getProperty(p,"");d!==""&&(u[p]=d)}return{id:n,participants:c,meetingProperties:u}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(n){r.Contracts.throwIfNullOrWhitespace(n,"authorizationToken"),this.privToken=n}createMeetingAsync(n,c){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),c),this.privManager.createOrJoin(this.privProperties,void 0,u=>{u||this.handleError(new Error(this.privErrors.permissionDeniedConnect),c),this.privRoom=u,this.handleCallback(n,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}startMeetingAsync(n,c){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),c),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(n,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}addParticipantAsync(n,c,u){r.Contracts.throwIfNullOrUndefined(n,"Participant"),(0,t.marshalPromiseToCallbacks)(this.addParticipantImplAsync(n),c,u)}joinMeetingAsync(n,c,u,l,p){try{r.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","conversationId")),r.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,n,d=>{r.Contracts.throwIfNullOrUndefined(d,this.privErrors.permissionDeniedConnect),this.privRoom=d,this.privConfig.authorizationToken=d.cognitiveSpeechAuthToken,l&&l(d.cognitiveSpeechAuthToken)},d=>{this.handleError(d,p)})}catch(d){this.handleError(d,p)}}deleteMeetingAsync(n,c){(0,t.marshalPromiseToCallbacks)(this.deleteMeetingImplAsync(),n,c)}async deleteMeetingImplAsync(){r.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),r.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endMeetingAsync(n,c){(0,t.marshalPromiseToCallbacks)(this.endMeetingImplAsync(),n,c)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(n,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(n,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}muteAllParticipantsAsync(n,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(n,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}muteParticipantAsync(n,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==n&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(n)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(n,!0),()=>{this.handleCallback(c,u)},p=>{this.handleError(p,u)})}catch(l){this.handleError(l,u)}}removeParticipantAsync(n,c,u){try{if(r.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&n.hasOwnProperty("id"))(0,t.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(n),c,u);else{r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),u);let l="";typeof n=="string"?l=n:n.hasOwnProperty("id")?l=n.id:n.hasOwnProperty("userId")&&(l=n.userId),r.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(d=>d.id===l)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(l),()=>{this.handleCallback(c,u)},d=>{this.handleError(d,u)})}}catch(l){this.handleError(l,u)}}unlockMeetingAsync(n,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(n,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}unmuteAllParticipantsAsync(n,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(n,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}unmuteParticipantAsync(n,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),!this.me.isHost&&this.me.id!==n&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),u),this.privParticipants.getParticipantIndex(n)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(n,!1),()=>{this.handleCallback(c,u)},p=>{this.handleError(p,u)})}catch(l){this.handleError(l,u)}}sendTextMessageAsync(n,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","message")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),n.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(n),()=>{this.handleCallback(c,u)},l=>{this.handleError(l,u)})}catch(l){this.handleError(l,u)}}setTranslatedLanguagesAsync(n,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfArrayEmptyOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","languages")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(n),()=>{this.handleCallback(c,u)},l=>{this.handleError(l,u)})}catch(l){this.handleError(l,u)}}changeNicknameAsync(n,c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),u),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(n),()=>{this.handleCallback(c,u)},l=>{this.handleError(l,u)})}catch(l){this.handleError(l,u)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(n){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await n.enforceAudioGating(),this.privTranscriberRecognizer=n,this.privTranscriberRecognizer.meeting=this}getKeepAlive(){const n=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:n,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(n){if(this.privParticipants.addOrUpdateParticipant(n)!==void 0&&this.privTranscriberRecognizer){const u=this.meetingInfo;return u.participants=[n],this.privTranscriberRecognizer.pushMeetingEvent(u,"join")}}removeParticipantImplAsync(n){this.privParticipants.deleteParticipant(n.id);const c=this.meetingInfo;return c.participants=[n],this.privTranscriberRecognizer.pushMeetingEvent(c,"leave")}async close(n){try{this.privIsConnected=!1,await this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(c){throw c}n&&this.dispose()}handleCallback(n,c){if(n){try{n()}catch(u){c&&c(u)}n=void 0}}handleError(n,c){if(c)if(n instanceof Error){const u=n;c(u.name+": "+u.message)}else c(n)}toParticipants(n){const c=this.privParticipants.participants.map(u=>this.toParticipant(u));return n?c:c.filter(u=>u.isHost===!1)}toParticipant(n){return new o.Participant(n.id,n.avatar,n.displayName,n.isHost,n.isMuted,n.isUsingTts,n.preferredLanguage,n.voice)}getMuteAllCommand(n){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:n})}getMuteCommand(n,c){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(n,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMute,participantId:n,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:c})}getLockCommand(n){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:n})}getEjectCommand(n){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(n,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.ejectParticipant,participantId:n,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(n){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:n})}getChangeNicknameCommand(n){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(n,"nickname"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.changeNickname,nickname:n,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:n})}getMessageCommand(n){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),r.Contracts.throwIfNullOrWhitespace(n,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:n,type:e.ConversationTranslatorMessageTypes.instantMessage})}}return bt.MeetingImpl=a,bt}var Kn={},Od;function NP(){if(Od)return Kn;Od=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.MeetingTranscriptionCanceledEventArgs=void 0;const e=Yr();class t extends e.CancellationEventArgsBase{}return Kn.MeetingTranscriptionCanceledEventArgs=t,Kn}var Jn={},Md;function xP(){if(Md)return Jn;Md=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.MeetingTranscriber=void 0;const e=k(),t=O(),r=x(),o=T(),i=sa();let a=class{constructor(n){this.privAudioConfig=n,this.privProperties=new o.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return o.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){r.Contracts.throwIfNullOrWhitespace(n,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,n)}joinMeetingAsync(n,c,u){const l=n;r.Contracts.throwIfNullOrUndefined(i.MeetingImpl,"Meeting"),this.privRecognizer=new e.TranscriberRecognizer(n.config,this.privAudioConfig),r.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),(0,t.marshalPromiseToCallbacks)(l.connectTranscriberRecognizer(this.privRecognizer),c,u)}startTranscribingAsync(n,c){this.privRecognizer.startContinuousRecognitionAsync(n,c)}stopTranscribingAsync(n,c){this.privRecognizer.stopContinuousRecognitionAsync(n,c)}leaveMeetingAsync(n,c){this.privRecognizer.disconnectCallbacks(),(0,t.marshalPromiseToCallbacks)((async()=>{})(),n,c)}close(n,c){r.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),n,c)}async dispose(n){this.privDisposedRecognizer||(this.privRecognizer&&(await this.privRecognizer.close(),this.privRecognizer=void 0),n&&(this.privDisposedRecognizer=!0))}};return Jn.MeetingTranscriber=a,Jn}var Gn={},Dd;function zP(){if(Dd)return Gn;Dd=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.ConversationTranscriptionResult=void 0;const e=T();let t=class extends e.RecognitionResult{constructor(o,i,a,s,n,c,u,l,p,d,h){super(o,i,a,s,n,c,u,p,d,h),this.privSpeakerId=l}get speakerId(){return this.privSpeakerId}};return Gn.ConversationTranscriptionResult=t,Gn}var Nd;function sa(){return Nd||(Nd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranscriptionResult=e.MeetingTranscriber=e.MeetingTranscriptionCanceledEventArgs=e.MeetingImpl=e.Meeting=e.ParticipantChangedReason=e.User=e.Participant=e.ConversationTranscriber=e.ConversationTranslator=e.ConversationTranslationResult=e.ConversationTranslationEventArgs=e.ConversationTranslationCanceledEventArgs=e.ConversationParticipantsChangedEventArgs=e.ConversationExpirationEventArgs=e.ConversationCommon=e.ConversationImpl=e.Conversation=void 0;var t=gd();Object.defineProperty(e,"Conversation",{enumerable:!0,get:function(){return t.Conversation}}),Object.defineProperty(e,"ConversationImpl",{enumerable:!0,get:function(){return t.ConversationImpl}});var r=RP();Object.defineProperty(e,"ConversationCommon",{enumerable:!0,get:function(){return r.ConversationCommon}});var o=bP();Object.defineProperty(e,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return o.ConversationExpirationEventArgs}});var i=wP();Object.defineProperty(e,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return i.ConversationParticipantsChangedEventArgs}});var a=EP();Object.defineProperty(e,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return a.ConversationTranslationCanceledEventArgs}});var s=IP();Object.defineProperty(e,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return s.ConversationTranslationEventArgs}});var n=AP();Object.defineProperty(e,"ConversationTranslationResult",{enumerable:!0,get:function(){return n.ConversationTranslationResult}});var c=_P();Object.defineProperty(e,"ConversationTranslator",{enumerable:!0,get:function(){return c.ConversationTranslator}});var u=kP();Object.defineProperty(e,"ConversationTranscriber",{enumerable:!0,get:function(){return u.ConversationTranscriber}});var l=OP();Object.defineProperty(e,"Participant",{enumerable:!0,get:function(){return l.Participant}}),Object.defineProperty(e,"User",{enumerable:!0,get:function(){return l.User}});var p=MP();Object.defineProperty(e,"ParticipantChangedReason",{enumerable:!0,get:function(){return p.ParticipantChangedReason}});var d=DP();Object.defineProperty(e,"Meeting",{enumerable:!0,get:function(){return d.Meeting}}),Object.defineProperty(e,"MeetingImpl",{enumerable:!0,get:function(){return d.MeetingImpl}});var h=NP();Object.defineProperty(e,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return h.MeetingTranscriptionCanceledEventArgs}});var f=xP();Object.defineProperty(e,"MeetingTranscriber",{enumerable:!0,get:function(){return f.MeetingTranscriber}});var g=zP();Object.defineProperty(e,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return g.ConversationTranscriptionResult}})}(ra)),ra}var wt={},xd;function oa(){if(xd)return wt;xd=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.SynthesisRequest=wt.Synthesizer=void 0;const e=k(),t=O(),r=x(),o=T();let i=class Qv{constructor(n){const c=n;r.Contracts.throwIfNull(c,"speechConfig"),this.privProperties=c.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new t.Queue,this.tokenCredential=n.tokenCredential}get authorizationToken(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){r.Contracts.throwIfNullOrWhitespace(n,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,n)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(o.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===e.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(n){const c={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"};let u=this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),l=this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthVoice,""),p=Qv.XMLEncode(n);return this.autoDetectSourceLanguage?u="en-US":l=l||c[u],l&&(p=`<voice name='${l}'>${p}</voice>`),p=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${u}'>${p}</speak>`,p}async dispose(n){this.privDisposed||(n&&this.privAdapter&&await this.privAdapter.dispose(),this.privDisposed=!0)}async adapterSpeak(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const n=await this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(n.text,n.isSSML,n.requestId,n.cb,n.err,n.dataStream)}}createSynthesizerConfig(n){return new e.SynthesizerConfig(n,this.privProperties)}implCommonSynthesizeSetup(){let n=typeof window<"u"?"Browser":"Node",c="unknown",u="unknown";typeof navigator<"u"&&(n=n+"/"+navigator.platform,c=navigator.userAgent,u=navigator.appVersion);const l=this.createSynthesizerConfig(new e.SpeechServiceConfig(new e.Context(new e.OS(n,c,u)))),p=this.privProperties.getProperty(o.PropertyId.SpeechServiceConnection_Key,void 0),d=p&&p!==""?new e.CognitiveSubscriptionKeyAuthentication(p):this.tokenCredential?new e.CognitiveTokenAuthentication(async()=>{try{return(await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default"))?.token??""}catch(h){throw h}},async()=>{try{return(await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default"))?.token??""}catch(h){throw h}}):new e.CognitiveTokenAuthentication(()=>{const h=this.privProperties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(h)},()=>{const h=this.privProperties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(h)});this.privAdapter=this.createSynthesisAdapter(d,this.privConnectionFactory,l),this.privRestAdapter=this.createRestSynthesisAdapter(d,l)}static XMLEncode(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};wt.Synthesizer=i;class a{constructor(n,c,u,l,p,d){this.requestId=n,this.text=c,this.isSSML=u,this.cb=l,this.err=p,this.dataStream=d}}return wt.SynthesisRequest=a,wt}var Qn={},zd;function LP(){if(zd)return Qn;zd=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.SpeechSynthesizer=void 0;const e=k(),t=O(),r=jl(),o=qr(),i=Vt(),a=x(),s=T(),n=oa();let c=class Yv extends s.Synthesizer{constructor(l,p){super(l),p!==null&&(p===void 0?this.audioConfig=typeof window>"u"?void 0:s.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=p),this.privConnectionFactory=new e.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(l,p,d){const h=l;return p.properties.mergeTo(h.properties),new Yv(l,d)}speakTextAsync(l,p,d,h){this.speakImpl(l,!1,p,d,h)}speakSsmlAsync(l,p,d,h){this.speakImpl(l,!0,p,d,h)}async getVoicesAsync(l=""){return this.getVoices(l)}close(l,p){a.Contracts.throwIfDisposed(this.privDisposed),(0,t.marshalPromiseToCallbacks)(this.dispose(!0),l,p)}get internalData(){return this.privAdapter}createSynthesisAdapter(l,p,d){return new e.SpeechSynthesisAdapter(l,p,d,this,this.audioConfig)}createRestSynthesisAdapter(l,p){return new e.SynthesisRestAdapter(p,l)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=o.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(s.SpeechSynthesisOutputFormat[this.properties.getProperty(s.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(l,p,d,h,f){try{a.Contracts.throwIfDisposed(this.privDisposed);const g=(0,t.createNoDashGuid)();let m;f instanceof s.PushAudioOutputStreamCallback?m=new i.PushAudioOutputStreamImpl(f):f instanceof s.PullAudioOutputStream?m=f:f!==void 0?m=new r.AudioFileWriter(f):m=void 0,this.synthesisRequestQueue.enqueue(new n.SynthesisRequest(g,l,p,v=>{if(this.privSynthesizing=!1,d)try{d(v)}catch(y){h&&h(y)}d=void 0,this.adapterSpeak().catch(()=>{})},v=>{h&&h(v)},m)),this.adapterSpeak().catch(()=>{})}catch(g){if(h)if(g instanceof Error){const m=g;h(m.name+": "+m.message)}else h(g);this.dispose(!0).catch(()=>{})}}async getVoices(l){const p=(0,t.createNoDashGuid)(),d=await this.privRestAdapter.getVoicesList(p);if(d.ok&&Array.isArray(d.json)){let h=d.json;return l&&l.length>0&&(h=h.filter(f=>!!f.Locale&&f.Locale.toLowerCase()===l.toLowerCase())),new s.SynthesisVoicesResult(p,h,void 0)}else return new s.SynthesisVoicesResult(p,void 0,`Error: ${d.status}: ${d.statusText}`)}};return Qn.SpeechSynthesizer=c,Qn}var Yn={},Ld;function jP(){if(Ld)return Yn;Ld=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.SynthesisResult=void 0;let e=class{constructor(r,o,i,a){this.privResultId=r,this.privReason=o,this.privErrorDetails=i,this.privProperties=a}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}};return Yn.SynthesisResult=e,Yn}var Zn={},jd;function qP(){if(jd)return Zn;jd=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.SpeechSynthesisResult=void 0;const e=T();let t=class extends e.SynthesisResult{constructor(o,i,a,s,n,c){super(o,i,s,n),this.privAudioData=a,this.privAudioDuration=c}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};return Zn.SpeechSynthesisResult=t,Zn}var Xn={},qd;function FP(){if(qd)return Xn;qd=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.SpeechSynthesisEventArgs=void 0;let e=class{constructor(r){this.privResult=r}get result(){return this.privResult}};return Xn.SpeechSynthesisEventArgs=e,Xn}var ei={},Fd;function BP(){if(Fd)return ei;Fd=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.SpeechSynthesisWordBoundaryEventArgs=void 0;let e=class{constructor(r,o,i,a,s,n){this.privAudioOffset=r,this.privDuration=o,this.privText=i,this.privWordLength=a,this.privTextOffset=s,this.privBoundaryType=n}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}};return ei.SpeechSynthesisWordBoundaryEventArgs=e,ei}var ti={},Bd;function UP(){if(Bd)return ti;Bd=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.SpeechSynthesisBookmarkEventArgs=void 0;let e=class{constructor(r,o){this.privAudioOffset=r,this.privText=o}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}};return ti.SpeechSynthesisBookmarkEventArgs=e,ti}var ri={},Ud;function $P(){if(Ud)return ri;Ud=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.SpeechSynthesisVisemeEventArgs=void 0;let e=class{constructor(r,o,i){this.privAudioOffset=r,this.privVisemeId=o,this.privAnimation=i}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};return ri.SpeechSynthesisVisemeEventArgs=e,ri}var aa={},$d;function VP(){return $d||($d=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisBoundaryType=void 0,function(t){t.Word="WordBoundary",t.Punctuation="PunctuationBoundary",t.Sentence="SentenceBoundary"}(e.SpeechSynthesisBoundaryType||(e.SpeechSynthesisBoundaryType={}))}(aa)),aa}var ni={},Vd;function WP(){if(Vd)return ni;Vd=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.SynthesisVoicesResult=void 0;const e=T();let t=class extends e.SynthesisResult{constructor(o,i,a){if(Array.isArray(i)){super(o,e.ResultReason.VoicesListRetrieved,void 0,new e.PropertyCollection),this.privVoices=[];for(const s of i)this.privVoices.push(new e.VoiceInfo(s))}else super(o,e.ResultReason.Canceled,a||"Error information unavailable",new e.PropertyCollection)}get voices(){return this.privVoices}};return ni.SynthesisVoicesResult=t,ni}var ca={},Wd;function HP(){return Wd||(Wd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceInfo=e.SynthesisVoiceType=e.SynthesisVoiceGender=void 0;var t;(function(s){s[s.Unknown=0]="Unknown",s[s.Female=1]="Female",s[s.Male=2]="Male",s[s.Neutral=3]="Neutral"})(t=e.SynthesisVoiceGender||(e.SynthesisVoiceGender={}));var r;(function(s){s[s.Unknown=0]="Unknown",s[s.OnlineNeural=1]="OnlineNeural",s[s.OnlineStandard=2]="OnlineStandard",s[s.OfflineNeural=3]="OfflineNeural",s[s.OfflineStandard=4]="OfflineStandard",s[s.OnlineNeuralHD=5]="OnlineNeuralHD"})(r=e.SynthesisVoiceType||(e.SynthesisVoiceType={}));const o={[t[t.Neutral]]:t.Neutral,[t[t.Male]]:t.Male,[t[t.Female]]:t.Female},i={Neural:r.OnlineNeural,NeuralHD:r.OnlineNeuralHD};class a{constructor(n){if(this.privStyleList=[],n){if(this.privName=n.Name,this.privLocale=n.Locale,this.privShortName=n.ShortName,this.privLocaleName=n.LocaleName,this.privDisplayName=n.DisplayName,this.privLocalName=n.LocalName,this.privVoiceType=i[n.VoiceType]||r.Unknown,this.privGender=o[n.Gender]||t.Unknown,n.StyleList&&Array.isArray(n.StyleList))for(const c of n.StyleList)this.privStyleList.push(c);this.privSampleRateHertz=n.SampleRateHertz,this.privStatus=n.Status,n.ExtendedPropertyMap&&(this.privExtendedPropertyMap=n.ExtendedPropertyMap),this.privWordsPerMinute=n.WordsPerMinute,Array.isArray(n.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...n.SecondaryLocaleList]),Array.isArray(n.RolePlayList)&&(this.privRolePlayList=[...n.RolePlayList]),n.VoiceTag&&(this.privVoiceTag=n.VoiceTag)}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}get voiceTag(){return this.privVoiceTag}}e.VoiceInfo=a}(ca)),ca}var ii={},Hd;function KP(){if(Hd)return ii;Hd=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.SpeakerAudioDestination=void 0;const e=O(),t=Vt(),r=ht(),o=60*30,i={[r.AudioFormatTag.PCM]:"audio/wav",[r.AudioFormatTag.MuLaw]:"audio/x-wav",[r.AudioFormatTag.MP3]:"audio/mpeg",[r.AudioFormatTag.OGG_OPUS]:"audio/ogg",[r.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[r.AudioFormatTag.ALaw]:"audio/x-wav",[r.AudioFormatTag.FLAC]:"audio/flac",[r.AudioFormatTag.AMR_WB]:"audio/amr-wb",[r.AudioFormatTag.G722]:"audio/G722"};let a=class{constructor(n){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=n||(0,e.createNoDashGuid)(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(n,c,u){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(n),this.updateSourceBuffer().then(()=>{c&&c()},l=>{u&&u(l)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(n),this.privBytesReceived+=n.byteLength)}close(n,c){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{n&&n()},u=>{c&&c(u)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===r.AudioFormatTag.PCM||this.privFormat.formatTag===r.AudioFormatTag.MuLaw||this.privFormat.formatTag===r.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let u=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(u).then(()=>{u=this.privFormat.addHeader(u);const l=new Blob([u],{type:i[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(l),this.notifyPlayback().then(()=>{n&&n()},p=>{c&&c(p)})},l=>{c&&c(l)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(n){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=n;const c=i[this.privFormat.formatTag];c===void 0?console.warn(`Unknown mimeType for format ${r.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(c)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=o,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(c),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(u=>{e.Events.instance.onEvent(new e.BackgroundEvent(u))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(u=>{e.Events.instance.onEvent(new e.BackgroundEvent(u))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(u=>{e.Events.instance.onEvent(new e.BackgroundEvent(u))})):(console.warn(`Format ${r.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new t.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){return this.privAudio?.volume??-1}set volume(n){this.privAudio&&(this.privAudio.volume=n)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(n,c){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{n&&n()},u=>{c&&c(u)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}async updateSourceBuffer(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const n=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(n)}catch{this.privAudioBuffer.unshift(n),console.log("buffer filled, pausing addition of binaries until space is made");return}await this.notifyPlayback()}else this.canEndStream()&&await this.handleSourceBufferUpdateEnd()}async handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),await this.notifyPlayback())}async notifyPlayback(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||await this.privAudio.play())}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}};return ii.SpeakerAudioDestination=a,ii}var si={},Kd;function JP(){if(Kd)return si;Kd=1,Object.defineProperty(si,"__esModule",{value:!0}),si.ConversationTranscriptionCanceledEventArgs=void 0;const e=Yr();let t=class extends e.CancellationEventArgsBase{};return si.ConversationTranscriptionCanceledEventArgs=t,si}var oi={},Jd;function GP(){if(Jd)return oi;Jd=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.MeetingTranscriptionCanceledEventArgs=void 0;const e=Yr();let t=class extends e.CancellationEventArgsBase{};return oi.MeetingTranscriptionCanceledEventArgs=t,oi}var ua={},Gd;function QP(){return Gd||(Gd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PronunciationAssessmentGradingSystem=void 0,function(t){t[t.FivePoint=1]="FivePoint",t[t.HundredMark=2]="HundredMark"}(e.PronunciationAssessmentGradingSystem||(e.PronunciationAssessmentGradingSystem={}))}(ua)),ua}var la={},Qd;function YP(){return Qd||(Qd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PronunciationAssessmentGranularity=void 0,function(t){t[t.Phoneme=1]="Phoneme",t[t.Word=2]="Word",t[t.FullText=3]="FullText"}(e.PronunciationAssessmentGranularity||(e.PronunciationAssessmentGranularity={}))}(la)),la}var ai={},Yd;function ZP(){if(Yd)return ai;Yd=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.PronunciationAssessmentConfig=void 0;const e=x(),t=T();let r=class Zv{constructor(i,a=t.PronunciationAssessmentGradingSystem.FivePoint,s=t.PronunciationAssessmentGranularity.Phoneme,n=!1){e.Contracts.throwIfNullOrUndefined(i,"referenceText"),this.privProperties=new t.PropertyCollection,this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_ReferenceText,i),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_GradingSystem,t.PronunciationAssessmentGradingSystem[a]),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_Granularity,t.PronunciationAssessmentGranularity[s]),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,String(n))}static fromJSON(i){e.Contracts.throwIfNullOrUndefined(i,"json");const a=new Zv("");return a.privProperties=new t.PropertyCollection,a.properties.setProperty(t.PropertyId.PronunciationAssessment_Json,i),a}toJSON(){return this.updateJson(),this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Params)}applyTo(i){this.updateJson();const a=i.internalData;a.expectContentAssessmentResponse=!!this.privContentAssessmentTopic,a.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(t.PropertyId.PronunciationAssessment_Params),this.privContentAssessmentTopic,a.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(t.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(i){e.Contracts.throwIfNullOrWhitespace(i,"referenceText"),this.properties.setProperty(t.PropertyId.PronunciationAssessment_ReferenceText,i)}set phonemeAlphabet(i){e.Contracts.throwIfNullOrWhitespace(i,"phonemeAlphabet"),this.privPhonemeAlphabet=i}set enableMiscue(i){const a=i?"true":"false";this.properties.setProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,a)}get enableMiscue(){return this.properties.getProperty(t.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(i){this.privNBestPhonemeCount=i}set enableProsodyAssessment(i){this.privEnableProsodyAssessment=i}enableContentAssessmentWithTopic(i){this.privContentAssessmentTopic=i}get properties(){return this.privProperties}updateJson(){const i=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Json,"{}"),a=JSON.parse(i),s=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_ReferenceText);s&&(a.referenceText=s);const n=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_GradingSystem);n&&(a.gradingSystem=n);const c=this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_Granularity);c&&(a.granularity=c),this.privPhonemeAlphabet&&(a.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(a.nbestPhonemeCount=this.privNBestPhonemeCount),a.enableProsodyAssessment=this.privEnableProsodyAssessment,a.dimension="Comprehensive",this.privProperties.getProperty(t.PropertyId.PronunciationAssessment_EnableMiscue)&&(a.enableMiscue=this.enableMiscue),this.privProperties.setProperty(t.PropertyId.PronunciationAssessment_Params,JSON.stringify(a))}};return ai.PronunciationAssessmentConfig=r,ai}var Et={},Zd;function XP(){if(Zd)return Et;Zd=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.PronunciationAssessmentResult=Et.ContentAssessmentResult=void 0;const e=x(),t=T();class r{constructor(a){this.privPronJson=a}get grammarScore(){return this.privPronJson.ContentAssessment.GrammarScore}get vocabularyScore(){return this.privPronJson.ContentAssessment.VocabularyScore}get topicScore(){return this.privPronJson.ContentAssessment.TopicScore}}Et.ContentAssessmentResult=r;let o=class Xv{constructor(a){const s=JSON.parse(a);e.Contracts.throwIfNullOrUndefined(s.NBest[0],"NBest"),this.privPronJson=s.NBest[0]}static fromResult(a){e.Contracts.throwIfNullOrUndefined(a,"result");const s=a.properties.getProperty(t.PropertyId.SpeechServiceResponse_JsonResult);return e.Contracts.throwIfNullOrUndefined(s,"json"),new Xv(s)}get detailResult(){return this.privPronJson}get accuracyScore(){return this.detailResult.PronunciationAssessment?.AccuracyScore}get pronunciationScore(){return this.detailResult.PronunciationAssessment?.PronScore}get completenessScore(){return this.detailResult.PronunciationAssessment?.CompletenessScore}get fluencyScore(){return this.detailResult.PronunciationAssessment?.FluencyScore}get prosodyScore(){return this.detailResult.PronunciationAssessment?.ProsodyScore}get contentAssessmentResult(){if(this.detailResult.ContentAssessment!==void 0)return new r(this.detailResult)}};return Et.PronunciationAssessmentResult=o,Et}var ci={},Xd;function eR(){if(Xd)return ci;Xd=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.AvatarConfig=void 0;const e=x(),t=T();let r=class{constructor(i,a,s){this.privCustomized=!1,this.privUseBuiltInVoice=!1,e.Contracts.throwIfNullOrWhitespace(i,"character"),this.character=i,this.style=a,s===void 0&&(s=new t.AvatarVideoFormat),this.videoFormat=s}get customized(){return this.privCustomized}set customized(i){this.privCustomized=i}get useBuiltInVoice(){return this.privUseBuiltInVoice}set useBuiltInVoice(i){this.privUseBuiltInVoice=i}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(i){this.privBackgroundColor=i}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(i){this.privBackgroundImage=i}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(i){this.privRemoteIceServers=i}};return ci.AvatarConfig=r,ci}var pa={},eh;function tR(){return eh||(eh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AvatarEventArgs=e.AvatarEventTypes=void 0,function(r){r.SwitchedToSpeaking="SwitchedToSpeaking",r.SwitchedToIdle="SwitchedToIdle",r.SessionClosed="SessionClosed"}(e.AvatarEventTypes||(e.AvatarEventTypes={}));class t{constructor(o,i){this.privOffset=o,this.privDescription=i}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}}e.AvatarEventArgs=t}(pa)),pa}var ui={},li={},th;function rh(){if(th)return li;th=1,Object.defineProperty(li,"__esModule",{value:!0}),li.SpeechSynthesisConnectionFactory=void 0;const e=ie(),t=T(),r=Ee(),o=k(),i=le(),a=Ge();let s=class{constructor(){this.synthesisUri="/tts/cognitiveservices/websocket/v1"}async create(c,u,l){let p=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const d=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),h=r.ConnectionFactoryBase.getHostSuffix(d),f=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),g=f===void 0?"tts":"voice",m=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+d+"."+g+".speech"+h),v={},y={};if(u.token!==void 0&&u.token!==""&&(y[u.headerName]=u.token),y[i.HeaderNames.ConnectionId]=l,f!==void 0&&f!==""&&(!p||p.search(a.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(v[a.QueryParameterNames.CustomVoiceDeploymentId]=f),c.avatarEnabled&&(!p||p.search(a.QueryParameterNames.EnableAvatar)===-1)&&(v[a.QueryParameterNames.EnableAvatar]="true"),p){const P=new URL(p),b=P.pathname;(b===""||b==="/")&&(P.pathname=this.synthesisUri,p=await r.ConnectionFactoryBase.getRedirectUrlFromEndpoint(P.toString()))}p||(p=m+this.synthesisUri),c.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,p);const S=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(p,v,y,new o.WebsocketMessageFormatter,e.ProxyInfo.fromParameters(c.parameters),S,l)}};return li.SpeechSynthesisConnectionFactory=s,li}var nh;function rR(){if(nh)return ui;nh=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.AvatarSynthesizer=void 0;const e=rh(),t=k(),r=O(),o=qr(),i=T(),a=x(),s=oa();let n=class extends i.Synthesizer{constructor(u,l){super(u),a.Contracts.throwIfNullOrUndefined(l,"avatarConfig"),this.privConnectionFactory=new e.SpeechSynthesisConnectionFactory,this.privAvatarConfig=l,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=o.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(i.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}async startAvatarAsync(u){a.Contracts.throwIfNullOrUndefined(u,"peerConnection"),this.privIceServers=u.getConfiguration().iceServers,a.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");const l=new r.Deferred;u.onicegatheringstatechange=()=>{r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice gathering state: "+u.iceGatheringState,r.EventType.Debug)),u.iceGatheringState==="complete"&&(r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice gathering complete.",r.EventType.Info)),l.resolve())},u.onicecandidate=g=>{g.candidate?r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice candidate: "+g.candidate.candidate,r.EventType.Debug)):(r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice candidate: complete",r.EventType.Debug)),l.resolve())},setTimeout(()=>{u.iceGatheringState!=="complete"&&(r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice gathering timeout.",r.EventType.Warning)),l.resolve())},2e3);const p=await u.createOffer();await u.setLocalDescription(p),await l.promise,r.Events.instance.onEvent(new r.PlatformEvent("peer connection: got local SDP.",r.EventType.Info)),this.privProperties.setProperty(i.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(u.localDescription));const d=await this.speak("",!1);if(d.reason!==i.ResultReason.SynthesizingAudioCompleted)return new i.SynthesisResult(d.resultId,d.reason,d.errorDetails,d.properties);const h=atob(d.properties.getProperty(i.PropertyId.TalkingAvatarService_WebRTC_SDP)),f=new RTCSessionDescription(JSON.parse(h));return await u.setRemoteDescription(f),new i.SynthesisResult(d.resultId,d.reason,void 0,d.properties)}async speakTextAsync(u){const l=await this.speak(u,!1);return new i.SynthesisResult(l.resultId,l.reason,l.errorDetails,l.properties)}async speakSsmlAsync(u){const l=await this.speak(u,!0);return new i.SynthesisResult(l.resultId,l.reason,l.errorDetails,l.properties)}async stopSpeakingAsync(){for(;this.synthesisRequestQueue.length()>0;)(await this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()}async stopAvatarAsync(){return a.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)}async close(){if(!this.privDisposed)return this.dispose(!0)}get iceServers(){return this.privIceServers}createSynthesisAdapter(u,l,p){return new t.AvatarSynthesisAdapter(u,l,p,this,this.privAvatarConfig)}createRestSynthesisAdapter(u,l){}createSynthesizerConfig(u){const l=super.createSynthesizerConfig(u);return l.avatarEnabled=!0,l}async speak(u,l){const p=(0,r.createNoDashGuid)(),d=new r.Deferred;return this.synthesisRequestQueue.enqueue(new s.SynthesisRequest(p,u,l,h=>{d.resolve(h),this.privSynthesizing=!1,this.adapterSpeak()},h=>{d.reject(h),this.privSynthesizing=!1})),this.adapterSpeak(),d.promise}};return ui.AvatarSynthesizer=n,ui}var It={},ih;function nR(){if(ih)return It;ih=1,Object.defineProperty(It,"__esModule",{value:!0}),It.AvatarVideoFormat=It.Coordinate=void 0;class e{constructor(o,i){this.x=o,this.y=i}}It.Coordinate=e;let t=class{constructor(o="H264",i=2e6,a=1920,s=1080){this.codec=o,this.bitrate=i,this.width=a,this.height=s}setCropRange(o,i){this.cropRange={bottomRight:i,topLeft:o}}};return It.AvatarVideoFormat=t,It}var pi={},sh;function iR(){if(sh)return pi;sh=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.AvatarWebRTCConnectionResult=void 0;const e=T();let t=class extends e.SynthesisResult{constructor(o,i,a,s,n){super(i,a,s,n),this.privSDPAnswer=o}get SDPAnswer(){return this.privSDPAnswer}};return pi.AvatarWebRTCConnectionResult=t,pi}var di={},oh;function sR(){if(oh)return di;oh=1,Object.defineProperty(di,"__esModule",{value:!0}),di.Diagnostics=void 0;const e=ie(),t=O();let r=class{static SetLoggingLevel(i){this.privListener=new e.ConsoleLoggingListener(i),t.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(i){if(typeof window>"u")this.privListener&&(this.privListener.logPath=i);else throw new Error("File system logging not available in browser.")}static set onLogOutput(i){this.privListener&&(this.privListener.logCallback=i)}};return di.Diagnostics=r,r.privListener=void 0,di}var ah;function T(){return ah||(ah=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionEventArgs=e.CancellationErrorCode=e.CancellationDetails=e.CancellationDetailsBase=e.IntentRecognitionCanceledEventArgs=e.TranslationRecognitionCanceledEventArgs=e.NoMatchDetails=e.NoMatchReason=e.Translations=e.TranslationRecognizer=e.VoiceProfileType=e.IntentRecognizer=e.SpeechRecognizer=e.Recognizer=e.PropertyId=e.PropertyCollection=e.SpeechTranslationConfigImpl=e.SpeechTranslationConfig=e.SpeechConfigImpl=e.SpeechConfig=e.ResultReason=e.TranslationSynthesisResult=e.TranslationRecognitionResult=e.TranslationSynthesisEventArgs=e.TranslationRecognitionEventArgs=e.SpeechRecognitionCanceledEventArgs=e.MeetingTranscriptionEventArgs=e.ConversationTranscriptionEventArgs=e.SpeechRecognitionEventArgs=e.LanguageUnderstandingModel=e.IntentRecognitionResult=e.SpeechRecognitionResult=e.RecognitionResult=e.IntentRecognitionEventArgs=e.OutputFormat=e.RecognitionEventArgs=e.SessionEventArgs=e.KeywordRecognitionModel=e.PushAudioOutputStreamCallback=e.PullAudioInputStreamCallback=e.CancellationReason=e.PushAudioOutputStream=e.PullAudioOutputStream=e.AudioOutputStream=e.PushAudioInputStream=e.PullAudioInputStream=e.AudioInputStream=e.AudioFormatTag=e.AudioStreamFormat=e.AudioConfig=void 0,e.SpeechSynthesisEventArgs=e.SpeechSynthesisResult=e.SynthesisResult=e.SpeechSynthesizer=e.SpeechSynthesisOutputFormat=e.Synthesizer=e.User=e.ParticipantChangedReason=e.Participant=e.MeetingTranscriber=e.Meeting=e.ConversationTranscriptionResult=e.ConversationTranscriber=e.ConversationTranslator=e.ConversationTranslationResult=e.ConversationTranslationEventArgs=e.ConversationTranslationCanceledEventArgs=e.ConversationParticipantsChangedEventArgs=e.ConversationExpirationEventArgs=e.Conversation=e.SpeakerRecognitionCancellationDetails=e.SpeakerRecognitionResultType=e.SpeakerRecognitionResult=e.SourceLanguageConfig=e.AutoDetectSourceLanguageResult=e.AutoDetectSourceLanguageConfig=e.SpeakerVerificationModel=e.SpeakerIdentificationModel=e.SpeakerRecognizer=e.VoiceProfileClient=e.VoiceProfilePhraseResult=e.VoiceProfileCancellationDetails=e.VoiceProfileResult=e.VoiceProfileEnrollmentCancellationDetails=e.VoiceProfileEnrollmentResult=e.VoiceProfile=e.ConnectionMessage=e.ConnectionMessageEventArgs=e.BaseAudioPlayer=e.ProfanityOption=e.ServicePropertyChannel=e.TurnStatusReceivedEventArgs=e.ActivityReceivedEventArgs=e.DialogServiceConnector=e.CustomCommandsConfig=e.BotFrameworkConfig=e.DialogServiceConfig=e.PhraseListGrammar=e.Connection=e.ServiceEventArgs=void 0,e.LogLevel=e.Diagnostics=e.AvatarWebRTCConnectionResult=e.Coordinate=e.AvatarVideoFormat=e.AvatarSynthesizer=e.AvatarEventArgs=e.AvatarConfig=e.LanguageIdMode=e.PronunciationAssessmentResult=e.PronunciationAssessmentConfig=e.PronunciationAssessmentGranularity=e.PronunciationAssessmentGradingSystem=e.MeetingTranscriptionCanceledEventArgs=e.ConversationTranscriptionCanceledEventArgs=e.SpeakerAudioDestination=e.VoiceInfo=e.SynthesisVoiceType=e.SynthesisVoiceGender=e.SynthesisVoicesResult=e.SpeechSynthesisBoundaryType=e.SpeechSynthesisVisemeEventArgs=e.SpeechSynthesisBookmarkEventArgs=e.SpeechSynthesisWordBoundaryEventArgs=void 0;var t=Hl();Object.defineProperty(e,"AudioConfig",{enumerable:!0,get:function(){return t.AudioConfig}});var r=ht();Object.defineProperty(e,"AudioStreamFormat",{enumerable:!0,get:function(){return r.AudioStreamFormat}}),Object.defineProperty(e,"AudioFormatTag",{enumerable:!0,get:function(){return r.AudioFormatTag}});var o=Fl();Object.defineProperty(e,"AudioInputStream",{enumerable:!0,get:function(){return o.AudioInputStream}}),Object.defineProperty(e,"PullAudioInputStream",{enumerable:!0,get:function(){return o.PullAudioInputStream}}),Object.defineProperty(e,"PushAudioInputStream",{enumerable:!0,get:function(){return o.PushAudioInputStream}});var i=Vt();Object.defineProperty(e,"AudioOutputStream",{enumerable:!0,get:function(){return i.AudioOutputStream}}),Object.defineProperty(e,"PullAudioOutputStream",{enumerable:!0,get:function(){return i.PullAudioOutputStream}}),Object.defineProperty(e,"PushAudioOutputStream",{enumerable:!0,get:function(){return i.PushAudioOutputStream}});var a=yC();Object.defineProperty(e,"CancellationReason",{enumerable:!0,get:function(){return a.CancellationReason}});var s=SC();Object.defineProperty(e,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return s.PullAudioInputStreamCallback}});var n=CC();Object.defineProperty(e,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return n.PushAudioOutputStreamCallback}});var c=PC();Object.defineProperty(e,"KeywordRecognitionModel",{enumerable:!0,get:function(){return c.KeywordRecognitionModel}});var u=RC();Object.defineProperty(e,"SessionEventArgs",{enumerable:!0,get:function(){return u.SessionEventArgs}});var l=bC();Object.defineProperty(e,"RecognitionEventArgs",{enumerable:!0,get:function(){return l.RecognitionEventArgs}});var p=wC();Object.defineProperty(e,"OutputFormat",{enumerable:!0,get:function(){return p.OutputFormat}});var d=EC();Object.defineProperty(e,"IntentRecognitionEventArgs",{enumerable:!0,get:function(){return d.IntentRecognitionEventArgs}});var h=IC();Object.defineProperty(e,"RecognitionResult",{enumerable:!0,get:function(){return h.RecognitionResult}});var f=AC();Object.defineProperty(e,"SpeechRecognitionResult",{enumerable:!0,get:function(){return f.SpeechRecognitionResult}});var g=TC();Object.defineProperty(e,"IntentRecognitionResult",{enumerable:!0,get:function(){return g.IntentRecognitionResult}});var m=_C();Object.defineProperty(e,"LanguageUnderstandingModel",{enumerable:!0,get:function(){return m.LanguageUnderstandingModel}});var v=kC();Object.defineProperty(e,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return v.SpeechRecognitionEventArgs}}),Object.defineProperty(e,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return v.ConversationTranscriptionEventArgs}}),Object.defineProperty(e,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return v.MeetingTranscriptionEventArgs}});var y=OC();Object.defineProperty(e,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return y.SpeechRecognitionCanceledEventArgs}});var S=MC();Object.defineProperty(e,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return S.TranslationRecognitionEventArgs}});var P=DC();Object.defineProperty(e,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return P.TranslationSynthesisEventArgs}});var b=pp();Object.defineProperty(e,"TranslationRecognitionResult",{enumerable:!0,get:function(){return b.TranslationRecognitionResult}});var w=NC();Object.defineProperty(e,"TranslationSynthesisResult",{enumerable:!0,get:function(){return w.TranslationSynthesisResult}});var A=xC();Object.defineProperty(e,"ResultReason",{enumerable:!0,get:function(){return A.ResultReason}});var E=zC();Object.defineProperty(e,"SpeechConfig",{enumerable:!0,get:function(){return E.SpeechConfig}}),Object.defineProperty(e,"SpeechConfigImpl",{enumerable:!0,get:function(){return E.SpeechConfigImpl}});var D=LC();Object.defineProperty(e,"SpeechTranslationConfig",{enumerable:!0,get:function(){return D.SpeechTranslationConfig}}),Object.defineProperty(e,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return D.SpeechTranslationConfigImpl}});var R=mp();Object.defineProperty(e,"PropertyCollection",{enumerable:!0,get:function(){return R.PropertyCollection}});var M=Ho();Object.defineProperty(e,"PropertyId",{enumerable:!0,get:function(){return M.PropertyId}});var _=jC();Object.defineProperty(e,"Recognizer",{enumerable:!0,get:function(){return _.Recognizer}});var z=qC();Object.defineProperty(e,"SpeechRecognizer",{enumerable:!0,get:function(){return z.SpeechRecognizer}});var F=FC();Object.defineProperty(e,"IntentRecognizer",{enumerable:!0,get:function(){return F.IntentRecognizer}});var Q=BC();Object.defineProperty(e,"VoiceProfileType",{enumerable:!0,get:function(){return Q.VoiceProfileType}});var ee=UC();Object.defineProperty(e,"TranslationRecognizer",{enumerable:!0,get:function(){return ee.TranslationRecognizer}});var re=$C();Object.defineProperty(e,"Translations",{enumerable:!0,get:function(){return re.Translations}});var me=VC();Object.defineProperty(e,"NoMatchReason",{enumerable:!0,get:function(){return me.NoMatchReason}});var $=WC();Object.defineProperty(e,"NoMatchDetails",{enumerable:!0,get:function(){return $.NoMatchDetails}});var se=HC();Object.defineProperty(e,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return se.TranslationRecognitionCanceledEventArgs}});var H=KC();Object.defineProperty(e,"IntentRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return H.IntentRecognitionCanceledEventArgs}});var $e=xp();Object.defineProperty(e,"CancellationDetailsBase",{enumerable:!0,get:function(){return $e.CancellationDetailsBase}});var Ot=JC();Object.defineProperty(e,"CancellationDetails",{enumerable:!0,get:function(){return Ot.CancellationDetails}});var Qe=GC();Object.defineProperty(e,"CancellationErrorCode",{enumerable:!0,get:function(){return Qe.CancellationErrorCode}});var Ve=QC();Object.defineProperty(e,"ConnectionEventArgs",{enumerable:!0,get:function(){return Ve.ConnectionEventArgs}});var Mt=YC();Object.defineProperty(e,"ServiceEventArgs",{enumerable:!0,get:function(){return Mt.ServiceEventArgs}});var Jt=Ap();Object.defineProperty(e,"Connection",{enumerable:!0,get:function(){return Jt.Connection}});var Ye=ZC();Object.defineProperty(e,"PhraseListGrammar",{enumerable:!0,get:function(){return Ye.PhraseListGrammar}});var Ne=Yo();Object.defineProperty(e,"DialogServiceConfig",{enumerable:!0,get:function(){return Ne.DialogServiceConfig}});var Dt=XC();Object.defineProperty(e,"BotFrameworkConfig",{enumerable:!0,get:function(){return Dt.BotFrameworkConfig}});var ms=eP();Object.defineProperty(e,"CustomCommandsConfig",{enumerable:!0,get:function(){return ms.CustomCommandsConfig}});var Ze=rP();Object.defineProperty(e,"DialogServiceConnector",{enumerable:!0,get:function(){return Ze.DialogServiceConnector}});var Nt=nP();Object.defineProperty(e,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return Nt.ActivityReceivedEventArgs}});var ye=sP();Object.defineProperty(e,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return ye.TurnStatusReceivedEventArgs}});var xt=oP();Object.defineProperty(e,"ServicePropertyChannel",{enumerable:!0,get:function(){return xt.ServicePropertyChannel}});var Hs=aP();Object.defineProperty(e,"ProfanityOption",{enumerable:!0,get:function(){return Hs.ProfanityOption}});var Ks=cP();Object.defineProperty(e,"BaseAudioPlayer",{enumerable:!0,get:function(){return Ks.BaseAudioPlayer}});var ys=uP();Object.defineProperty(e,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return ys.ConnectionMessageEventArgs}});var Ss=Ep();Object.defineProperty(e,"ConnectionMessage",{enumerable:!0,get:function(){return Ss.ConnectionMessage}});var Te=lP();Object.defineProperty(e,"VoiceProfile",{enumerable:!0,get:function(){return Te.VoiceProfile}});var _e=pP();Object.defineProperty(e,"VoiceProfileEnrollmentResult",{enumerable:!0,get:function(){return _e.VoiceProfileEnrollmentResult}}),Object.defineProperty(e,"VoiceProfileEnrollmentCancellationDetails",{enumerable:!0,get:function(){return _e.VoiceProfileEnrollmentCancellationDetails}});var Pe=dP();Object.defineProperty(e,"VoiceProfileResult",{enumerable:!0,get:function(){return Pe.VoiceProfileResult}}),Object.defineProperty(e,"VoiceProfileCancellationDetails",{enumerable:!0,get:function(){return Pe.VoiceProfileCancellationDetails}});var Xe=hP();Object.defineProperty(e,"VoiceProfilePhraseResult",{enumerable:!0,get:function(){return Xe.VoiceProfilePhraseResult}});var q=fP();Object.defineProperty(e,"VoiceProfileClient",{enumerable:!0,get:function(){return q.VoiceProfileClient}});var te=vP();Object.defineProperty(e,"SpeakerRecognizer",{enumerable:!0,get:function(){return te.SpeakerRecognizer}});var zt=gP();Object.defineProperty(e,"SpeakerIdentificationModel",{enumerable:!0,get:function(){return zt.SpeakerIdentificationModel}});var ne=mP();Object.defineProperty(e,"SpeakerVerificationModel",{enumerable:!0,get:function(){return ne.SpeakerVerificationModel}});var Js=yP();Object.defineProperty(e,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return Js.AutoDetectSourceLanguageConfig}});var et=SP();Object.defineProperty(e,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return et.AutoDetectSourceLanguageResult}});var Ya=CP();Object.defineProperty(e,"SourceLanguageConfig",{enumerable:!0,get:function(){return Ya.SourceLanguageConfig}});var Cs=PP();Object.defineProperty(e,"SpeakerRecognitionResult",{enumerable:!0,get:function(){return Cs.SpeakerRecognitionResult}}),Object.defineProperty(e,"SpeakerRecognitionResultType",{enumerable:!0,get:function(){return Cs.SpeakerRecognitionResultType}}),Object.defineProperty(e,"SpeakerRecognitionCancellationDetails",{enumerable:!0,get:function(){return Cs.SpeakerRecognitionCancellationDetails}});var ue=sa();Object.defineProperty(e,"Conversation",{enumerable:!0,get:function(){return ue.Conversation}}),Object.defineProperty(e,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return ue.ConversationExpirationEventArgs}}),Object.defineProperty(e,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return ue.ConversationParticipantsChangedEventArgs}}),Object.defineProperty(e,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return ue.ConversationTranslationCanceledEventArgs}}),Object.defineProperty(e,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return ue.ConversationTranslationEventArgs}}),Object.defineProperty(e,"ConversationTranslationResult",{enumerable:!0,get:function(){return ue.ConversationTranslationResult}}),Object.defineProperty(e,"ConversationTranslator",{enumerable:!0,get:function(){return ue.ConversationTranslator}}),Object.defineProperty(e,"ConversationTranscriber",{enumerable:!0,get:function(){return ue.ConversationTranscriber}}),Object.defineProperty(e,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return ue.ConversationTranscriptionResult}}),Object.defineProperty(e,"Meeting",{enumerable:!0,get:function(){return ue.Meeting}}),Object.defineProperty(e,"MeetingTranscriber",{enumerable:!0,get:function(){return ue.MeetingTranscriber}}),Object.defineProperty(e,"Participant",{enumerable:!0,get:function(){return ue.Participant}}),Object.defineProperty(e,"ParticipantChangedReason",{enumerable:!0,get:function(){return ue.ParticipantChangedReason}}),Object.defineProperty(e,"User",{enumerable:!0,get:function(){return ue.User}});var Za=oa();Object.defineProperty(e,"Synthesizer",{enumerable:!0,get:function(){return Za.Synthesizer}});var Gs=Ul();Object.defineProperty(e,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return Gs.SpeechSynthesisOutputFormat}});var Qs=LP();Object.defineProperty(e,"SpeechSynthesizer",{enumerable:!0,get:function(){return Qs.SpeechSynthesizer}});var Xa=jP();Object.defineProperty(e,"SynthesisResult",{enumerable:!0,get:function(){return Xa.SynthesisResult}});var Ys=qP();Object.defineProperty(e,"SpeechSynthesisResult",{enumerable:!0,get:function(){return Ys.SpeechSynthesisResult}});var B=FP();Object.defineProperty(e,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return B.SpeechSynthesisEventArgs}});var Z=BP();Object.defineProperty(e,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return Z.SpeechSynthesisWordBoundaryEventArgs}});var U=UP();Object.defineProperty(e,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return U.SpeechSynthesisBookmarkEventArgs}});var V=$P();Object.defineProperty(e,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return V.SpeechSynthesisVisemeEventArgs}});var We=VP();Object.defineProperty(e,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return We.SpeechSynthesisBoundaryType}});var K=WP();Object.defineProperty(e,"SynthesisVoicesResult",{enumerable:!0,get:function(){return K.SynthesisVoicesResult}});var Se=HP();Object.defineProperty(e,"SynthesisVoiceGender",{enumerable:!0,get:function(){return Se.SynthesisVoiceGender}}),Object.defineProperty(e,"SynthesisVoiceType",{enumerable:!0,get:function(){return Se.SynthesisVoiceType}}),Object.defineProperty(e,"VoiceInfo",{enumerable:!0,get:function(){return Se.VoiceInfo}});var Re=KP();Object.defineProperty(e,"SpeakerAudioDestination",{enumerable:!0,get:function(){return Re.SpeakerAudioDestination}});var Ps=JP();Object.defineProperty(e,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return Ps.ConversationTranscriptionCanceledEventArgs}});var ec=GP();Object.defineProperty(e,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return ec.MeetingTranscriptionCanceledEventArgs}});var tc=QP();Object.defineProperty(e,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return tc.PronunciationAssessmentGradingSystem}});var rc=YP();Object.defineProperty(e,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return rc.PronunciationAssessmentGranularity}});var nc=ZP();Object.defineProperty(e,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return nc.PronunciationAssessmentConfig}});var ic=XP();Object.defineProperty(e,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return ic.PronunciationAssessmentResult}});var sc=ld();Object.defineProperty(e,"LanguageIdMode",{enumerable:!0,get:function(){return sc.LanguageIdMode}});var oc=eR();Object.defineProperty(e,"AvatarConfig",{enumerable:!0,get:function(){return oc.AvatarConfig}});var ac=tR();Object.defineProperty(e,"AvatarEventArgs",{enumerable:!0,get:function(){return ac.AvatarEventArgs}});var Ww=rR();Object.defineProperty(e,"AvatarSynthesizer",{enumerable:!0,get:function(){return Ww.AvatarSynthesizer}});var xv=nR();Object.defineProperty(e,"AvatarVideoFormat",{enumerable:!0,get:function(){return xv.AvatarVideoFormat}}),Object.defineProperty(e,"Coordinate",{enumerable:!0,get:function(){return xv.Coordinate}});var Hw=iR();Object.defineProperty(e,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return Hw.AvatarWebRTCConnectionResult}});var Kw=sR();Object.defineProperty(e,"Diagnostics",{enumerable:!0,get:function(){return Kw.Diagnostics}});var Jw=El();Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return Jw.LogLevel}})}(Fo)),Fo}var ch;function oR(){if(ch)return Lr;ch=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.ProxyInfo=void 0;const e=T();let t=class eg{constructor(o,i,a,s){this.privProxyHostName=o,this.privProxyPort=i,this.privProxyUserName=a,this.privProxyPassword=s}static fromParameters(o){return new eg(o.getProperty(e.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(o.getProperty(e.PropertyId.SpeechServiceConnection_ProxyPort),10),o.getProperty(e.PropertyId.SpeechServiceConnection_ProxyUserName),o.getProperty(e.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(o){return this.fromParameters(o.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};return Lr.ProxyInfo=t,Lr}var hi={},da,uh;function aR(){if(uh)return da;uh=1;const e=new Set(["json","buffer","string"]);return da=t=>(...r)=>{const o=new Set;let i,a,s,n="";return r.forEach(c=>{if(typeof c=="string")if(c.toUpperCase()===c)if(i){const u=`Can't set method to ${c}, already set to ${i}.`;throw new Error(u)}else i=c;else if(c.startsWith("http:")||c.startsWith("https:"))n=c;else if(e.has(c))a=c;else throw new Error(`Unknown encoding, ${c}`);else if(typeof c=="number")o.add(c);else if(typeof c=="object")if(Array.isArray(c)||c instanceof Set)c.forEach(u=>o.add(u));else{if(s)throw new Error("Cannot set headers twice.");s=c}else throw new Error(`Unknown type: ${typeof c}`)}),i||(i="GET"),o.size===0&&o.add(200),t(o,i,a,s,n)},da}var ha,lh;function cR(){if(lh)return ha;lh=1;const e=aR();class t extends Error{constructor(i,...a){super(...a),Error.captureStackTrace&&Error.captureStackTrace(this,t),this.name="StatusError",this.message=i.statusMessage,this.statusCode=i.status,this.res=i,this.json=i.json.bind(i),this.text=i.text.bind(i),this.arrayBuffer=i.arrayBuffer.bind(i);let s;Object.defineProperty(this,"responseBody",{get:()=>(s||(s=this.arrayBuffer()),s)}),this.headers={};for(const[c,u]of i.headers.entries())this.headers[c.toLowerCase()]=u}}return ha=e((o,i,a,s,n)=>async(c,u,l={})=>{c=n+(c||"");let p=new URL(c);if(s||(s={}),p.username&&(s.Authorization="Basic "+btoa(p.username+":"+p.password),p=new URL(p.protocol+"//"+p.host+p.pathname+p.search)),p.protocol!=="https:"&&p.protocol!=="http:")throw new Error(`Unknown protocol, ${p.protocol}`);if(u&&!(u instanceof ArrayBuffer||ArrayBuffer.isView(u)||typeof u=="string"))if(typeof u=="object")u=JSON.stringify(u),s["Content-Type"]="application/json";else throw new Error("Unknown body type.");l=new Headers({...s||{},...l});const d=await fetch(p,{method:i,headers:l,body:u});if(d.statusCode=d.status,!o.has(d.status))throw new t(d);return a==="json"?d.json():a==="buffer"?d.arrayBuffer():a==="string"?d.text():d}),ha}var ph;function uR(){return ph||(ph=1,function(e){var t=hi&&hi.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(e,"__esModule",{value:!0}),e.RestMessageAdapter=e.RestRequestType=void 0;const r=t(cR()),o=O();var i;(function(s){s.Get="GET",s.Post="POST",s.Delete="DELETE",s.File="file"})(i=e.RestRequestType||(e.RestRequestType={}));let a=class{constructor(n){if(!n)throw new o.ArgumentNullError("configParams");this.privHeaders=n.headers,this.privIgnoreCache=n.ignoreCache}static extractHeaderValue(n,c){let u="";try{const l=c.trim().split(/[\r\n]+/),p={};l.forEach(d=>{const h=d.split(": "),f=h.shift().toLowerCase(),g=h.join(": ");p[f]=g}),u=p[n.toLowerCase()]}catch{}return u}set options(n){this.privHeaders=n.headers,this.privIgnoreCache=n.ignoreCache}setHeaders(n,c){this.privHeaders[n]=c}request(n,c,u={},l=null){const p=new o.Deferred,d=n===i.File?"POST":n,h=(g,m={})=>{const v=g;return{data:JSON.stringify(m),headers:JSON.stringify(g.headers),json:m,ok:g.statusCode>=200&&g.statusCode<300,status:g.statusCode,statusText:m.error?m.error.message:v.statusText?v.statusText:v.statusMessage}},f=g=>{const m=(0,r.default)(c,d,this.privHeaders,200,201,202,204,400,401,402,403,404),v=this.queryParams(u)===""?"":`?${this.queryParams(u)}`;m(v,g).then(async y=>{if(n===i.Delete||y.statusCode===204)p.resolve(h(y));else try{const S=await y.json();p.resolve(h(y,S))}catch{p.resolve(h(y))}}).catch(y=>{p.reject(y)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),n===i.Post&&l&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),f(l),p.promise}queryParams(n={}){return Object.keys(n).map(c=>encodeURIComponent(c)+"="+encodeURIComponent(n[c])).join("&")}};e.RestMessageAdapter=a}(hi)),hi}var fi={},dh;function hh(){if(dh)return fi;dh=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.RestConfigBase=void 0;let e=class Xs{static get requestOptions(){return Xs.privDefaultRequestOptions}static get configParams(){return Xs.privDefaultParams}static get restErrors(){return Xs.privRestErrors}};return fi.RestConfigBase=e,e.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},e.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},e.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"},fi}var fh;function ie(){return fh||(fh=1,function(e){var t=pt&&pt.__createBinding||(Object.create?function(o,i,a,s){s===void 0&&(s=a),Object.defineProperty(o,s,{enumerable:!0,get:function(){return i[a]}})}:function(o,i,a,s){s===void 0&&(s=a),o[s]=i[a]}),r=pt&&pt.__exportStar||function(o,i){for(var a in o)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&t(i,o,a)};Object.defineProperty(e,"__esModule",{value:!0}),r(pC(),e),r(dC(),e),r(hC(),e),r(fC(),e),r(vC(),e),r(gC(),e),r(Nl(),e),r(mC(),e),r(oR(),e),r(uR(),e),r(hh(),e)}(pt)),pt}var vh;function lR(){if(vh)return Or;vh=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.IntentConnectionFactory=void 0;const e=ie(),t=T(),r=Ee(),o=k(),i=le();let a=class extends r.ConnectionFactoryBase{create(n,c,u){let l=n.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint);if(!l){const f=n.parameters.getProperty(t.PropertyId.SpeechServiceConnection_IntentRegion),g=r.ConnectionFactoryBase.getHostSuffix(f);l=n.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+f+".sr.speech"+g)+"/speech/recognition/interactive/cognitiveservices/v1"}const p={format:"simple",language:n.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(n,p,l);const d={};c.token!==void 0&&c.token!==""&&(d[c.headerName]=c.token),d[i.HeaderNames.ConnectionId]=u,n.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,l);const h=n.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(l,p,d,new o.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(n),h,u))}getSpeechRegionFromIntentRegion(n){switch(n){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return n}}};return Or.IntentConnectionFactory=a,Or}var At={},gh;function pR(){if(gh)return At;gh=1,Object.defineProperty(At,"__esModule",{value:!0}),At.VoiceProfileConnectionFactory=At.SpeakerRecognitionConnectionFactory=void 0;const e=ie(),t=T(),r=Ee(),o=k(),i=le();class a extends r.ConnectionFactoryBase{create(u,l,p,d){let h=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint);if(!h){const v=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region),y=r.ConnectionFactoryBase.getHostSuffix(v),S=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,`wss://${v}.spr-frontend.speech${y}`),P=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_SpeakerIdMode,"TextIndependentIdentification");h=`${S}/speaker/ws/${this.scenarioToPath(P)}/${p}`}const f={format:"simple",language:u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(u,f,h);const g={};l.token!==void 0&&l.token!==""&&(g[l.headerName]=l.token),g[i.HeaderNames.ConnectionId]=d,g[i.HeaderNames.SpIDAuthKey]=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Key),u.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,h);const m=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(h,f,g,new o.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(u),m,d))}scenarioToPath(u){switch(u){case"TextIndependentVerification":case"2":return"verification/text-independent";case"TextDependentVerification":case"1":return"verification/text-dependent";default:return"identification/text-independent"}}}let s=class extends a{create(u,l,p){return super.create(u,l,"recognition",p)}};At.SpeakerRecognitionConnectionFactory=s;class n extends a{create(u,l,p){return super.create(u,l,"profile",p)}}return At.VoiceProfileConnectionFactory=n,At}var fa={},mh;function va(){return mh||(mh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionEndedEvent=e.RecognitionCompletionStatus=e.RecognitionStartedEvent=e.ConnectingToServiceEvent=e.ListeningStartedEvent=e.RecognitionTriggeredEvent=e.SpeechRecognitionEvent=void 0;const t=O();class r extends t.PlatformEvent{constructor(l,p,d,h=t.EventType.Info){super(l,h),this.privRequestId=p,this.privSessionId=d}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}e.SpeechRecognitionEvent=r;class o extends r{constructor(l,p,d,h){super("RecognitionTriggeredEvent",l,p),this.privAudioSourceId=d,this.privAudioNodeId=h}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}e.RecognitionTriggeredEvent=o;class i extends r{constructor(l,p,d,h){super("ListeningStartedEvent",l,p),this.privAudioSourceId=d,this.privAudioNodeId=h}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}e.ListeningStartedEvent=i;class a extends r{constructor(l,p,d){super("ConnectingToServiceEvent",l,d),this.privAuthFetchEventid=p}get authFetchEventid(){return this.privAuthFetchEventid}}e.ConnectingToServiceEvent=a;class s extends r{constructor(l,p,d,h,f){super("RecognitionStartedEvent",l,f),this.privAudioSourceId=p,this.privAudioNodeId=d,this.privAuthFetchEventId=h}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}e.RecognitionStartedEvent=s;var n;(function(u){u[u.Success=0]="Success",u[u.AudioSourceError=1]="AudioSourceError",u[u.AudioSourceTimeout=2]="AudioSourceTimeout",u[u.AuthTokenFetchError=3]="AuthTokenFetchError",u[u.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",u[u.UnAuthorized=5]="UnAuthorized",u[u.ConnectTimeout=6]="ConnectTimeout",u[u.ConnectError=7]="ConnectError",u[u.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",u[u.UnknownError=9]="UnknownError"})(n=e.RecognitionCompletionStatus||(e.RecognitionCompletionStatus={}));class c extends r{constructor(l,p,d,h,f,g,m,v){super("RecognitionEndedEvent",l,f,m===n.Success?t.EventType.Info:t.EventType.Error),this.privAudioSourceId=p,this.privAudioNodeId=d,this.privAuthFetchEventId=h,this.privStatus=m,this.privError=v,this.privServiceTag=g}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}}e.RecognitionEndedEvent=c}(fa)),fa}var vi={},gi={},yh;function Wt(){if(yh)return gi;yh=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.SpeechConnectionMessage=void 0;const e=O(),t=le();class r extends e.ConnectionMessage{constructor(i,a,s,n,c,u,l,p){if(!a)throw new e.ArgumentNullError("path");if(!s)throw new e.ArgumentNullError("requestId");const d={};if(d[t.HeaderNames.Path]=a,d[t.HeaderNames.RequestId]=s,d[t.HeaderNames.RequestTimestamp]=new Date().toISOString(),n&&(d[t.HeaderNames.ContentType]=n),u&&(d[t.HeaderNames.RequestStreamId]=u),l)for(const h in l)h&&(d[h]=l[h]);p?super(i,c,d,p):super(i,c,d),this.privPath=a,this.privRequestId=s,this.privContentType=n,this.privStreamId=u,this.privAdditionalHeaders=l}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(i){let a=null,s=null,n=null,c=null;const u={};if(i.headers)for(const l in i.headers)l&&(l.toLowerCase()===t.HeaderNames.Path.toLowerCase()?a=i.headers[l]:l.toLowerCase()===t.HeaderNames.RequestId.toLowerCase()?s=i.headers[l]:l.toLowerCase()===t.HeaderNames.ContentType.toLowerCase()?n=i.headers[l]:l.toLowerCase()===t.HeaderNames.RequestStreamId.toLowerCase()?c=i.headers[l]:u[l]=i.headers[l]);return new r(i.messageType,a,s,n,i.body,c,u,i.id)}}return gi.SpeechConnectionMessage=r,gi}var ga={},Sh;function dR(){return Sh||(Sh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SegmentationMode=void 0,function(t){t.Normal="Normal",t.Disabled="Disabled",t.Custom="Custom",t.Semantic="Semantic"}(e.SegmentationMode||(e.SegmentationMode={}))}(ga)),ga}var ma={},Ch;function hR(){return Ch||(Ch=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NextAction=void 0,function(t){t.None="None",t.Synthesize="Synthesize"}(e.NextAction||(e.NextAction={}))}(ma)),ma}var ya={},Ph;function fR(){return Ph||(Ph=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Mode=void 0,function(t){t.None="None",t.Always="Always"}(e.Mode||(e.Mode={}))}(ya)),ya}var Sa={},Rh;function vR(){return Rh||(Rh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageIdDetectionPriority=e.LanguageIdDetectionMode=void 0,function(t){t.DetectAtAudioStart="DetectAtAudioStart",t.DetectContinuous="DetectContinuous",t.DetectSegments="DetectSegments"}(e.LanguageIdDetectionMode||(e.LanguageIdDetectionMode={})),function(t){t.Auto="Auto",t.PrioritizeLatency="PrioritizeLatency",t.PrioritizeAccuracy="PrioritizeAccuracy"}(e.LanguageIdDetectionPriority||(e.LanguageIdDetectionPriority={}))}(Sa)),Sa}var Ca={},bh;function gR(){return bh||(bh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NextAction=void 0,function(t){t.Recognize="Recognize",t.None="None"}(e.NextAction||(e.NextAction={}))}(Ca)),Ca}var Pa={},wh;function mR(){return wh||(wh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OnUnknownAction=void 0,function(t){t.RecognizeWithDefaultLanguage="RecognizeWithDefaultLanguage",t.None="None"}(e.OnUnknownAction||(e.OnUnknownAction={}))}(Pa)),Pa}var Ra={},Eh;function yR(){return Eh||(Eh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ResultType=void 0,function(t){t.Auto="Auto",t.StableFragment="StableFragment",t.Hypothesis="Hypothesis",t.None="None"}(e.ResultType||(e.ResultType={}))}(Ra)),Ra}var ba={},Ih;function SR(){return Ih||(Ih=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PhraseResultOutputType=void 0,function(t){t.Always="Always",t.None="None"}(e.PhraseResultOutputType||(e.PhraseResultOutputType={}))}(ba)),ba}var wa={},Ah;function CR(){return Ah||(Ah=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NextAction=void 0,function(t){t.None="None",t.Translate="Translate"}(e.NextAction||(e.NextAction={}))}(wa)),wa}var Th;function PR(){if(Th)return vi;Th=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.ServiceRecognizerBase=void 0;const e=ie(),t=O(),r=T(),o=k(),i=Wt(),a=dR(),s=Ce(),n=hR(),c=fR(),u=vR(),l=gR(),p=mR(),d=yR(),h=SR(),f=CR();let g=class Rs{constructor(v,y,S,P,b){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.recognizeSpeaker=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!v)throw new t.ArgumentNullError("authentication");if(!y)throw new t.ArgumentNullError("connectionFactory");if(!S)throw new t.ArgumentNullError("audioSource");if(!P)throw new t.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=P.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=v,this.privConnectionFactory=y,this.privAudioSource=S,this.privRecognizerConfig=P,this.privIsDisposed=!1,this.privRecognizer=b,this.privRequestSession=new o.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new t.EventSource,this.privServiceEvents=new t.EventSource,this.privDynamicGrammar=new o.DynamicGrammarBuilder,this.privSpeechContext=new o.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new o.AgentConfig,this.privRecognizerConfig.parameters.getProperty(r.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=t.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(A=>{if(A.name==="ConnectionClosedEvent"){const E=A;(E.statusCode===1003||E.statusCode===1007||E.statusCode===1002||E.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(r.CancellationReason.Error,E.statusCode===1007?r.CancellationErrorCode.BadRequestParameters:r.CancellationErrorCode.ConnectionFailure,`${E.reason} websocket error code: ${E.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=(0,t.createNoDashGuid)())}setTranslationJson(){const v=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(v!==void 0){const y=v.split(","),S=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),P=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationCategoryId,void 0),b=S!==void 0?n.NextAction.Synthesize:n.NextAction.None;if(this.privSpeechContext.getContext().translation={onPassthrough:{action:b},onSuccess:{action:b},output:{includePassThroughResults:!0,interimResults:{mode:c.Mode.Always}},targetLanguages:y},P!==void 0&&(this.privSpeechContext.getContext().translation.category=P),S!==void 0){const A={};for(const E of y)A[E]=S;this.privSpeechContext.getContext().synthesis={defaultVoices:A}}const w=this.privSpeechContext.getContext().phraseDetection||{};w.onSuccess={action:f.NextAction.Translate},w.onInterim={action:f.NextAction.Translate},this.privSpeechContext.getContext().phraseDetection=w}}setSpeechSegmentationTimeoutJson(){const v=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0),y=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_SegmentationMaximumTimeMs,void 0),S=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_SegmentationStrategy,void 0),P={mode:a.SegmentationMode.Normal};let b=!1;if(S!==void 0){b=!0;let w=a.SegmentationMode.Normal;switch(S.toLowerCase()){case"default":break;case"time":w=a.SegmentationMode.Custom;break;case"semantic":w=a.SegmentationMode.Semantic;break}P.mode=w}if(v!==void 0){b=!0;const w=parseInt(v,10);P.mode=a.SegmentationMode.Custom,P.segmentationSilenceTimeoutMs=w}if(y!==void 0){b=!0;const w=parseInt(y,10);P.mode=a.SegmentationMode.Custom,P.segmentationForcedTimeoutMs=w}if(b){const w=this.privSpeechContext.getContext().phraseDetection||{};switch(w.mode=this.recognitionMode,this.recognitionMode){case s.RecognitionMode.Conversation:w.conversation=w.conversation??{segmentation:{}},w.conversation.segmentation=P;break;case s.RecognitionMode.Interactive:w.interactive=w.interactive??{segmentation:{}},w.interactive.segmentation=P;break;case s.RecognitionMode.Dictation:w.dictation=w.dictation??{},w.dictation.segmentation=P;break}this.privSpeechContext.getContext().phraseDetection=w}}setLanguageIdJson(){const v=this.privSpeechContext.getContext().phraseDetection||{};if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){const y=this.privRecognizerConfig.autoDetectSourceLanguages.split(",");y.length===1&&y[0]===o.AutoDetectSourceLanguagesOpenRangeOptionName&&(y[0]="UND");let S;this.privRecognizerConfig.languageIdMode==="Continuous"?S=u.LanguageIdDetectionMode.DetectContinuous:S=u.LanguageIdDetectionMode.DetectAtAudioStart,this.privSpeechContext.getContext().languageId={languages:y,mode:S,onSuccess:{action:l.NextAction.Recognize},onUnknown:{action:p.OnUnknownAction.None},priority:u.LanguageIdDetectionPriority.PrioritizeLatency},this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:d.ResultType.Auto},phraseResults:{resultType:h.PhraseResultOutputType.Always}};const P=this.privRecognizerConfig.sourceLanguageModels;P!==void 0&&(v.customModels=P,v.onInterim={action:f.NextAction.None},v.onSuccess={action:f.NextAction.None})}this.privSpeechContext.getContext().phraseDetection=v}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(o.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple]).toLowerCase()===r.OutputFormat[r.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(v){this.privRecognizerConfig.parameters.setProperty(r.PropertyId.ConversationTranslator_Token,v)}set voiceProfileType(v){this.privRecognizerConfig.parameters.setProperty(r.PropertyId.SpeechServiceConnection_SpeakerIdMode,v)}set authentication(v){this.privAuthentication=v}isDisposed(){return this.privIsDisposed}async dispose(v){if(this.privIsDisposed=!0,this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose(v)}catch{return}}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}async recognize(v,y,S){if(this.recognizeOverride!==void 0){await this.recognizeOverride(v,y,S);return}if(this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=v,this.privRecognizerConfig.recognitionEndpointVersion==="2"){const E=this.privSpeechContext.getContext().phraseDetection||{};E.mode=v,this.privSpeechContext.getContext().phraseDetection=E}this.setLanguageIdJson(),this.setTranslationJson(),this.privRecognizerConfig.autoDetectSourceLanguages!==void 0&&this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&this.setupTranslationWithLanguageId(),this.setSpeechSegmentationTimeoutJson(),this.setOutputDetailLevelJson(),this.privSuccessCallback=y,this.privErrorCallback=S,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const P=this.connectImpl();let b;try{const E=await this.audioSource.attach(this.privRequestSession.audioNodeId),D=await this.audioSource.format,R=await this.audioSource.deviceInfo;this.privIsLiveAudio=R.type&&R.type===o.type.Microphones,b=new e.ReplayableAudioNode(E,D.avgBytesPerSec),await this.privRequestSession.onAudioSourceAttachCompleted(b,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:R}}catch(E){throw await this.privRequestSession.onStopRecognizing(),E}try{await P}catch(E){await this.cancelRecognitionLocal(r.CancellationReason.Error,r.CancellationErrorCode.ConnectionFailure,E);return}const w=new r.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,w),this.receiveMessage(),this.sendAudio(b).catch(async E=>{await this.cancelRecognitionLocal(r.CancellationReason.Error,r.CancellationErrorCode.RuntimeError,E)})}async stopRecognizing(){if(this.privRequestSession.isRecognizing)try{await this.audioSource.turnOff(),await this.sendFinalAudio(),await this.privRequestSession.onStopRecognizing(),await this.privRequestSession.turnCompletionPromise}finally{await this.privRequestSession.dispose()}}async connect(){return await this.connectImpl(),Promise.resolve()}connectAsync(v,y){this.connectImpl().then(()=>{try{v&&v()}catch(S){y&&y(S)}},S=>{try{y&&y(S)}catch{}})}async disconnect(){if(await this.cancelRecognitionLocal(r.CancellationReason.Error,r.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&await this.disconnectOverride(),this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0}sendMessage(v){}async sendNetworkMessage(v,y){const S=typeof y=="string"?t.MessageType.Text:t.MessageType.Binary,P=typeof y=="string"?"application/json":"";return(await this.fetchConnection()).send(new i.SpeechConnectionMessage(S,v,this.privRequestSession.requestId,P,y))}set activityTemplate(v){this.privActivityTemplate=v}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(v){this.privExpectContentAssessmentResponse=v}async sendTelemetryData(){const v=this.privRequestSession.getTelemetry();if(Rs.telemetryDataEnabled!==!0||this.privIsDisposed||v===null)return;if(Rs.telemetryData)try{Rs.telemetryData(v)}catch{}await(await this.fetchConnection()).send(new i.SpeechConnectionMessage(t.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",v))}async cancelRecognitionLocal(v,y,S){this.privRequestSession.isRecognizing&&(await this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,v,y,S))}async receiveMessage(){try{if(this.privIsDisposed)return;let v=await this.fetchConnection();const y=await v.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!y)return this.receiveMessage();this.privServiceHasSentMessage=!0;const S=i.SpeechConnectionMessage.fromConnectionMessage(y);if(S.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(S.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const P=o.SpeechDetected.fromJSON(S.textBody,this.privRequestSession.currentTurnAudioOffset),b=new r.RecognitionEventArgs(P.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,b);break;case"speech.enddetected":let w;S.textBody.length>0?w=S.textBody:w="{ Offset: 0 }";const A=o.SpeechDetected.fromJSON(w,this.privRequestSession.currentTurnAudioOffset),E=new r.RecognitionEventArgs(A.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,E);break;case"turn.end":await this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,await this.cancelRecognitionLocal(r.CancellationReason.EndOfStream,r.CancellationErrorCode.NoError,void 0));const D=new r.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,D);return}else v=await this.fetchConnection(),await this.sendPrePayloadJSON(v);break;default:await this.processTypeSpecificMessages(S)||this.privServiceEvents&&this.serviceEvents.onEvent(new t.ServiceEvent(S.path.toLowerCase(),S.textBody))}return this.receiveMessage()}catch{return null}}updateSpeakerDiarizationAudioOffset(){const v=this.privRequestSession.recognitionBytesSent,y=this.privAverageBytesPerMs!==0?v/this.privAverageBytesPerMs:0;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(y)}sendSpeechContext(v,y){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();const S=this.speechContext.toJSON();if(y&&this.privRequestSession.onSpeechContext(),S)return v.send(new i.SpeechConnectionMessage(t.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",S))}setupTranslationWithLanguageId(){const v=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0),y=this.privRecognizerConfig.autoDetectSourceLanguages!==void 0;if(v!==void 0&&y){this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:d.ResultType.None},phraseResults:{resultType:h.PhraseResultOutputType.None}};const S=this.privSpeechContext.getContext().translation;if(S){const P=this.privRecognizerConfig.sourceLanguageModels;if(P!==void 0&&P.length>0){const w=this.privSpeechContext.getContext().phraseDetection||{};w.customModels=P,this.privSpeechContext.getContext().phraseDetection=w}this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&(S.onSuccess={action:n.NextAction.Synthesize},S.onPassthrough={action:n.NextAction.Synthesize})}}}noOp(){}async sendPrePayloadJSON(v,y=!0){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(v);await this.sendSpeechContext(v,y),await this.sendWaveHeader(v)}async sendWaveHeader(v){const y=await this.audioSource.format;return v.send(new i.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",y.header))}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(v=>v.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(v,y,S){if(y.onSpeechContext(),Rs.telemetryDataEnabled!==!0){const b={context:{system:JSON.parse(S).context.system}};S=JSON.stringify(b)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){const P=JSON.parse(S);P.context.DisableReferenceChannel="True",P.context.MicSpec="1_0_0",S=JSON.stringify(P)}if(S)return v.send(new i.SpeechConnectionMessage(t.MessageType.Text,"speech.config",y.requestId,"application/json",S))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(v=>v.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async sendAudio(v){const y=await this.audioSource.format;this.privAverageBytesPerMs=y.avgBytesPerSec/1e3;let S=Date.now();const P=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),b=y.avgBytesPerSec/1e3*parseInt(P,10),w=this.privRequestSession.recogNumber,A=async()=>{if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===w){const E=await this.fetchConnection(),D=await v.read();if(this.privRequestSession.isSpeechEnded)return;let R,M;if(!D||D.isEnd?(R=null,M=0):(R=D.buffer,this.privRequestSession.onAudioSent(R.byteLength),b>=this.privRequestSession.bytesSent?M=0:M=Math.max(0,S-Date.now())),M!==0&&await this.delay(M),R!==null&&(S=Date.now()+R.byteLength*1e3/(y.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===w)if(E.send(new i.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,null,R)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),D?.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return A()}};return A()}async retryableConnect(){let v=!1;this.privAuthFetchEventId=(0,t.createNoDashGuid)();const y=this.privRequestSession.sessionId;this.privConnectionId=y!==void 0?y:(0,t.createNoDashGuid)(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let S=0,P="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){this.privRequestSession.onRetryConnection();const w=await(v?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId));await this.privRequestSession.onAuthCompleted(!1);const A=await this.privConnectionFactory.create(this.privRecognizerConfig,w,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(A.events),A.events.attach(D=>{this.connectionEvents.onEvent(D)});const E=await A.open();if(E.statusCode===200)return await this.privRequestSession.onConnectionEstablishCompleted(E.statusCode),Promise.resolve(A);E.statusCode===1006&&(v=!0),S=E.statusCode,P=E.reason}return await this.privRequestSession.onConnectionEstablishCompleted(S,P),Promise.reject(`Unable to contact server. StatusCode: ${S}, ${this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${P}`)}delay(v){return new Promise(y=>this.privSetTimeout(y,v))}writeBufferToConsole(v){let y="Buffer Size: ";if(v===null)y+="null";else{const S=new Uint8Array(v);y+=`${v.byteLength}\r
`;for(let P=0;P<v.byteLength;P++)y+=S[P].toString(16).padStart(2,"0")+" ",(P+1)%16===0&&(console.info(y),y="")}console.info(y)}async sendFinalAudio(){await(await this.fetchConnection()).send(new i.SpeechConnectionMessage(t.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))}async configureConnection(){const v=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(v):(await this.sendSpeechServiceConfig(v,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendPrePayloadJSON(v,!1),v)}};return vi.ServiceRecognizerBase=g,g.telemetryDataEnabled=!0,vi}var mi={},_h;function RR(){if(_h)return mi;_h=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.ConversationServiceRecognizer=void 0;const e=T(),t=k();let r=class extends t.ServiceRecognizerBase{constructor(i,a,s,n,c){super(i,a,s,n,c),this.handleSpeechPhraseMessage=async u=>this.handleSpeechPhrase(u),this.handleSpeechHypothesisMessage=u=>this.handleSpeechHypothesis(u)}processTypeSpecificMessages(i){}handleRecognizedCallback(i,a,s){}handleRecognizingCallback(i,a,s){}async processSpeechMessages(i){let a=!1;switch(i.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(i.textBody),a=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&await this.handleSpeechPhraseMessage(i.textBody),a=!0;break}return a}cancelRecognition(i,a,s,n,c){}async handleSpeechPhrase(i){const a=t.SimpleSpeechPhrase.fromJSON(i,this.privRequestSession.currentTurnAudioOffset),s=t.EnumTranslation.implTranslateRecognitionResult(a.RecognitionStatus);let n;const c=new e.PropertyCollection;if(c.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,i),this.privRequestSession.onPhraseRecognized(a.Offset+a.Duration),e.ResultReason.Canceled===s){const u=t.EnumTranslation.implTranslateCancelResult(a.RecognitionStatus),l=t.EnumTranslation.implTranslateCancelErrorCode(a.RecognitionStatus);await this.cancelRecognitionLocal(u,l,t.EnumTranslation.implTranslateErrorDetails(l))}else if(a.RecognitionStatus!==t.RecognitionStatus.EndOfDictation){if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===e.OutputFormat[e.OutputFormat.Simple])n=new e.SpeechRecognitionResult(this.privRequestSession.requestId,s,a.DisplayText,a.Duration,a.Offset,a.Language,a.LanguageDetectionConfidence,a.SpeakerId,void 0,a.asJson(),c);else{const u=t.DetailedSpeechPhrase.fromJSON(i,this.privRequestSession.currentTurnAudioOffset);n=new e.SpeechRecognitionResult(this.privRequestSession.requestId,s,u.Text,u.Duration,u.Offset,u.Language,u.LanguageDetectionConfidence,u.SpeakerId,void 0,u.asJson(),c)}this.handleRecognizedCallback(n,n.offset,this.privRequestSession.sessionId)}}handleSpeechHypothesis(i){const a=t.SpeechHypothesis.fromJSON(i,this.privRequestSession.currentTurnAudioOffset),s=new e.PropertyCollection;s.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,i);const n=new e.SpeechRecognitionResult(this.privRequestSession.requestId,e.ResultReason.RecognizingSpeech,a.Text,a.Duration,a.Offset,a.Language,a.LanguageDetectionConfidence,a.SpeakerId,void 0,a.asJson(),s);this.privRequestSession.onHypothesis(a.Offset),this.handleRecognizingCallback(n,a.Duration,this.privRequestSession.sessionId)}};return mi.ConversationServiceRecognizer=r,mi}var Ea={},kh;function bR(){return kh||(kh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognizerConfig=e.SpeechResultFormat=void 0;const t=T(),r=k(),o=Ce();(function(a){a[a.Simple=0]="Simple",a[a.Detailed=1]="Detailed"})(e.SpeechResultFormat||(e.SpeechResultFormat={}));class i{constructor(s,n){this.privSpeechServiceConfig=s||new r.SpeechServiceConfig(new r.Context(null)),this.privParameters=n,this.privMaxRetryCount=parseInt(n.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=n.getProperty(t.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(s){this.privRecognitionMode=s,this.privRecognitionActivityTimeout=s===o.RecognitionMode.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=o.RecognitionMode[s]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==o.RecognitionMode.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(t.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2")}set recognitionEndpointVersion(s){this.parameters.setProperty(t.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,s)}get sourceLanguageModels(){const s=[];let n=!1;if(this.autoDetectSourceLanguages!==void 0)for(const c of this.autoDetectSourceLanguages.split(",")){const u=c+t.PropertyId.SpeechServiceConnection_EndpointId.toString(),l=this.parameters.getProperty(u,void 0);l!==void 0?(s.push({language:c,endpoint:l}),n=!0):s.push({language:c,endpoint:""})}return n?s:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(s){this.privEnableSpeakerId=s}}e.RecognizerConfig=i}(Ea)),Ea}var Ia={},Oh;function wR(){return Oh||(Oh=1,Object.defineProperty(Ia,"__esModule",{value:!0})),Ia}var yi={},Mh;function ER(){if(Mh)return yi;Mh=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.WebsocketMessageFormatter=void 0;const e=O(),t=`\r
`;let r=class{toConnectionMessage(i){const a=new e.Deferred;try{if(i.messageType===e.MessageType.Text){const s=i.textContent;let n={},c=null;if(s){const u=s.split(`\r
\r
`);u&&u.length>0&&(n=this.parseHeaders(u[0]),u.length>1&&(c=u[1]))}a.resolve(new e.ConnectionMessage(i.messageType,c,n,i.id))}else if(i.messageType===e.MessageType.Binary){const s=i.binaryContent;let n={},c=null;if(!s||s.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const u=new DataView(s),l=u.getInt16(0);if(s.byteLength<l+2)throw new Error("Invalid binary message format. Header content missing.");let p="";for(let d=0;d<l;d++)p+=String.fromCharCode(u.getInt8(d+2));n=this.parseHeaders(p),s.byteLength>l+2&&(c=s.slice(2+l)),a.resolve(new e.ConnectionMessage(i.messageType,c,n,i.id))}}catch(s){a.reject(`Error formatting the message. Error: ${s}`)}return a.promise}fromConnectionMessage(i){const a=new e.Deferred;try{if(i.messageType===e.MessageType.Text){const s=`${this.makeHeaders(i)}${t}${i.textBody?i.textBody:""}`;a.resolve(new e.RawWebsocketMessage(e.MessageType.Text,s,i.id))}else if(i.messageType===e.MessageType.Binary){const s=this.makeHeaders(i),n=i.binaryBody,c=this.stringToArrayBuffer(s),u=new Int8Array(c),l=u.byteLength,p=new Int8Array(2+l+(n?n.byteLength:0));if(p[0]=l>>8&255,p[1]=l&255,p.set(u,2),n){const h=new Int8Array(n);p.set(h,2+l)}const d=p.buffer;a.resolve(new e.RawWebsocketMessage(e.MessageType.Binary,d,i.id))}}catch(s){a.reject(`Error formatting the message. ${s}`)}return a.promise}makeHeaders(i){let a="";if(i.headers)for(const s in i.headers)s&&(a+=`${s}: ${i.headers[s]}${t}`);return a}parseHeaders(i){const a={};if(i){const s=i.match(/[^\r\n]+/g);if(a){for(const n of s)if(n){const c=n.indexOf(":"),u=c>0?n.substr(0,c).trim().toLowerCase():n,l=c>0&&n.length>c+1?n.substr(c+1).trim():"";a[u]=l}}}return a}stringToArrayBuffer(i){const a=new ArrayBuffer(i.length),s=new DataView(a);for(let n=0;n<i.length;n++)s.setUint8(n,i.charCodeAt(n));return a}};return yi.WebsocketMessageFormatter=r,yi}var Si={},Dh;function IR(){if(Dh)return Si;Dh=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.SpeechConnectionFactory=void 0;const e=ie(),t=k(),r=T(),o=Ee(),i=k(),a=le(),s=Ge(),n=Ce();let c=class extends o.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/stt/speech/universal/v"}async create(l,p,d){let h=l.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);const f=l.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region,void 0),g=o.ConnectionFactoryBase.getHostSuffix(f),m=l.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://"+f+".stt.speech"+g),v={},y=l.parameters.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId,void 0),S=l.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(y?(!h||h.search(s.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(v[s.QueryParameterNames.CustomSpeechDeploymentId]=y):S&&(!h||h.search(s.QueryParameterNames.Language)===-1)&&(v[s.QueryParameterNames.Language]=S),(!h||h.search(s.QueryParameterNames.Format)===-1)&&(v[s.QueryParameterNames.Format]=l.parameters.getProperty(t.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple]).toLowerCase()),l.autoDetectSourceLanguages!==void 0&&(v[s.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(l,v,h),h){const E=new URL(h),D=E.pathname;(D===""||D==="/")&&(E.pathname=this.universalUri+l.recognitionEndpointVersion,h=await o.ConnectionFactoryBase.getRedirectUrlFromEndpoint(E.toString()))}if(!h)switch(l.recognitionMode){case n.RecognitionMode.Conversation:l.parameters.getProperty(t.ForceDictationPropertyName,"false")==="true"?h=m+this.dictationRelativeUri:l.recognitionEndpointVersion!==void 0&&parseInt(l.recognitionEndpointVersion,10)>1?h=`${m}${this.universalUri}${l.recognitionEndpointVersion}`:h=m+this.conversationRelativeUri;break;case n.RecognitionMode.Dictation:h=m+this.dictationRelativeUri;break;default:l.recognitionEndpointVersion!==void 0&&parseInt(l.recognitionEndpointVersion,10)>1?h=`${m}${this.universalUri}${l.recognitionEndpointVersion}`:h=m+this.interactiveRelativeUri;break}const P={};p.token!==void 0&&p.token!==""&&(P[p.headerName]=p.token),P[a.HeaderNames.ConnectionId]=d,P.connectionId=d;const b=l.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",w=new e.WebsocketConnection(h,v,P,new i.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(l),b,d),A=w.uri;return l.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,A),w}};return Si.SpeechConnectionFactory=c,Si}var Ci={},Nh;function AR(){if(Nh)return Ci;Nh=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.ConversationTranscriberConnectionFactory=void 0;const e=ie(),t=T(),r=k(),o=Ee(),i=k(),a=le(),s=Ge();let n=class extends o.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2"}async create(u,l,p){let d=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const h=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,void 0),f=o.ConnectionFactoryBase.getHostSuffix(h),g=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,"wss://"+h+".stt.speech"+f),m={},v=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),y=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(v?(!d||d.search(s.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(m[s.QueryParameterNames.CustomSpeechDeploymentId]=v):y&&(!d||d.search(s.QueryParameterNames.Language)===-1)&&(m[s.QueryParameterNames.Language]=y),u.autoDetectSourceLanguages!==void 0&&(m[s.QueryParameterNames.EnableLanguageId]="true"),this.setV2UrlParams(u,m,d),d){const A=new URL(d),E=A.pathname;(E===""||E==="/")&&(A.pathname=this.universalUri,d=await o.ConnectionFactoryBase.getRedirectUrlFromEndpoint(A.toString()))}d||(d=`${g}${this.universalUri}`);const S={};l.token!==void 0&&l.token!==""&&(S[l.headerName]=l.token),S[a.HeaderNames.ConnectionId]=p;const P=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",b=new e.WebsocketConnection(d,m,S,new i.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(u),P,p),w=b.uri;return u.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,w),b}setV2UrlParams(u,l,p){new Map([[t.PropertyId.Speech_SegmentationSilenceTimeoutMs,s.QueryParameterNames.SegmentationSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_EnableAudioLogging,s.QueryParameterNames.EnableAudioLogging],[t.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,s.QueryParameterNames.EndSilenceTimeoutMs],[t.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,s.QueryParameterNames.InitialSilenceTimeoutMs],[t.PropertyId.SpeechServiceResponse_PostProcessingOption,s.QueryParameterNames.Postprocessing],[t.PropertyId.SpeechServiceResponse_ProfanityOption,s.QueryParameterNames.Profanity],[t.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,s.QueryParameterNames.StableIntermediateThreshold]]).forEach((f,g)=>{this.setUrlParameter(g,f,u,l,p)});const h=JSON.parse(u.parameters.getProperty(r.ServicePropertiesPropertyName,"{}"));Object.keys(h).forEach(f=>{l[f]=h[f]})}};return Ci.ConversationTranscriberConnectionFactory=n,Ci}var Pi={},xh;function TR(){if(xh)return Pi;xh=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.TranscriberConnectionFactory=void 0;const e=ie(),t=T(),r=Ee(),o=k(),i=le(),a=Ge();let s=class extends r.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(c,u,l){let p=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);const d=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,"centralus"),h=r.ConnectionFactoryBase.getHostSuffix(d),f="wss://transcribe."+d+".cts.speech"+h+this.multiaudioRelativeUri,g=c.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,f),m={};this.setQueryParams(m,c,p),p||(p=g);const v={};u.token!==void 0&&u.token!==""&&(v[u.headerName]=u.token),v[i.HeaderNames.ConnectionId]=l,c.parameters.setProperty(t.PropertyId.SpeechServiceConnection_Url,p);const y=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(p,m,v,new o.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(c),y,l))}setQueryParams(c,u,l){const p=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_EndpointId,void 0),d=u.parameters.getProperty(t.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);p&&!(a.QueryParameterNames.CustomSpeechDeploymentId in c)&&(c[a.QueryParameterNames.CustomSpeechDeploymentId]=p),d&&!(a.QueryParameterNames.Language in c)&&(c[a.QueryParameterNames.Language]=d);const h=u.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",f=u.parameters.getProperty(o.OutputFormatPropertyName,t.OutputFormat[t.OutputFormat.Simple])!==t.OutputFormat[t.OutputFormat.Simple];(h||f)&&(c[a.QueryParameterNames.Format]=t.OutputFormat[t.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(u,c,l)}};return Pi.TranscriberConnectionFactory=s,Pi}var Ri={},zh;function _R(){if(zh)return Ri;zh=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.TranslationConnectionFactory=void 0;const e=ie(),t=wd(),r=T(),o=Ee(),i=k(),a=le(),s=Ge(),n=Ce();let c=class extends o.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.translationV1Uri="/speech/translation/cognitiveservices/v1"}async create(l,p,d){let h=this.getEndpointUrl(l);const f={};if(this.setQueryParams(f,l,h),h){const y=new URL(h),S=y.pathname;(S===""||S==="/")&&(y.pathname=this.universalUri,h=await o.ConnectionFactoryBase.getRedirectUrlFromEndpoint(y.toString()))}const g={};p.token!==void 0&&p.token!==""&&(g[p.headerName]=p.token),g[a.HeaderNames.ConnectionId]=d,l.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,h);const m=l.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(h,f,g,new i.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(l),m,d)}getEndpointUrl(l,p){const d=l.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region),h=o.ConnectionFactoryBase.getHostSuffix(d);let f=l.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);return f?p===!0?f:t.StringUtils.formatString(f,{region:d}):(l.parameters.getProperty("SPEECH-ForceV1Endpoint","false")==="true"?f=l.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+h)+this.translationV1Uri:f=l.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+h)+this.universalUri,p===!0?f:t.StringUtils.formatString(f,{region:d}))}setQueryParams(l,p,d){l.from=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage),l.to=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages),l.scenario=p.recognitionMode===n.RecognitionMode.Interactive?"interactive":p.recognitionMode===n.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(p,l,d),this.setUrlParameter(r.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,s.QueryParameterNames.StableTranslation,p,l,d);const h=p.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);h!==void 0&&(l.voice=h,l.features="requireVoice")}};return Ri.TranslationConnectionFactory=c,Ri}var bi={},Lh;function kR(){if(Lh)return bi;Lh=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.EnumTranslation=void 0;const e=T(),t=k();let r=class{static implTranslateRecognitionResult(i,a=!1){let s=e.ResultReason.Canceled;switch(i){case t.RecognitionStatus.Success:s=e.ResultReason.RecognizedSpeech;break;case t.RecognitionStatus.EndOfDictation:s=a?e.ResultReason.RecognizedSpeech:e.ResultReason.NoMatch;break;case t.RecognitionStatus.NoMatch:case t.RecognitionStatus.InitialSilenceTimeout:case t.RecognitionStatus.BabbleTimeout:s=e.ResultReason.NoMatch;break;case t.RecognitionStatus.Error:case t.RecognitionStatus.BadRequest:case t.RecognitionStatus.Forbidden:default:s=e.ResultReason.Canceled;break}return s}static implTranslateCancelResult(i){let a=e.CancellationReason.EndOfStream;switch(i){case t.RecognitionStatus.Success:case t.RecognitionStatus.EndOfDictation:case t.RecognitionStatus.NoMatch:a=e.CancellationReason.EndOfStream;break;case t.RecognitionStatus.InitialSilenceTimeout:case t.RecognitionStatus.BabbleTimeout:case t.RecognitionStatus.Error:case t.RecognitionStatus.BadRequest:case t.RecognitionStatus.Forbidden:default:a=e.CancellationReason.Error;break}return a}static implTranslateCancelErrorCode(i){let a=e.CancellationErrorCode.NoError;switch(i){case t.RecognitionStatus.Error:a=e.CancellationErrorCode.ServiceError;break;case t.RecognitionStatus.TooManyRequests:a=e.CancellationErrorCode.TooManyRequests;break;case t.RecognitionStatus.BadRequest:a=e.CancellationErrorCode.BadRequestParameters;break;case t.RecognitionStatus.Forbidden:a=e.CancellationErrorCode.Forbidden;break;default:a=e.CancellationErrorCode.NoError;break}return a}static implTranslateErrorDetails(i){let a="The speech service encountered an internal error and could not continue.";switch(i){case e.CancellationErrorCode.Forbidden:a="The recognizer is using a free subscription that ran out of quota.";break;case e.CancellationErrorCode.BadRequestParameters:a="Invalid parameter or unsupported audio format in the request.";break;case e.CancellationErrorCode.TooManyRequests:a="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break}return a}};return bi.EnumTranslation=r,bi}var Aa={},jh;function OR(){return jh||(jh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionStatus=e.SynthesisStatus=void 0,function(t){t[t.Success=0]="Success",t[t.SynthesisEnd=1]="SynthesisEnd",t[t.Error=2]="Error"}(e.SynthesisStatus||(e.SynthesisStatus={})),function(t){t[t.Success=0]="Success",t[t.NoMatch=1]="NoMatch",t[t.InitialSilenceTimeout=2]="InitialSilenceTimeout",t[t.BabbleTimeout=3]="BabbleTimeout",t[t.Error=4]="Error",t[t.EndOfDictation=5]="EndOfDictation",t[t.TooManyRequests=6]="TooManyRequests",t[t.BadRequest=7]="BadRequest",t[t.Forbidden=8]="Forbidden"}(e.RecognitionStatus||(e.RecognitionStatus={}))}(Aa)),Aa}var wi={},qh;function MR(){if(qh)return wi;qh=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.TranslationSynthesisEnd=void 0;const e=k();let t=class tg{constructor(o){this.privSynthesisEnd=JSON.parse(o),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=e.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=e.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(o){return new tg(o)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};return wi.TranslationSynthesisEnd=t,wi}var Ei={},Fh;function DR(){if(Fh)return Ei;Fh=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.TranslationHypothesis=void 0;const e=x(),t=Oo();let r=class fc{constructor(i,a){this.privTranslationHypothesis=i,this.privTranslationHypothesis.Offset+=a,this.privTranslationHypothesis.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationHypothesis.Translation.TranslationStatus)}static fromJSON(i,a){return new fc(JSON.parse(i),a)}static fromTranslationResponse(i,a){e.Contracts.throwIfNullOrUndefined(i,"translationHypothesis");const s=i.SpeechHypothesis;return i.SpeechHypothesis=void 0,s.Translation=i,new fc(s,a)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){return this.privTranslationHypothesis.PrimaryLanguage?.Language}asJson(){const i={...this.privTranslationHypothesis};return i.Translation!==void 0?JSON.stringify({...i,TranslationStatus:t.TranslationStatus[i.Translation.TranslationStatus]}):JSON.stringify(i)}mapTranslationStatus(i){if(typeof i=="string")return t.TranslationStatus[i];if(typeof i=="number")return i}};return Ei.TranslationHypothesis=r,Ei}var Ii={},Bh;function NR(){if(Bh)return Ii;Bh=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.TranslationPhrase=void 0;const e=x(),t=k(),r=Oo();let o=class vc{constructor(a,s){this.privTranslationPhrase=a,this.privTranslationPhrase.Offset+=s,this.privTranslationPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privTranslationPhrase.RecognitionStatus),this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationPhrase.Translation.TranslationStatus))}static fromJSON(a,s){return new vc(JSON.parse(a),s)}static fromTranslationResponse(a,s){e.Contracts.throwIfNullOrUndefined(a,"translationResponse");const n=a.SpeechPhrase;return a.SpeechPhrase=void 0,n.Translation=a,n.Text=n.DisplayText,new vc(n,s)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){return this.privTranslationPhrase.PrimaryLanguage?.Language}get Confidence(){return this.privTranslationPhrase.PrimaryLanguage?.Confidence}get Translation(){return this.privTranslationPhrase.Translation}asJson(){const a={...this.privTranslationPhrase},s={...a,RecognitionStatus:t.RecognitionStatus[a.RecognitionStatus]};return a.Translation&&(s.Translation={...a.Translation,TranslationStatus:r.TranslationStatus[a.Translation.TranslationStatus]}),JSON.stringify(s)}mapRecognitionStatus(a){if(typeof a=="string")return t.RecognitionStatus[a];if(typeof a=="number")return a}mapTranslationStatus(a){if(typeof a=="string")return r.TranslationStatus[a];if(typeof a=="number")return a}};return Ii.TranslationPhrase=o,Ii}var Ai={},Uh;function xR(){if(Uh)return Ai;Uh=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.TranslationServiceRecognizer=void 0;const e=O(),t=T(),r=k();let o=class extends r.ConversationServiceRecognizer{constructor(a,s,n,c,u){super(a,s,n,c,u),this.privTranslationRecognizer=u,this.connectionEvents.attach(l=>{l.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}async processTypeSpecificMessages(a){const s=new t.PropertyCollection;let n=await this.processSpeechMessages(a);if(n)return!0;const c=async l=>{if(s.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,l.asJson()),this.privRequestSession.onPhraseRecognized(l.Offset+l.Duration),l.RecognitionStatus===r.RecognitionStatus.Success){const p=this.fireEventForResult(l,s);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,p)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(p.result)}catch(d){this.privErrorCallback&&this.privErrorCallback(d)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const p=r.EnumTranslation.implTranslateRecognitionResult(l.RecognitionStatus),d=new t.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,p,l.Text,l.Duration,l.Offset,l.Language,l.Confidence,void 0,l.asJson(),s);if(p===t.ResultReason.Canceled){const h=r.EnumTranslation.implTranslateCancelResult(l.RecognitionStatus),f=r.EnumTranslation.implTranslateCancelErrorCode(l.RecognitionStatus);await this.cancelRecognitionLocal(h,f,r.EnumTranslation.implTranslateErrorDetails(f))}else if(l.RecognitionStatus!==r.RecognitionStatus.EndOfDictation){const h=new t.TranslationRecognitionEventArgs(d,d.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,h)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(d)}catch(f){this.privErrorCallback&&this.privErrorCallback(f)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}n=!0}},u=l=>{s.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,l.asJson());const p=this.fireEventForResult(l,s);if(this.privRequestSession.onHypothesis(p.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,p)}catch{}n=!0};switch(a.messageType===e.MessageType.Text&&s.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,a.textBody),a.path.toLowerCase()){case"translation.hypothesis":u(r.TranslationHypothesis.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.response":const l=JSON.parse(a.textBody);if(l.SpeechPhrase)await c(r.TranslationPhrase.fromTranslationResponse(l,this.privRequestSession.currentTurnAudioOffset));else{const d=JSON.parse(a.textBody);d.SpeechHypothesis&&u(r.TranslationHypothesis.fromTranslationResponse(d,this.privRequestSession.currentTurnAudioOffset))}break;case"translation.phrase":await c(r.TranslationPhrase.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.synthesis":case"audio":this.sendSynthesisAudio(a.binaryBody,this.privRequestSession.sessionId),n=!0;break;case"audio.end":case"translation.synthesis.end":const p=r.TranslationSynthesisEnd.fromJSON(a.textBody);switch(p.SynthesisStatus){case r.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){const d=new t.TranslationSynthesisResult(t.ResultReason.Canceled,void 0),h=new t.TranslationSynthesisEventArgs(d,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,h)}catch{}}if(this.privTranslationRecognizer.canceled){const d=new t.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,t.CancellationReason.Error,p.FailureReason,t.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,d)}catch{}}break;case r.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break}n=!0;break}return n}cancelRecognition(a,s,n,c,u){const l=new t.PropertyCollection;if(l.setProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[c]),this.privTranslationRecognizer.canceled){const p=new t.TranslationRecognitionCanceledEventArgs(a,n,u,c,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,p)}catch{}}if(this.privSuccessCallback){const p=new t.TranslationRecognitionResult(void 0,s,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,u,void 0,l);try{this.privSuccessCallback(p),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(a,s,n){try{const c=new t.TranslationRecognitionEventArgs(t.TranslationRecognitionResult.fromSpeechRecognitionResult(a),s,n);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,c)}catch{}}handleRecognizedCallback(a,s,n){try{const c=new t.TranslationRecognitionEventArgs(t.TranslationRecognitionResult.fromSpeechRecognitionResult(a),s,n);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,c)}catch{}}fireEventForResult(a,s){let n;if(a.Translation.Translations!==void 0){n=new t.Translations;for(const h of a.Translation.Translations)n.set(h.Language,h.Text||h.DisplayText)}let c,u;a instanceof r.TranslationPhrase?(a.Translation&&a.Translation.TranslationStatus===e.TranslationStatus.Success?c=t.ResultReason.TranslatedSpeech:c=t.ResultReason.RecognizedSpeech,u=a.Confidence):c=t.ResultReason.TranslatingSpeech;const l=a.Language,p=new t.TranslationRecognitionResult(n,this.privRequestSession.requestId,c,a.Text,a.Duration,a.Offset,l,u,a.Translation.FailureReason,a.asJson(),s);return new t.TranslationRecognitionEventArgs(p,a.Offset,this.privRequestSession.sessionId)}sendSynthesisAudio(a,s){const n=a===void 0?t.ResultReason.SynthesizingAudioCompleted:t.ResultReason.SynthesizingAudio,c=new t.TranslationSynthesisResult(n,a),u=new t.TranslationSynthesisEventArgs(c,s);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,u)}catch{}}};return Ai.TranslationServiceRecognizer=o,Ai}var Ti={},$h;function zR(){if($h)return Ti;$h=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.SpeechDetected=void 0;let e=class rg{constructor(r,o){this.privSpeechStartDetected=JSON.parse(r),this.privSpeechStartDetected.Offset+=o}static fromJSON(r,o){return new rg(r,o)}get Offset(){return this.privSpeechStartDetected.Offset}};return Ti.SpeechDetected=e,Ti}var _i={},Vh;function LR(){if(Vh)return _i;Vh=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.SpeechHypothesis=void 0;let e=class ng{constructor(r,o){this.privSpeechHypothesis=JSON.parse(r),this.updateOffset(o)}static fromJSON(r,o){return new ng(r,o)}updateOffset(r){this.privSpeechHypothesis.Offset+=r}asJson(){return JSON.stringify(this.privSpeechHypothesis)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}};return _i.SpeechHypothesis=e,_i}var ki={},Wh;function jR(){if(Wh)return ki;Wh=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.SpeechKeyword=void 0;let e=class ig{constructor(r,o){this.privSpeechKeyword=JSON.parse(r),this.privSpeechKeyword.Offset+=o}static fromJSON(r,o){return new ig(r,o)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}asJson(){return JSON.stringify(this.privSpeechKeyword)}};return ki.SpeechKeyword=e,ki}var Oi={},Hh;function qR(){if(Hh)return Oi;Hh=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.SpeechServiceRecognizer=void 0;const e=T(),t=k();let r=class extends t.ServiceRecognizerBase{constructor(i,a,s,n,c){super(i,a,s,n,c),this.privSpeechRecognizer=c}async processTypeSpecificMessages(i){let a;const s=new e.PropertyCollection;let n=!1;switch(i.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const c=t.SpeechHypothesis.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);s.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,c.asJson()),a=new e.SpeechRecognitionResult(this.privRequestSession.requestId,e.ResultReason.RecognizingSpeech,c.Text,c.Duration,c.Offset,c.Language,c.LanguageDetectionConfidence,void 0,void 0,c.asJson(),s),this.privRequestSession.onHypothesis(c.Offset);const u=new e.SpeechRecognitionEventArgs(a,c.Offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,u)}catch{}n=!0;break;case"speech.phrase":const l=t.SimpleSpeechPhrase.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);s.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,l.asJson());const p=t.EnumTranslation.implTranslateRecognitionResult(l.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(l.Offset+l.Duration),e.ResultReason.Canceled===p){const d=t.EnumTranslation.implTranslateCancelResult(l.RecognitionStatus),h=t.EnumTranslation.implTranslateCancelErrorCode(l.RecognitionStatus);await this.cancelRecognitionLocal(d,h,t.EnumTranslation.implTranslateErrorDetails(h))}else{if(l.RecognitionStatus===t.RecognitionStatus.EndOfDictation)break;if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===e.OutputFormat[e.OutputFormat.Simple])a=new e.SpeechRecognitionResult(this.privRequestSession.requestId,p,l.DisplayText,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,void 0,void 0,l.asJson(),s);else{const h=t.DetailedSpeechPhrase.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);s.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,h.asJson()),a=new e.SpeechRecognitionResult(this.privRequestSession.requestId,p,h.RecognitionStatus===t.RecognitionStatus.Success?h.NBest[0].Display:"",h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,void 0,void 0,h.asJson(),s)}const d=new e.SpeechRecognitionEventArgs(a,a.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,d)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(a)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}n=!0;break}return n}cancelRecognition(i,a,s,n,c){const u=new e.PropertyCollection;if(u.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[n]),this.privSpeechRecognizer.canceled){const l=new e.SpeechRecognitionCanceledEventArgs(s,c,n,void 0,i);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,l)}catch{}}if(this.privSuccessCallback){const l=new e.SpeechRecognitionResult(a,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,c,void 0,u);try{this.privSuccessCallback(l),this.privSuccessCallback=void 0}catch{}}}};return Oi.SpeechServiceRecognizer=r,Oi}var Mi={},Ta={},Kh;function FR(){return Kh||(Kh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.IdentityProvider=e.SpeakerDiarizationMode=void 0,function(t){t.None="None",t.Identity="Identity",t.Anonymous="Anonymous"}(e.SpeakerDiarizationMode||(e.SpeakerDiarizationMode={})),function(t){t.CallCenter="CallCenter"}(e.IdentityProvider||(e.IdentityProvider={}))}(Ta)),Ta}var Jh;function BR(){if(Jh)return Mi;Jh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.ConversationTranscriptionServiceRecognizer=void 0;const e=T(),t=k(),r=FR(),o=Ce();let i=class extends t.ServiceRecognizerBase{constructor(s,n,c,u,l){super(s,n,c,u,l),this.privConversationTranscriber=l,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){const s=this.privSpeechContext.getContext().phraseDetection||{};s.mode=o.RecognitionMode.Conversation;const n={};n.mode=r.SpeakerDiarizationMode.Anonymous,n.audioSessionId=this.privDiarizationSessionId,n.audioOffsetMs=0,n.diarizeIntermediates=this.privRecognizerConfig.parameters.getProperty(e.PropertyId.SpeechServiceResponse_DiarizeIntermediateResults,"false")==="true",s.speakerDiarization=n,this.privSpeechContext.getContext().phraseDetection=s}}async processTypeSpecificMessages(s){let n;const c=new e.PropertyCollection;c.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,s.textBody);let u=!1;switch(s.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const l=t.SpeechHypothesis.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset);n=new e.ConversationTranscriptionResult(this.privRequestSession.requestId,e.ResultReason.RecognizingSpeech,l.Text,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,l.SpeakerId,void 0,l.asJson(),c),this.privRequestSession.onHypothesis(l.Offset);const p=new e.ConversationTranscriptionEventArgs(n,l.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,p)}catch{}u=!0;break;case"speech.phrase":const d=t.SimpleSpeechPhrase.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset),h=t.EnumTranslation.implTranslateRecognitionResult(d.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(d.Offset+d.Duration),e.ResultReason.Canceled===h){const f=t.EnumTranslation.implTranslateCancelResult(d.RecognitionStatus),g=t.EnumTranslation.implTranslateCancelErrorCode(d.RecognitionStatus);await this.cancelRecognitionLocal(f,g,t.EnumTranslation.implTranslateErrorDetails(g))}else if(!(this.privRequestSession.isSpeechEnded&&h===e.ResultReason.NoMatch&&d.RecognitionStatus!==t.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(t.OutputFormatPropertyName)===e.OutputFormat[e.OutputFormat.Simple])n=new e.ConversationTranscriptionResult(this.privRequestSession.requestId,h,d.DisplayText,d.Duration,d.Offset,d.Language,d.LanguageDetectionConfidence,d.SpeakerId,void 0,d.asJson(),c);else{const g=t.DetailedSpeechPhrase.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset);n=new e.ConversationTranscriptionResult(this.privRequestSession.requestId,h,g.RecognitionStatus===t.RecognitionStatus.Success?g.NBest[0].Display:void 0,g.Duration,g.Offset,g.Language,g.LanguageDetectionConfidence,d.SpeakerId,void 0,g.asJson(),c)}const f=new e.ConversationTranscriptionEventArgs(n,n.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,f)}catch{}}u=!0;break}return u}cancelRecognition(s,n,c,u,l){if(new e.PropertyCollection().setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[u]),this.privConversationTranscriber.canceled){const d=new e.ConversationTranscriptionCanceledEventArgs(c,l,u,void 0,s);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,d)}catch{}}}};return Mi.ConversationTranscriptionServiceRecognizer=i,Mi}var Di={},Gh;function UR(){if(Gh)return Di;Gh=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.TranscriptionServiceRecognizer=void 0;const e=O(),t=T(),r=k(),o=Wt();let i=class extends r.ConversationServiceRecognizer{constructor(s,n,c,u,l){super(s,n,c,u,l),this.privTranscriberRecognizer=l,this.sendPrePayloadJSONOverride=p=>this.sendTranscriptionStartJSON(p),this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}async sendSpeechEventAsync(s,n){if(this.privRequestSession.isRecognizing){const c=await this.fetchConnection();await this.sendSpeechEvent(c,this.createSpeechEventPayload(s,n))}}async sendMeetingSpeechEventAsync(s,n){if(this.privRequestSession.isRecognizing){const c=await this.fetchConnection();await this.sendSpeechEvent(c,this.createMeetingSpeechEventPayload(s,n))}}processTypeSpecificMessages(s){return this.processSpeechMessages(s)}handleRecognizedCallback(s,n,c){try{const u=new t.SpeechRecognitionEventArgs(s,n,c);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,u),this.privSuccessCallback){try{this.privSuccessCallback(s)}catch(l){this.privErrorCallback&&this.privErrorCallback(l)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(s,n,c){try{const u=new t.SpeechRecognitionEventArgs(s,n,c);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,u)}catch{}}cancelRecognition(s,n,c,u,l){const p=new t.PropertyCollection;if(p.setProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[u]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){const d=new t.MeetingTranscriptionCanceledEventArgs(c,l,u,void 0,s);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,d)}catch{}}}else if(this.privTranscriberRecognizer.canceled){const d=new t.ConversationTranscriptionCanceledEventArgs(c,l,u,void 0,s);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,d)}catch{}}if(this.privSuccessCallback){const d=new t.SpeechRecognitionResult(n,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,l,void 0,p);try{this.privSuccessCallback(d),this.privSuccessCallback=void 0}catch{}}}async sendTranscriptionStartJSON(s){if(await this.sendSpeechContext(s,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){const n=this.privTranscriberRecognizer.getMeetingInfo(),c=this.createMeetingSpeechEventPayload(n,"start");await this.sendSpeechEvent(s,c)}else{const n=this.privTranscriberRecognizer.getConversationInfo(),c=this.createSpeechEventPayload(n,"start");await this.sendSpeechEvent(s,c)}await this.sendWaveHeader(s)}sendSpeechEvent(s,n){const c=JSON.stringify(n);if(c)return s.send(new o.SpeechConnectionMessage(e.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",c))}createSpeechEventPayload(s,n){const c={id:"meeting",name:n,meeting:s.conversationProperties};return c.meeting.id=s.id,c.meeting.attendees=s.participants,c}createMeetingSpeechEventPayload(s,n){const c={id:"meeting",name:n,meeting:s.meetingProperties};return c.meeting.id=s.id,c.meeting.attendees=s.participants,c}};return Di.TranscriptionServiceRecognizer=i,Di}var Ni={},Qh;function $R(){if(Qh)return Ni;Qh=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.DetailedSpeechPhrase=void 0;const e=k();let t=class sg{constructor(o,i){this.privDetailedSpeechPhrase=JSON.parse(o),this.privDetailedSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privDetailedSpeechPhrase.RecognitionStatus),this.updateOffsets(i)}static fromJSON(o,i){return new sg(o,i)}updateOffsets(o){if(this.privDetailedSpeechPhrase.Offset+=o,this.privDetailedSpeechPhrase.NBest)for(const i of this.privDetailedSpeechPhrase.NBest){if(i.Words)for(const a of i.Words)a.Offset+=o;if(i.DisplayWords)for(const a of i.DisplayWords)a.Offset+=o}}asJson(){const o={...this.privDetailedSpeechPhrase};return JSON.stringify({...o,RecognitionStatus:e.RecognitionStatus[o.RecognitionStatus]})}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}mapRecognitionStatus(o){if(typeof o=="string")return e.RecognitionStatus[o];if(typeof o=="number")return o}};return Ni.DetailedSpeechPhrase=t,Ni}var xi={},Yh;function VR(){if(Yh)return xi;Yh=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.SimpleSpeechPhrase=void 0;const e=k();let t=class og{constructor(o,i=0){this.privSimpleSpeechPhrase=JSON.parse(o),this.privSimpleSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privSimpleSpeechPhrase.RecognitionStatus),this.updateOffset(i)}static fromJSON(o,i){return new og(o,i)}updateOffset(o){this.privSimpleSpeechPhrase.Offset+=o}asJson(){const o={...this.privSimpleSpeechPhrase};return JSON.stringify({...o,RecognitionStatus:e.RecognitionStatus[o.RecognitionStatus]})}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}mapRecognitionStatus(o){if(typeof o=="string")return e.RecognitionStatus[o];if(typeof o=="number")return o}};return xi.SimpleSpeechPhrase=t,xi}var zi={},Zh;function WR(){if(Zh)return zi;Zh=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.AddedLmIntent=void 0;let e=class{constructor(r,o){this.modelImpl=r,this.intentName=o}};return zi.AddedLmIntent=e,zi}var Li={},Xh;function HR(){if(Xh)return Li;Xh=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.IntentServiceRecognizer=void 0;const e=O(),t=T(),r=k();let o=class extends r.ServiceRecognizerBase{constructor(a,s,n,c,u){super(a,s,n,c,u),this.privIntentRecognizer=u,this.privIntentDataSent=!1,c.recognitionEndpointVersion="1"}setIntents(a,s){this.privAddedLmIntents=a,this.privUmbrellaIntent=s,this.privIntentDataSent=!0}processTypeSpecificMessages(a){let s,n,c=!1;const u=new t.PropertyCollection;switch(a.messageType===e.MessageType.Text&&u.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,a.textBody),a.path.toLowerCase()){case"speech.hypothesis":const p=r.SpeechHypothesis.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset);if(s=new t.IntentRecognitionResult(void 0,this.privRequestSession.requestId,t.ResultReason.RecognizingIntent,p.Text,p.Duration,p.Offset,p.Language,p.LanguageDetectionConfidence,void 0,p.asJson(),u),this.privRequestSession.onHypothesis(s.offset),n=new t.IntentRecognitionEventArgs(s,p.Offset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,n)}catch{}c=!0;break;case"speech.phrase":const d=r.SimpleSpeechPhrase.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset);s=new t.IntentRecognitionResult(void 0,this.privRequestSession.requestId,r.EnumTranslation.implTranslateRecognitionResult(d.RecognitionStatus),d.DisplayText,d.Duration,d.Offset,d.Language,d.LanguageDetectionConfidence,void 0,d.asJson(),u),n=new t.IntentRecognitionEventArgs(s,s.offset,this.privRequestSession.sessionId);const h=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,n)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(s)}catch(g){this.privErrorCallback&&this.privErrorCallback(g)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};this.privIntentDataSent===!1||t.ResultReason.NoMatch===n.result.reason?(this.privRequestSession.onPhraseRecognized(n.offset+n.result.duration),h()):this.privPendingIntentArgs=n,c=!0;break;case"response":if(n=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,n===void 0){if(a.textBody==="")return;n=new t.IntentRecognitionEventArgs(new t.IntentRecognitionResult,0,this.privRequestSession.sessionId)}const f=r.IntentResponse.fromJSON(a.textBody);if(f!==null&&f.topScoringIntent&&f.topScoringIntent.intent){let g=this.privAddedLmIntents[f.topScoringIntent.intent];if(this.privUmbrellaIntent!==void 0&&(g=this.privUmbrellaIntent),g){const m=g===void 0||g.intentName===void 0?f.topScoringIntent.intent:g.intentName;let v=n.result.reason;m!==void 0&&(v=t.ResultReason.RecognizedIntent);const y=n.result.properties!==void 0?n.result.properties:new t.PropertyCollection;y.setProperty(t.PropertyId.LanguageUnderstandingServiceResponse_JsonResult,a.textBody),n=new t.IntentRecognitionEventArgs(new t.IntentRecognitionResult(m,n.result.resultId,v,n.result.text,n.result.duration,n.result.offset,void 0,void 0,n.result.errorDetails,n.result.json,y),n.offset,n.sessionId)}}if(this.privRequestSession.onPhraseRecognized(n.offset+n.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,n)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(n.result)}catch(g){this.privErrorCallback&&this.privErrorCallback(g)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}c=!0;break}const l=new e.Deferred;return l.resolve(c),l.promise}cancelRecognition(a,s,n,c,u){const l=new t.PropertyCollection;if(l.setProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[c]),this.privIntentRecognizer.canceled){const p=new t.IntentRecognitionCanceledEventArgs(n,u,c,void 0,void 0,a);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,p)}catch{}}if(this.privSuccessCallback){const p=new t.IntentRecognitionResult(void 0,s,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,u,void 0,l);try{this.privSuccessCallback(p),this.privSuccessCallback=void 0}catch{}}}};return Li.IntentServiceRecognizer=o,Li}var ji={},ef;function KR(){if(ef)return ji;ef=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.IntentResponse=void 0;let e=class ag{constructor(r){r===""?this.privIntentResponse={}:this.privIntentResponse=JSON.parse(r)}static fromJSON(r){return new ag(r)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}};return ji.IntentResponse=e,ji}var _a={},tf;function JR(){return tf||(tf=1,Object.defineProperty(_a,"__esModule",{value:!0})),_a}var qi={},Fi={},rf;function GR(){if(rf)return Fi;rf=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.ServiceTelemetryListener=void 0;const e=O(),t=va();class r{constructor(i,a,s){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=i,this.privAudioSourceId=a,this.privAudioNodeId=s,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(i){i>0&&this.privPhraseLatencies.push(Date.now()-i)}hypothesisReceived(i){i>0&&this.privHypothesisLatencies.push(Date.now()-i)}onEvent(i){this.privIsDisposed||(i instanceof t.RecognitionTriggeredEvent&&i.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:i.eventTime,Name:"ListeningTrigger",Start:i.eventTime}),i instanceof e.AudioStreamNodeAttachingEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=i.eventTime),i instanceof e.AudioStreamNodeAttachedEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=i.eventTime),i instanceof e.AudioSourceErrorEvent&&i.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Error:i.error,Name:"Microphone",Start:this.privMicStartTime})),i instanceof e.AudioStreamNodeErrorEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Error:i.error,Name:"Microphone",Start:this.privMicStartTime})),i instanceof e.AudioStreamNodeDetachedEvent&&i.audioSourceId===this.privAudioSourceId&&i.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:i.eventTime,Name:"Microphone",Start:this.privMicStartTime})),i instanceof t.ConnectingToServiceEvent&&i.requestId===this.privRequestId&&(this.privConnectionId=i.sessionId),i instanceof e.ConnectionStartEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionStartTime=i.eventTime),i instanceof e.ConnectionEstablishedEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:i.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),i instanceof e.ConnectionEstablishErrorEvent&&i.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:i.eventTime,Error:this.getConnectionError(i.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),i instanceof e.ConnectionMessageReceivedEvent&&i.connectionId===this.privConnectionId&&i.message&&i.message.headers&&i.message.headers.path&&(this.privReceivedMessages[i.message.headers.path]||(this.privReceivedMessages[i.message.headers.path]=new Array),this.privReceivedMessages[i.message.headers.path].length<50&&this.privReceivedMessages[i.message.headers.path].push(i.networkReceivedTime)))}getTelemetry(){const i=new Array;this.privListeningTriggerMetric&&i.push(this.privListeningTriggerMetric),this.privMicMetric&&i.push(this.privMicMetric),this.privConnectionEstablishMetric&&i.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&i.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&i.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const a={Metrics:i,ReceivedMessages:this.privReceivedMessages},s=JSON.stringify(a);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],s}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(i){switch(i){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+i.toString()}}}return Fi.ServiceTelemetryListener=r,Fi}var nf;function QR(){if(nf)return qi;nf=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.RequestSession=void 0;const e=O(),t=va(),r=GR();let o=class{constructor(a){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=a,this.privRequestId=(0,e.createNoDashGuid)(),this.privAudioNodeId=(0,e.createNoDashGuid)(),this.privTurnDeferral=new e.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(a){this.privServiceTelemetryListener&&this.privDetachables.push(a.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new r.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new t.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}async onAudioSourceAttachCompleted(a,s){this.privAudioNode=a,this.privIsAudioNodeDetached=!1,s?await this.onComplete():this.onEvent(new t.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onPreConnectionStart(a,s){this.privAuthFetchEventId=a,this.privSessionId=s,this.onEvent(new t.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}async onAuthCompleted(a){a&&await this.onComplete()}async onConnectionEstablishCompleted(a,s){if(a===200){this.onEvent(new t.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else a===403&&await this.onComplete()}async onServiceTurnEndResponse(a){this.privTurnDeferral.resolve(),!a||this.isSpeechEnded?(await this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}onSpeechContext(){this.privRequestId=(0,e.createNoDashGuid)()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new e.Deferred}onHypothesis(a){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(a)))}onPhraseRecognized(a){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(a)),this.onServiceRecognized(a)}onServiceRecognized(a){this.privLastRecoOffset=a,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(a),this.privConnectionAttempts=0}onAudioSent(a){this.privBytesSent+=a,this.privRecognitionBytesSent+=a}onRetryConnection(){this.privConnectionAttempts++}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const a of this.privDetachables)await a.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}async onStopRecognizing(){await this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(a){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(a),e.Events.instance.onEvent(a)}async onComplete(){this.privIsRecognizing&&(this.privIsRecognizing=!1,await this.detachAudioNode())}async detachAudioNode(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&await this.privAudioNode.detach())}};return qi.RequestSession=o,qi}var Bi={},ka={},sf;function YR(){return sf||(sf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TentativePhraseResultsOption=e.OutputFormat=e.PhraseExtension=e.PhraseOption=void 0,function(t){t.WordTimings="WordTimings",t.SNR="SNR",t.Pronunciation="Pronunciation",t.WordPronunciation="WordPronunciation",t.WordConfidence="WordConfidence",t.Words="Words",t.Sentiment="Sentiment",t.PronunciationAssessment="PronunciationAssessment",t.ContentAssessment="ContentAssessment",t.PhraseAMScore="PhraseAMScore",t.PhraseLMScore="PhraseLMScore",t.WordAMScore="WordAMScore",t.WordLMScore="WordLMScore",t.RuleTree="RuleTree",t.NBestTimings="NBestTimings",t.DecoderDiagnostics="DecoderDiagnostics",t.DisplayWordTimings="DisplayWordTimings",t.DisplayWords="DisplayWords"}(e.PhraseOption||(e.PhraseOption={})),function(t){t.Graph="Graph",t.Corrections="Corrections",t.Sentiment="Sentiment"}(e.PhraseExtension||(e.PhraseExtension={})),function(t){t.Simple="Simple",t.Detailed="Detailed"}(e.OutputFormat||(e.OutputFormat={})),function(t){t.None="None",t.Always="Always"}(e.TentativePhraseResultsOption||(e.TentativePhraseResultsOption={}))}(ka)),ka}var of;function ZR(){if(of)return Bi;of=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.SpeechContext=void 0;const e=Ce(),t=YR();let r=class{constructor(i){this.privContext={},this.privDynamicGrammar=i}getContext(){return this.privContext}setPronunciationAssessmentParams(i,a,s=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(i)||{},s&&(this.privContext.phraseDetection.mode=e.RecognitionMode.Conversation),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push(t.PhraseOption.PronunciationAssessment),this.privContext.phraseOutput.detailed.options.indexOf(t.PhraseOption.SNR)===-1&&this.privContext.phraseOutput.detailed.options.push(t.PhraseOption.SNR),a&&(this.privContext.phraseDetection.enrichment.contentAssessment={topic:a},this.privContext.phraseOutput.detailed.options.push(t.PhraseOption.ContentAssessment))}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=t.OutputFormat.Detailed}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=t.OutputFormat.Detailed,this.privContext.phraseOutput.detailed.options.indexOf(t.PhraseOption.WordTimings)===-1&&this.privContext.phraseOutput.detailed.options.push(t.PhraseOption.WordTimings)}setSpeakerDiarizationAudioOffsetMs(i){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=i}toJSON(){const i=this.privDynamicGrammar.generateGrammarObject();return this.privContext.dgi=i,JSON.stringify(this.privContext)}};return Bi.SpeechContext=r,Bi}var Ui={},Oa={},af;function XR(){return af||(af=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SubstringMatchType=e.GroupType=void 0,function(t){t.IntentText="IntentText",t.IntentEntity="IntentEntity",t.Generic="Generic",t.People="People",t.Place="Place",t.DynamicEntity="DynamicEntity"}(e.GroupType||(e.GroupType={})),function(t){t.None="None",t.LeftRooted="LeftRooted",t.PartialName="PartialName",t.MiddleOfSentence="MiddleOfSentence"}(e.SubstringMatchType||(e.SubstringMatchType={}))}(Oa)),Oa}var cf;function eb(){if(cf)return Ui;cf=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.DynamicGrammarBuilder=void 0;const e=XR();let t=class{addPhrase(o){this.privPhrases||(this.privPhrases=[]),o instanceof Array?this.privPhrases=this.privPhrases.concat(o):this.privPhrases.push(o)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(o){this.privGrammars||(this.privGrammars=[]),o instanceof Array?this.privGrammars=this.privGrammars.concat(o):this.privGrammars.push(o)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;const o={};if(o.referenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){const i=[];this.privPhrases.forEach(a=>{i.push({text:a})}),o.groups=[{type:e.GroupType.Generic,items:i}]}return o}};return Ui.DynamicGrammarBuilder=t,Ui}var $i={},Vi={},Wi={},Ma={},uf;function lf(){return uf||(uf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MessageDataStreamType=e.ActivityPayloadResponse=void 0;class t{constructor(o){this.privActivityResponse=JSON.parse(o)}static fromJSON(o){return new t(o)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}e.ActivityPayloadResponse=t,function(r){r[r.None=0]="None",r[r.TextToSpeechAudio=1]="TextToSpeechAudio"}(e.MessageDataStreamType||(e.MessageDataStreamType={}))}(Ma)),Ma}var pf;function tb(){if(pf)return Wi;pf=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.DialogServiceTurnState=void 0;const e=qr(),t=Vt(),r=lf();let o=class{constructor(a,s){this.privRequestId=s,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=a,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(a,s){return a.messageDataStreamType===r.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=t.AudioOutputStream.createPullStream(),this.privAudioStream.format=s!==void 0?s:e.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}};return Wi.DialogServiceTurnState=o,Wi}var df;function rb(){if(df)return Vi;df=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.DialogServiceTurnStateManager=void 0;const e=Me(),t=tb();let r=class{constructor(){this.privTurnMap=new Map}StartTurn(i){if(this.privTurnMap.has(i))throw new e.InvalidOperationError("Service error: There is already a turn with id:"+i);const a=new t.DialogServiceTurnState(this,i);return this.privTurnMap.set(i,a),this.privTurnMap.get(i)}GetTurn(i){return this.privTurnMap.get(i)}CompleteTurn(i){if(!this.privTurnMap.has(i))throw new e.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+i);const a=this.privTurnMap.get(i);return a.complete(),this.privTurnMap.delete(i),a}};return Vi.DialogServiceTurnStateManager=r,Vi}var Da={},hf;function nb(){return hf||(hf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InvocationSource=void 0,function(t){t.None="None",t.VoiceActivationWithKeyword="VoiceActivationWithKeyword"}(e.InvocationSource||(e.InvocationSource={}))}(Da)),Da}var Na={},ff;function ib(){return ff||(ff=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OnRejectAction=e.KeywordDetectionType=void 0,function(t){t.StartTrigger="StartTrigger"}(e.KeywordDetectionType||(e.KeywordDetectionType={})),function(t){t.EndOfTurn="EndOfTurn",t.Continue="Continue"}(e.OnRejectAction||(e.OnRejectAction={}))}(Na)),Na}var vf;function sb(){if(vf)return $i;vf=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.DialogServiceAdapter=void 0;const e=ie(),t=Uu(),r=O(),o=qr(),i=T(),a=rb(),s=k(),n=lf(),c=nb(),u=ib(),l=Wt();let p=class extends s.ServiceRecognizerBase{constructor(h,f,g,m,v){super(h,f,g,m,v),this.privEvents=new r.EventSource,this.privDialogServiceConnector=v,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new a.DialogServiceTurnStateManager,this.recognizeOverride=(y,S,P)=>this.listenOnce(y,S,P),this.postConnectImplOverride=y=>this.dialogConnectImpl(y),this.configConnectionOverride=y=>this.configConnection(y),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=g,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(y=>{y.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}async sendMessage(h){const f=(0,r.createGuid)(),g=(0,r.createNoDashGuid)(),m={context:{interactionId:f},messagePayload:JSON.parse(h),version:.5},v=JSON.stringify(m);await(await this.fetchConnection()).send(new l.SpeechConnectionMessage(r.MessageType.Text,"agent",g,"application/json",v))}async privDisconnect(){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}processTypeSpecificMessages(h){const f=new i.PropertyCollection;h.messageType===r.MessageType.Text&&f.setProperty(i.PropertyId.SpeechServiceResponse_JsonResult,h.textBody);let g,m;switch(h.path.toLowerCase()){case"speech.phrase":const y=s.SimpleSpeechPhrase.fromJSON(h.textBody,this.privRequestSession.currentTurnAudioOffset);if(this.privRequestSession.onPhraseRecognized(y.Offset+y.Duration),y.RecognitionStatus!==s.RecognitionStatus.TooManyRequests&&y.RecognitionStatus!==s.RecognitionStatus.Error){const A=this.fireEventForResult(y,f);if(this.privLastResult=A.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,A)}catch{}}m=!0;break;case"speech.hypothesis":const S=s.SpeechHypothesis.fromJSON(h.textBody,this.privRequestSession.currentTurnAudioOffset);g=new i.SpeechRecognitionResult(this.privRequestSession.requestId,i.ResultReason.RecognizingSpeech,S.Text,S.Duration,S.Offset,S.Language,S.LanguageDetectionConfidence,void 0,void 0,S.asJson(),f),this.privRequestSession.onHypothesis(S.Offset);const P=new i.SpeechRecognitionEventArgs(g,S.Offset,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,P)}catch{}m=!0;break;case"speech.keyword":const b=s.SpeechKeyword.fromJSON(h.textBody,this.privRequestSession.currentTurnAudioOffset);g=new i.SpeechRecognitionResult(this.privRequestSession.requestId,b.Status==="Accepted"?i.ResultReason.RecognizedKeyword:i.ResultReason.NoMatch,b.Text,b.Duration,b.Offset,void 0,void 0,void 0,void 0,b.asJson(),f),b.Status!=="Accepted"&&(this.privLastResult=g);const w=new i.SpeechRecognitionEventArgs(g,g.duration,g.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,w)}catch{}m=!0;break;case"audio":{const A=h.requestId.toUpperCase(),E=this.privTurnStateManager.GetTurn(A);try{h.binaryBody?E.audioStream.write(h.binaryBody):E.endAudioStream()}catch{}}m=!0;break;case"response":this.handleResponseMessage(h),m=!0;break}const v=new r.Deferred;return v.resolve(m),v.promise}async cancelRecognition(h,f,g,m,v){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&await this.privRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const y=new i.PropertyCollection;y.setProperty(s.CancellationErrorCodePropertyName,i.CancellationErrorCode[m]);const S=new i.SpeechRecognitionCanceledEventArgs(g,v,m,void 0,h);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,S)}catch{}if(this.privSuccessCallback){const P=new i.SpeechRecognitionResult(void 0,i.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,v,void 0,y);try{this.privSuccessCallback(P),this.privSuccessCallback=void 0}catch{}}}}async listenOnce(h,f,g){this.privRecognizerConfig.recognitionMode=h,this.privSuccessCallback=f,this.privErrorCallback=g,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(i.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const m=this.connectImpl(),v=this.sendPreAudioMessages(),y=await this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),S=await this.privDialogAudioSource.format,P=await this.privDialogAudioSource.deviceInfo,b=new e.ReplayableAudioNode(y,S.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(b,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:P};try{await m,await v}catch(E){return await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.ConnectionFailure,E),Promise.resolve()}const w=new i.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,w),this.sendAudio(b).then(()=>{},async E=>{await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,E)})}dialogConnectImpl(h){return this.privConnectionLoop=this.startMessageLoop(),h}receiveDialogMessageOverride(){const h=new r.Deferred,f=async()=>{try{const g=this.isDisposed(),m=!this.isDisposed()&&this.terminateMessageLoop;if(g||m){h.resolve(void 0);return}const y=await(await this.fetchConnection()).read();if(!y)return f();const S=l.SpeechConnectionMessage.fromConnectionMessage(y);switch(S.path.toLowerCase()){case"turn.start":{const R=S.requestId.toUpperCase(),M=this.privRequestSession.requestId.toUpperCase();R!==M?this.privTurnStateManager.StartTurn(R):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const b=s.SpeechDetected.fromJSON(S.textBody,this.privRequestSession.currentTurnAudioOffset),w=new i.RecognitionEventArgs(b.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,w);break;case"speech.enddetected":let A;S.textBody.length>0?A=S.textBody:A="{ Offset: 0 }";const E=s.SpeechDetected.fromJSON(A,this.privRequestSession.currentTurnAudioOffset);this.privRequestSession.onServiceRecognized(E.Offset);const D=new i.RecognitionEventArgs(E.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,D);break;case"turn.end":{const R=S.requestId.toUpperCase(),M=this.privRequestSession.requestId.toUpperCase();if(R!==M)this.privTurnStateManager.CompleteTurn(R);else{const _=new i.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,_),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(z){this.privErrorCallback&&this.privErrorCallback(z)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{await this.processTypeSpecificMessages(S)||this.serviceEvents&&this.serviceEvents.onEvent(new r.ServiceEvent(S.path.toLowerCase(),S.textBody))}catch{}}return f()}catch{this.terminateMessageLoop=!0,h.resolve()}};return f().catch(g=>{r.Events.instance.onEvent(new r.BackgroundEvent(g))}),h.promise}async startMessageLoop(){this.terminateMessageLoop=!1;try{await this.receiveDialogMessageOverride()}catch(h){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,i.CancellationReason.Error,i.CancellationErrorCode.RuntimeError,h)}return Promise.resolve()}async configConnection(h){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(await this.sendSpeechServiceConfig(h,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendAgentConfig(h),h)}async sendPreAudioMessages(){const h=await this.fetchConnection();this.addKeywordContextData(),await this.sendSpeechContext(h,!0),await this.sendAgentContext(h),await this.sendWaveHeader(h)}sendAgentConfig(h){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(i.PropertyId.Conversation_DialogType)===i.DialogServiceConfig.DialogTypes.CustomCommands){const g=this.agentConfig.get();g.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(g)}this.onEvent(new t.SendingAgentContextMessageEvent(this.agentConfig));const f=this.agentConfig.toJsonString();return this.agentConfigSent=!0,h.send(new l.SpeechConnectionMessage(r.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",f))}}sendAgentContext(h){const f=(0,r.createGuid)(),g=this.privDialogServiceConnector.properties.getProperty(i.PropertyId.Conversation_Speech_Activity_Template),v=JSON.stringify({channelData:"",context:{interactionId:f},messagePayload:typeof g===void 0?void 0:g,version:.5});return h.send(new l.SpeechConnectionMessage(r.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",v))}fireEventForResult(h,f){const g=s.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus),m=new i.SpeechRecognitionResult(this.privRequestSession.requestId,g,h.DisplayText,h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,void 0,void 0,h.asJson(),f);return new i.SpeechRecognitionEventArgs(m,h.Offset,this.privRequestSession.sessionId)}handleResponseMessage(h){const f=JSON.parse(h.textBody);switch(f.messageType.toLowerCase()){case"message":const g=h.requestId.toUpperCase(),m=n.ActivityPayloadResponse.fromJSON(h.textBody),v=this.privTurnStateManager.GetTurn(g);if(m.conversationId){const P=this.agentConfig.get();P.botInfo.conversationId=m.conversationId,this.agentConfig.set(P)}const y=v.processActivityPayload(m,o.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),S=new i.ActivityReceivedEventArgs(m.messagePayload,y);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,S)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new i.TurnStatusReceivedEventArgs(h.textBody))}catch{}break;default:r.Events.instance.onEvent(new r.BackgroundEvent(`Unexpected response of type ${f.messageType}. Ignoring.`));break}}onEvent(h){this.privEvents.onEvent(h),r.Events.instance.onEvent(h)}addKeywordContextData(){const h=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(h===void 0)return;const f=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),g=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),m=h.split(";"),v=f===void 0?[]:f.split(";"),y=g===void 0?[]:g.split(";"),S=[];for(let P=0;P<m.length;P++){const b={text:m[P]};P<v.length&&(b.startOffset=Number(v[P])),P<y.length&&(b.duration=Number(y[P])),S.push(b)}this.speechContext.getContext().invocationSource=c.InvocationSource.VoiceActivationWithKeyword,this.speechContext.getContext().keywordDetection=[{clientDetectedKeywords:S,onReject:{action:u.OnRejectAction.EndOfTurn},type:u.KeywordDetectionType.StartTrigger}]}};return $i.DialogServiceAdapter=p,$i}var Hi={},gf;function ob(){if(gf)return Hi;gf=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.AgentConfig=void 0;let e=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(r){this.iPrivConfig=r}};return Hi.AgentConfig=e,Hi}var xa={},Ki={},Ji={},mf;function za(){if(mf)return Ji;mf=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.ConversationConnectionConfig=void 0;const e=hh();let t=class rt extends e.RestConfigBase{static get host(){return rt.privHost}static get apiVersion(){return rt.privApiVersion}static get clientAppId(){return rt.privClientAppId}static get defaultLanguageCode(){return rt.privDefaultLanguageCode}static get restPath(){return rt.privRestPath}static get webSocketPath(){return rt.privWebSocketPath}static get transcriptionEventKeys(){return rt.privTranscriptionEventKeys}};return Ji.ConversationConnectionConfig=t,t.privHost="dev.microsofttranslator.com",t.privRestPath="/capito/room",t.privApiVersion="2.0",t.privDefaultLanguageCode="en-US",t.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",t.privWebSocketPath="/capito/translate",t.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"],Ji}var yf;function ab(){if(yf)return Ki;yf=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.ConversationManager=void 0;const e=ie(),t=x(),r=T(),o=za();let i=class{constructor(){this.privRequestParams=o.ConversationConnectionConfig.configParams,this.privErrors=o.ConversationConnectionConfig.restErrors,this.privHost=o.ConversationConnectionConfig.host,this.privApiVersion=o.ConversationConnectionConfig.apiVersion,this.privRestPath=o.ConversationConnectionConfig.restPath,this.privRestAdapter=new e.RestMessageAdapter({})}createOrJoin(s,n,c,u){try{t.Contracts.throwIfNullOrUndefined(s,"args");const l=s.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,o.ConversationConnectionConfig.defaultLanguageCode),p=s.getProperty(r.PropertyId.ConversationTranslator_Name,"conversation_host"),d=s.getProperty(r.PropertyId.ConversationTranslator_Host,this.privHost),h=s.getProperty(r.PropertyId.ConversationTranslator_CorrelationId),f=s.getProperty(r.PropertyId.SpeechServiceConnection_Key),g=s.getProperty(r.PropertyId.SpeechServiceConnection_Region),m=s.getProperty(r.PropertyId.SpeechServiceAuthorization_Token);t.Contracts.throwIfNullOrWhitespace(l,"languageCode"),t.Contracts.throwIfNullOrWhitespace(p,"nickname"),t.Contracts.throwIfNullOrWhitespace(d,"endpointHost");const v={};v[this.privRequestParams.apiVersion]=this.privApiVersion,v[this.privRequestParams.languageCode]=l,v[this.privRequestParams.nickname]=p;const y={};h&&(y[this.privRequestParams.correlationId]=h),y[this.privRequestParams.clientAppId]=o.ConversationConnectionConfig.clientAppId,n!==void 0?v[this.privRequestParams.roomId]=n:(t.Contracts.throwIfNullOrUndefined(g,this.privErrors.authInvalidSubscriptionRegion),y[this.privRequestParams.subscriptionRegion]=g,f?y[this.privRequestParams.subscriptionKey]=f:m?y[this.privRequestParams.authorization]=`Bearer ${m}`:t.Contracts.throwIfNullOrUndefined(f,this.privErrors.authInvalidSubscriptionKey));const S={};S.headers=y,this.privRestAdapter.options=S;const P=`https://${d}${this.privRestPath}`;this.privRestAdapter.request(e.RestRequestType.Post,P,v,null).then(b=>{const w=e.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,b.headers);if(!b.ok){if(u){let E=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",b.status.toString()),D;try{D=JSON.parse(b.data),E+=` [${D.error.code}: ${D.error.message}]`}catch{E+=` [${b.data}]`}w&&(E+=` ${w}`),u(E)}return}const A=JSON.parse(b.data);if(A&&(A.requestId=w),c){try{c(A)}catch(E){u&&u(E)}c=void 0}}).catch(()=>{})}catch(l){if(u)if(l instanceof Error){const p=l;u(p.name+": "+p.message)}else u(l)}}leave(s,n){return new Promise((c,u)=>{try{t.Contracts.throwIfNullOrUndefined(s,this.privErrors.invalidArgs.replace("{arg}","config")),t.Contracts.throwIfNullOrWhitespace(n,this.privErrors.invalidArgs.replace("{arg}","token"));const l=s.getProperty(r.PropertyId.ConversationTranslator_Host,this.privHost),p=s.getProperty(r.PropertyId.ConversationTranslator_CorrelationId),d={};d[this.privRequestParams.apiVersion]=this.privApiVersion,d[this.privRequestParams.sessionToken]=n;const h={};p&&(h[this.privRequestParams.correlationId]=p);const f={};f.headers=h,this.privRestAdapter.options=f;const g=`https://${l}${this.privRestPath}`;this.privRestAdapter.request(e.RestRequestType.Delete,g,d,null).then(m=>{m.ok,c()}).catch(()=>{})}catch(l){if(l instanceof Error){const p=l;u(p.name+": "+p.message)}else u(l)}})}};return Ki.ConversationManager=i,Ki}var Tt={},Gi={},Qi={},Yi={},Sf;function Cf(){if(Sf)return Yi;Sf=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.ConversationConnectionMessage=void 0;const e=O();let t=class extends e.ConnectionMessage{constructor(o,i,a,s){super(o,i,a,s);const n=JSON.parse(this.textBody);n.type!==void 0&&(this.privConversationMessageType=n.type)}get conversationMessageType(){return this.privConversationMessageType}};return Yi.ConversationConnectionMessage=t,Yi}var Pf;function cb(){if(Pf)return Qi;Pf=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.ConversationWebsocketMessageFormatter=void 0;const e=O(),t=Cf();let r=class{toConnectionMessage(i){const a=new e.Deferred;try{if(i.messageType===e.MessageType.Text){const s=new t.ConversationConnectionMessage(i.messageType,i.textContent,{},i.id);a.resolve(s)}else i.messageType===e.MessageType.Binary&&a.resolve(new t.ConversationConnectionMessage(i.messageType,i.binaryContent,void 0,i.id))}catch(s){a.reject(`Error formatting the message. Error: ${s}`)}return a.promise}fromConnectionMessage(i){const a=new e.Deferred;try{if(i.messageType===e.MessageType.Text){const s=`${i.textBody?i.textBody:""}`;a.resolve(new e.RawWebsocketMessage(e.MessageType.Text,s,i.id))}}catch(s){a.reject(`Error formatting the message. ${s}`)}return a.promise}};return Qi.ConversationWebsocketMessageFormatter=r,Qi}var Rf;function ub(){if(Rf)return Gi;Rf=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.ConversationConnectionFactory=void 0;const e=ie(),t=O(),r=x(),o=T(),i=Ee(),a=za(),s=cb();let n=class extends i.ConnectionFactoryBase{create(u,l,p){const d=u.parameters.getProperty(o.PropertyId.ConversationTranslator_Host,a.ConversationConnectionConfig.host),h=u.parameters.getProperty(o.PropertyId.ConversationTranslator_CorrelationId,(0,t.createGuid)()),f=`wss://${d}${a.ConversationConnectionConfig.webSocketPath}`,g=u.parameters.getProperty(o.PropertyId.ConversationTranslator_Token,void 0);r.Contracts.throwIfNullOrUndefined(g,"token");const m={};m[a.ConversationConnectionConfig.configParams.apiVersion]=a.ConversationConnectionConfig.apiVersion,m[a.ConversationConnectionConfig.configParams.token]=g,m[a.ConversationConnectionConfig.configParams.correlationId]=h;const v=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(f,m,{},new s.ConversationWebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(u),v,p))}};return Gi.ConversationConnectionFactory=n,Gi}var Zi={},Xi={},bf;function lb(){if(bf)return Xi;bf=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.ConversationRequestSession=void 0;const e=O();let t=class{constructor(o){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=o,this.privRequestId=(0,e.createNoDashGuid)(),this.privRequestCompletionDeferral=new e.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(o,i){this.privSessionId=i}onAuthCompleted(o){o&&this.onComplete()}onConnectionEstablishCompleted(o){o!==200&&o===403&&this.onComplete()}onServiceTurnEndResponse(o){o?this.privRequestId=(0,e.createNoDashGuid)():this.onComplete()}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const o of this.privDetachables)await o.detach()}}onComplete(){}};return Xi.ConversationRequestSession=t,Xi}var pe={},wf;function Ef(){if(wf)return pe;wf=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.ConversationReceivedTranslationEventArgs=pe.ParticipantsListEventArgs=pe.ParticipantAttributeEventArgs=pe.ParticipantEventArgs=pe.LockRoomEventArgs=pe.MuteAllEventArgs=void 0;const e=T();class t extends e.SessionEventArgs{constructor(c,u){super(u),this.privIsMuted=c}get isMuted(){return this.privIsMuted}}pe.MuteAllEventArgs=t;class r extends e.SessionEventArgs{constructor(c,u){super(u),this.privIsLocked=c}get isMuted(){return this.privIsLocked}}pe.LockRoomEventArgs=r;class o extends e.SessionEventArgs{constructor(c,u){super(u),this.privParticipant=c}get participant(){return this.privParticipant}}pe.ParticipantEventArgs=o;class i extends e.SessionEventArgs{constructor(c,u,l,p){super(p),this.privKey=u,this.privValue=l,this.privParticipantId=c}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}pe.ParticipantAttributeEventArgs=i;class a extends e.SessionEventArgs{constructor(c,u,l,p,d,h,f,g,m){super(m),this.privRoomId=c,this.privSessionToken=u,this.privTranslateTo=l,this.privProfanityFilter=p,this.privRoomProfanityFilter=d,this.privIsRoomLocked=h,this.privIsRoomLocked=f,this.privParticipants=g}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}pe.ParticipantsListEventArgs=a;class s{constructor(c,u,l){this.privPayload=u,this.privCommand=c,this.privSessionId=l}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}return pe.ConversationReceivedTranslationEventArgs=s,pe}var Ue={},If;function Af(){if(If)return Ue;If=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.ConversationTranslatorCommandTypes=Ue.ConversationTranslatorMessageTypes=Ue.InternalParticipants=void 0;class e{constructor(r=[],o){this.participants=r,this.meId=o}addOrUpdateParticipant(r){if(r===void 0)return;const o=this.getParticipantIndex(r.id);return o>-1?this.participants.splice(o,1,r):this.participants.push(r),this.getParticipant(r.id)}getParticipantIndex(r){return this.participants.findIndex(o=>o.id===r)}getParticipant(r){return this.participants.find(o=>o.id===r)}deleteParticipant(r){this.participants=this.participants.filter(o=>o.id!==r)}get host(){return this.participants.find(r=>r.isHost===!0)}get me(){return this.getParticipant(this.meId)}}return Ue.InternalParticipants=e,Ue.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},Ue.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"},Ue}var La={},es={},Tf;function pb(){if(Tf)return es;Tf=1,Object.defineProperty(es,"__esModule",{value:!0}),es.CommandResponsePayload=void 0;const e=r=>JSON.parse(r);let t=class cg{constructor(o){this.privCommandResponse=e(o)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(o){return new cg(o)}};return es.CommandResponsePayload=t,es}var _t={},_f;function db(){if(_f)return _t;_f=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.ParticipantPayloadResponse=_t.ParticipantsListPayloadResponse=void 0;const e=i=>JSON.parse(i),t=i=>JSON.parse(i);class r{constructor(a){this.privParticipantsPayloadResponse=e(a)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(a){return new r(a)}}_t.ParticipantsListPayloadResponse=r;class o{constructor(a){this.privParticipantPayloadResponse=t(a)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(a){return new o(a)}}return _t.ParticipantPayloadResponse=o,_t}var kt={},kf;function hb(){if(kf)return kt;kf=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.TextResponsePayload=kt.SpeechResponsePayload=void 0;const e=i=>JSON.parse(i),t=i=>JSON.parse(i);class r{constructor(a){this.privSpeechResponse=e(a)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(a){return new r(a)}}kt.SpeechResponsePayload=r;class o{constructor(a){this.privTextResponse=t(a)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(a){return new o(a)}}return kt.TextResponsePayload=o,kt}var Of;function fb(){return Of||(Of=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TextResponsePayload=e.SpeechResponsePayload=e.ParticipantPayloadResponse=e.ParticipantsListPayloadResponse=e.CommandResponsePayload=void 0;var t=pb();Object.defineProperty(e,"CommandResponsePayload",{enumerable:!0,get:function(){return t.CommandResponsePayload}});var r=db();Object.defineProperty(e,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return r.ParticipantsListPayloadResponse}}),Object.defineProperty(e,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return r.ParticipantPayloadResponse}});var o=hb();Object.defineProperty(e,"SpeechResponsePayload",{enumerable:!0,get:function(){return o.SpeechResponsePayload}}),Object.defineProperty(e,"TextResponsePayload",{enumerable:!0,get:function(){return o.TextResponsePayload}})}(La)),La}var Mf;function vb(){if(Mf)return Zi;Mf=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.ConversationServiceAdapter=void 0;const e=O(),t=T(),r=k(),o=Cf(),i=lb(),a=Ef(),s=Af(),n=fb();let c=class extends r.ServiceRecognizerBase{constructor(l,p,d,h,f){super(l,p,d,h,f),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=f,this.privConversationAuthentication=l,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=g=>this.conversationConnectImpl(g),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new i.ConversationRequestSession((0,e.createNoDashGuid)()),this.privConversationConnectionFactory=p,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}async dispose(l){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&await(await this.privConnectionConfigPromise).dispose(l),await super.dispose(l)}async sendMessage(l){return(await this.fetchConnection()).send(new o.ConversationConnectionMessage(e.MessageType.Text,l))}async sendMessageAsync(l){await(await this.fetchConnection()).send(new o.ConversationConnectionMessage(e.MessageType.Text,l))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,t.CancellationReason.Error,t.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}async processTypeSpecificMessages(){return!0}cancelRecognition(l,p,d,h,f){this.terminateMessageLoop=!0;const g=new t.ConversationTranslationCanceledEventArgs(d,f,h,void 0,l);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,g)}catch{}}async conversationConnectImpl(l){return this.privConnectionLoop=this.startMessageLoop(),l}async receiveConversationMessageOverride(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const l=new e.Deferred;try{const d=await(await this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return l.resolve(),Promise.resolve();if(!d)return this.receiveConversationMessageOverride();const h=this.privConversationRequestSession.sessionId,f=d.conversationMessageType.toLowerCase();let g=!1;try{switch(f){case"info":case"participant_command":case"command":const m=n.CommandResponsePayload.fromJSON(d.textBody);switch(m.command.toLowerCase()){case"participantlist":const w=n.ParticipantsListPayloadResponse.fromJSON(d.textBody),A=w.participants.map(z=>({avatar:z.avatar,displayName:z.nickname,id:z.participantId,isHost:z.ishost,isMuted:z.ismuted,isUsingTts:z.usetts,preferredLanguage:z.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new a.ParticipantsListEventArgs(w.roomid,w.token,w.translateTo,w.profanityFilter,w.roomProfanityFilter,w.roomLocked,w.muteAll,A,h));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(m.participantId,s.ConversationTranslatorCommandTypes.setTranslateToLanguages,m.value,h));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(m.participantId,s.ConversationTranslatorCommandTypes.setProfanityFiltering,m.value,h));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(m.participantId,s.ConversationTranslatorCommandTypes.setMute,m.value,h));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new a.MuteAllEventArgs(m.value,h));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new t.ConversationExpirationEventArgs(m.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(m.participantId,s.ConversationTranslatorCommandTypes.setUseTTS,m.value,h));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new a.LockRoomEventArgs(m.value,h));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(m.participantId,s.ConversationTranslatorCommandTypes.changeNickname,m.value,h));break;case"joinsession":const E=n.ParticipantPayloadResponse.fromJSON(d.textBody),D={avatar:E.avatar,displayName:E.nickname,id:E.participantId,isHost:E.ishost,isMuted:E.ismuted,isUsingTts:E.usetts,preferredLanguage:E.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new a.ParticipantEventArgs(D,h));break;case"leavesession":const R={id:m.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new a.ParticipantEventArgs(R,h));break;case"disconnectsession":const M={id:m.participantId};break;case"token":const _=new r.CognitiveTokenAuthentication(()=>{const z=m.token;return Promise.resolve(z)},()=>{const z=m.token;return Promise.resolve(z)});this.authentication=_,this.privConversationServiceConnector.onToken(_);break;default:break}break;case"partial":case"final":const v=n.SpeechResponsePayload.fromJSON(d.textBody),y=f==="final"?t.ResultReason.TranslatedParticipantSpeech:t.ResultReason.TranslatingParticipantSpeech,S=new t.ConversationTranslationResult(v.participantId,this.getTranslations(v.translations),v.language,v.id,y,v.recognition,void 0,void 0,d.textBody,void 0);v.isFinal?((S.text!==void 0&&S.text.length>0||v.id===this.privLastPartialUtteranceId)&&(g=!0),g&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new a.ConversationReceivedTranslationEventArgs(s.ConversationTranslatorMessageTypes.final,S,h))):S.text!==void 0&&(this.privLastPartialUtteranceId=v.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new a.ConversationReceivedTranslationEventArgs(s.ConversationTranslatorMessageTypes.partial,S,h)));break;case"translated_message":const P=n.TextResponsePayload.fromJSON(d.textBody),b=new t.ConversationTranslationResult(P.participantId,this.getTranslations(P.translations),P.language,void 0,void 0,P.originalText,void 0,void 0,void 0,d.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new a.ConversationReceivedTranslationEventArgs(s.ConversationTranslatorMessageTypes.instantMessage,b,h));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return l.promise}async startMessageLoop(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const l=this.receiveConversationMessageOverride();try{return await l}catch(p){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",t.CancellationReason.Error,t.CancellationErrorCode.RuntimeError,p),null}}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(l=>l.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(l=>l),this.privConnectionConfigPromise)}getTranslations(l){let p;if(l!==void 0){p=new t.Translations;for(const d of l)p.set(d.lang,d.translation)}return p}};return Zi.ConversationServiceAdapter=c,Zi}var Df;function gb(){if(Df)return Tt;Df=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.ConversationTranslatorRecognizer=Tt.ConversationRecognizerFactory=void 0;const e=k(),t=O(),r=x(),o=T(),i=ub(),a=vb();class s{static fromConfig(u,l,p){return new n(u,l,p)}}Tt.ConversationRecognizerFactory=s;let n=class extends o.Recognizer{constructor(u,l,p){const d=l;r.Contracts.throwIfNull(d,"speechConfig");const h=u;r.Contracts.throwIfNull(h,"conversationImpl"),super(p,d.properties,new i.ConversationConnectionFactory),this.privConversation=h,this.privIsDisposed=!1,this.privProperties=d.properties.clone(),this.privConnection=o.Connection.fromRecognizer(this),this.privProperties.getProperty(o.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=t.Timeout.setTimeout,this.privClearTimeout=t.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(u){this.privConnection.connected=u}set disconnected(u){this.privConnection.disconnected=u}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(u,l,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfNullOrWhitespace(u,"token"),this.privReco.conversationTranslatorToken=u,this.resetConversationTimeout(),this.privReco.connectAsync(l,p)}catch(d){if(p)if(d instanceof Error){const h=d;p(h.name+": "+h.message)}else p(d)}}disconnect(u,l){try{r.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{u&&u()},p=>{l&&l(p)})}catch(p){if(l)if(p instanceof Error){const d=p;l(d.name+": "+d.message)}else l(p);this.dispose(!0).catch(d=>{t.Events.instance.onEvent(new t.BackgroundEvent(d))})}}sendRequest(u,l,p){try{r.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(u,l,p)}catch(d){if(p)if(d instanceof Error){const h=d;p(h.name+": "+h.message)}else p(d);this.dispose(!0).catch(h=>{t.Events.instance.onEvent(new t.BackgroundEvent(h))})}}onToken(u){this.privConversation.onToken(u)}async close(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,await this.dispose(!0))}async dispose(u){this.privIsDisposed||u&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),await super.dispose(u))}createRecognizerConfig(u){return new e.RecognizerConfig(u,this.privProperties)}createServiceRecognizer(u,l,p,d){const h=p;return new a.ConversationServiceAdapter(u,l,h,d,this)}sendMessage(u,l,p){const d=this.privReco;((f,g,m)=>{f!==void 0?f.then(()=>{try{g&&g()}catch(v){m&&m(`'Unhandled error on promise callback: ${v}'`)}},v=>{try{m&&m(v)}catch{}}):m&&m("Null promise")})(d.sendMessageAsync(u),l,p),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};return Tt.ConversationTranslatorRecognizer=n,Tt}var ts={},Nf;function mb(){if(Nf)return ts;Nf=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.TranscriberRecognizer=void 0;const e=O(),t=x(),r=T(),o=k(),i=Ce();let a=class extends r.Recognizer{constructor(n,c){const u=n;t.Contracts.throwIfNull(u,"speechTranslationConfig");const l=c;t.Contracts.throwIfNull(l,"audioConfigImpl"),t.Contracts.throwIfNullOrWhitespace(u.speechRecognitionLanguage,r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage]),super(c,u.properties,new o.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return t.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){t.Contracts.throwIfNullOrWhitespace(n,"token"),this.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,n)}set conversation(n){t.Contracts.throwIfNullOrUndefined(n,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=n}getConversationInfo(){return t.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(n){t.Contracts.throwIfNullOrUndefined(n,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=n}getMeetingInfo(){return t.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(n,c){(0,e.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(i.RecognitionMode.Conversation),n,c)}stopContinuousRecognitionAsync(n,c){(0,e.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),n,c)}async close(){this.privDisposedRecognizer||await this.dispose(!0)}async pushConversationEvent(n,c){const u=this.privReco;t.Contracts.throwIfNullOrUndefined(u,"serviceRecognizer"),await u.sendSpeechEventAsync(n,c)}async pushMeetingEvent(n,c){const u=this.privReco;t.Contracts.throwIfNullOrUndefined(u,"serviceRecognizer"),await u.sendMeetingSpeechEventAsync(n,c)}async enforceAudioGating(){const u=(await this.audioConfig.format).channels;if(u===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(u!==8)throw new Error(`Unsupported audio configuration: Detected ${u}-channel audio`)}connectMeetingCallbacks(n){this.isMeetingRecognizer=!0,this.canceled=(c,u)=>{n.canceled&&n.canceled(n,u)},this.recognizing=(c,u)=>{n.transcribing&&n.transcribing(n,u)},this.recognized=(c,u)=>{n.transcribed&&n.transcribed(n,u)},this.sessionStarted=(c,u)=>{n.sessionStarted&&n.sessionStarted(n,u)},this.sessionStopped=(c,u)=>{n.sessionStopped&&n.sessionStopped(n,u)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}async dispose(n){this.privDisposedRecognizer||(n&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(n))}createRecognizerConfig(n){return new o.RecognizerConfig(n,this.properties)}createServiceRecognizer(n,c,u,l){const p=u;return new o.TranscriptionServiceRecognizer(n,c,p,l,this)}};return ts.TranscriberRecognizer=a,ts}var xf;function yb(){return xf||(xf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InternalParticipants=e.ConversationTranslatorMessageTypes=e.ConversationTranslatorCommandTypes=e.ParticipantsListEventArgs=e.ParticipantEventArgs=e.ParticipantAttributeEventArgs=e.MuteAllEventArgs=e.LockRoomEventArgs=e.ConversationReceivedTranslationEventArgs=e.TranscriberRecognizer=e.ConversationRecognizerFactory=e.ConversationConnectionConfig=e.ConversationManager=void 0;var t=ab();Object.defineProperty(e,"ConversationManager",{enumerable:!0,get:function(){return t.ConversationManager}});var r=za();Object.defineProperty(e,"ConversationConnectionConfig",{enumerable:!0,get:function(){return r.ConversationConnectionConfig}});var o=gb();Object.defineProperty(e,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return o.ConversationRecognizerFactory}});var i=mb();Object.defineProperty(e,"TranscriberRecognizer",{enumerable:!0,get:function(){return i.TranscriberRecognizer}});var a=Ef();Object.defineProperty(e,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return a.ConversationReceivedTranslationEventArgs}}),Object.defineProperty(e,"LockRoomEventArgs",{enumerable:!0,get:function(){return a.LockRoomEventArgs}}),Object.defineProperty(e,"MuteAllEventArgs",{enumerable:!0,get:function(){return a.MuteAllEventArgs}}),Object.defineProperty(e,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return a.ParticipantAttributeEventArgs}}),Object.defineProperty(e,"ParticipantEventArgs",{enumerable:!0,get:function(){return a.ParticipantEventArgs}}),Object.defineProperty(e,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return a.ParticipantsListEventArgs}});var s=Af();Object.defineProperty(e,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return s.ConversationTranslatorCommandTypes}}),Object.defineProperty(e,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return s.ConversationTranslatorMessageTypes}}),Object.defineProperty(e,"InternalParticipants",{enumerable:!0,get:function(){return s.InternalParticipants}})}(xa)),xa}var ja={},zf;function Lf(){return zf||(zf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisAudioMetadata=e.MetadataType=void 0,function(r){r.WordBoundary="WordBoundary",r.Bookmark="Bookmark",r.Viseme="Viseme",r.SentenceBoundary="SentenceBoundary",r.SessionEnd="SessionEnd",r.AvatarSignal="TalkingAvatarSignal"}(e.MetadataType||(e.MetadataType={}));class t{constructor(o){this.privSynthesisAudioMetadata=JSON.parse(o)}static fromJSON(o){return new t(o)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}e.SynthesisAudioMetadata=t}(ja)),ja}var rs={},Ie={},jf;function Sb(){if(jf)return Ie;jf=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.SynthesisStartedEvent=Ie.ConnectingToSynthesisServiceEvent=Ie.SynthesisTriggeredEvent=Ie.SpeechSynthesisEvent=void 0;const e=O();class t extends e.PlatformEvent{constructor(s,n,c=e.EventType.Info){super(s,c),this.privRequestId=n}get requestId(){return this.privRequestId}}Ie.SpeechSynthesisEvent=t;class r extends t{constructor(s,n,c){super("SynthesisTriggeredEvent",s),this.privSessionAudioDestinationId=n,this.privTurnAudioDestinationId=c}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}Ie.SynthesisTriggeredEvent=r;class o extends t{constructor(s,n){super("ConnectingToSynthesisServiceEvent",s),this.privAuthFetchEventId=n}get authFetchEventId(){return this.privAuthFetchEventId}}Ie.ConnectingToSynthesisServiceEvent=o;class i extends t{constructor(s,n){super("SynthesisStartedEvent",s),this.privAuthFetchEventId=n}get authFetchEventId(){return this.privAuthFetchEventId}}return Ie.SynthesisStartedEvent=i,Ie}var qf;function Cb(){if(qf)return rs;qf=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.SynthesisTurn=void 0;const e=O(),t=Vt(),r=T(),o=Lf(),i=Sb();let a=class gc{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=(0,e.createNoDashGuid)(),this.privTurnDeferral=new e.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(n){this.privStreamId=n}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(n){this.privAudioOutputFormat=n}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){const n=new r.PropertyCollection;return n.setProperty(r.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),n}}async getAllReceivedAudio(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(await this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}async getAllReceivedAudioWithHeader(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const n=await this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(n),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()}startNewSynthesis(n,c,u,l){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=n,this.privRawText=c,this.privIsSSML=u,this.privAudioOutputStream=new t.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",l!==void 0&&(this.privTurnAudioDestination=l,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new i.SynthesisTriggeredEvent(this.requestId,void 0,l===void 0?void 0:l.id()))}onPreConnectionStart(n){this.privAuthFetchEventId=n,this.onEvent(new i.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(n){n&&this.onComplete()}onConnectionEstablishCompleted(n){if(n===200){this.onEvent(new i.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else n===403&&this.onComplete()}onServiceResponseMessage(n){const c=JSON.parse(n);this.streamId=c.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(n){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new e.Deferred;const c=JSON.parse(n);c.webrtc&&(this.privWebRTCSDP=c.webrtc.connectionString)}onAudioChunkReceived(n){this.isSynthesizing&&(this.privAudioOutputStream.write(n),this.privBytesReceived+=n.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(n))}onTextBoundaryEvent(n){this.updateTextOffset(n.Data.text.Text,n.Type)}onVisemeMetadataReceived(n){n.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=n.Data.AnimationChunk)}onSessionEnd(n){this.privAudioDuration=n.Data.Offset}async constructSynthesisResult(){const n=await this.getAllReceivedAudioWithHeader();return new r.SpeechSynthesisResult(this.requestId,r.ResultReason.SynthesizingAudioCompleted,n,void 0,this.extraProperties,this.audioDuration)}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const n=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",n}onEvent(n){e.Events.instance.onEvent(n)}static isXmlTag(n){return n.length>=2&&n[0]==="<"&&n[n.length-1]===">"}updateTextOffset(n,c){c===o.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(n,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+n.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!gc.isXmlTag(n)&&this.updateTextOffset(n,c))):(this.privSentenceOffset=this.privRawText.indexOf(n,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+n.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!gc.isXmlTag(n)&&this.updateTextOffset(n,c)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}async readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{await this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}}withinXmlTag(n){return this.privRawText.indexOf("<",n+1)>this.privRawText.indexOf(">",n+1)}};return rs.SynthesisTurn=a,rs}var ns={},Ff;function Pb(){if(Ff)return ns;Ff=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.SynthesisAdapterBase=void 0;const e=O(),t=T(),r=k(),o=Wt();let i=class{constructor(s,n,c,u){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!s)throw new e.ArgumentNullError("authentication");if(!n)throw new e.ArgumentNullError("connectionFactory");if(!c)throw new e.ArgumentNullError("synthesizerConfig");this.privAuthentication=s,this.privConnectionFactory=n,this.privSynthesizerConfig=c,this.privIsDisposed=!1,this.privSessionAudioDestination=u,this.privSynthesisTurn=new r.SynthesisTurn,this.privConnectionEvents=new e.EventSource,this.privServiceEvents=new e.EventSource,this.privSynthesisContext=new r.SynthesisContext,this.privAgentConfig=new r.AgentConfig,this.connectionEvents.attach(l=>{if(l.name==="ConnectionClosedEvent"){const p=l;p.statusCode!==1e3&&this.cancelSynthesisLocal(t.CancellationReason.Error,p.statusCode===1007?t.CancellationErrorCode.BadRequestParameters:t.CancellationErrorCode.ConnectionFailure,`${p.reason} websocket error code: ${p.statusCode}`)}})}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(s){this.privActivityTemplate=s}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(s){this.privAudioOutputFormat=s,this.privSynthesisTurn.audioOutputFormat=s,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=s),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=s)}isDisposed(){return this.privIsDisposed}async dispose(s){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&await(await this.privConnectionConfigurationPromise).dispose(s)}async connect(){await this.connectImpl()}async sendNetworkMessage(s,n){const c=typeof n=="string"?e.MessageType.Text:e.MessageType.Binary,u=typeof n=="string"?"application/json":"";return(await this.fetchConnection()).send(new o.SpeechConnectionMessage(c,s,this.privSynthesisTurn.requestId,u,n))}async Speak(s,n,c,u,l,p){let d;if(n?d=s:d=this.privSynthesizer.buildSsml(s),this.speakOverride!==void 0)return this.speakOverride(d,c,u,l);this.privSuccessCallback=u,this.privErrorCallback=l,this.privSynthesisTurn.startNewSynthesis(c,s,n,p);try{await this.connectImpl();const h=await this.fetchConnection();await this.sendSynthesisContext(h),await this.sendSsmlMessage(h,d,c),this.onSynthesisStarted(c),this.receiveMessage()}catch(h){return this.cancelSynthesisLocal(t.CancellationReason.Error,t.CancellationErrorCode.ConnectionFailure,h),Promise.reject(h)}}async stopSpeaking(){return await this.connectImpl(),(await this.fetchConnection()).send(new o.SpeechConnectionMessage(e.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}cancelSynthesis(s,n,c,u){const l=new t.PropertyCollection;l.setProperty(r.CancellationErrorCodePropertyName,t.CancellationErrorCode[c]);const p=new t.SpeechSynthesisResult(s,t.ResultReason.Canceled,void 0,u,l);if(this.onSynthesisCancelled(p),this.privSuccessCallback)try{this.privSuccessCallback(p)}catch{}}cancelSynthesisLocal(s,n,c){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,s,n,c))}processTypeSpecificMessages(s){return!0}async receiveMessage(){try{const n=await(await this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!n)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const c=o.SpeechConnectionMessage.fromConnectionMessage(n);if(c.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(c.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(c.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(c.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===c.streamId.toLowerCase()&&c.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(c.binaryBody),this.onSynthesizing(c.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(c.binaryBody));break;case"audio.metadata":const u=r.SynthesisAudioMetadata.fromJSON(c.textBody).Metadata;for(const p of u)switch(p.Type){case r.MetadataType.WordBoundary:case r.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(p);const d=new t.SpeechSynthesisWordBoundaryEventArgs(p.Data.Offset,p.Data.Duration,p.Data.text.Text,p.Data.text.Length,p.Type===r.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,p.Data.text.BoundaryType);this.onWordBoundary(d);break;case r.MetadataType.Bookmark:const h=new t.SpeechSynthesisBookmarkEventArgs(p.Data.Offset,p.Data.Bookmark);this.onBookmarkReached(h);break;case r.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(p),p.Data.IsLastAnimation){const f=new t.SpeechSynthesisVisemeEventArgs(p.Data.Offset,p.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(f)}break;case r.MetadataType.AvatarSignal:this.onAvatarEvent(p);break;case r.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(p);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let l;try{l=await this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(l)}catch(p){this.privErrorCallback&&this.privErrorCallback(p)}this.onSynthesisCompleted(l);break;default:this.processTypeSpecificMessages(c)||this.privServiceEvents&&this.serviceEvents.onEvent(new e.ServiceEvent(c.path.toLowerCase(),c.textBody))}return this.receiveMessage()}catch{}}sendSynthesisContext(s){this.setSynthesisContextSynthesisSection();const n=this.synthesisContext.toJSON();if(n)return s.send(new o.SpeechConnectionMessage(e.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",n))}setSpeechConfigSynthesisSection(){}connectImpl(s=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(c=>c.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=(0,e.createNoDashGuid)(),this.privConnectionId=(0,e.createNoDashGuid)(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const n=s?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=n.then(async c=>{this.privSynthesisTurn.onAuthCompleted(!1);const u=await this.privConnectionFactory.create(this.privSynthesizerConfig,c,this.privConnectionId);u.events.attach(p=>{this.connectionEvents.onEvent(p)});const l=await u.open();return l.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(l.statusCode),Promise.resolve(u)):l.statusCode===403&&!s?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(l.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${l.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Url)} Reason: ${l.reason}`))},c=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(c)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(s,n){if(n)return s.send(new o.SpeechConnectionMessage(e.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",n))}sendSsmlMessage(s,n,c){return s.send(new o.SpeechConnectionMessage(e.MessageType.Text,"ssml",c,"application/ssml+xml",n))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(s=>s.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async configureConnection(){const s=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(s):(this.setSpeechConfigSynthesisSection(),await this.sendSpeechServiceConfig(s,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),s)}onAvatarEvent(s){}onSynthesisStarted(s){}onSynthesizing(s){}onSynthesisCancelled(s){}onSynthesisCompleted(s){}onWordBoundary(s){}onVisemeReceived(s){}onBookmarkReached(s){}};return ns.SynthesisAdapterBase=i,i.telemetryDataEnabled=!0,ns}var is={},Bf;function Rb(){if(Bf)return is;Bf=1,Object.defineProperty(is,"__esModule",{value:!0}),is.AvatarSynthesisAdapter=void 0;const e=T(),t=k();let r=class extends t.SynthesisAdapterBase{constructor(i,a,s,n,c){super(i,a,s,void 0),this.privAvatarSynthesizer=n,this.privSynthesizer=n,this.privAvatarConfig=c}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:this.privAvatarConfig.videoFormat?.bitrate,codec:this.privAvatarConfig.videoFormat?.codec,crop:{bottomRight:{x:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.y},topLeft:{x:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.y}},resolution:{height:this.privAvatarConfig.videoFormat?.height,width:this.privAvatarConfig.videoFormat?.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(e.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:this.privAvatarConfig.backgroundImage?.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,style:this.privAvatarConfig.style,useBuiltInVoice:this.privAvatarConfig.useBuiltInVoice}}}onAvatarEvent(i){if(this.privAvatarSynthesizer.avatarEventReceived){const a=new e.AvatarEventArgs(i.Data.Offset,i.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,a)}catch{}}}};return is.AvatarSynthesisAdapter=r,is}var ss={},Uf;function bb(){if(Uf)return ss;Uf=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.SpeechSynthesisAdapter=void 0;const e=T(),t=k();let r=class extends t.SynthesisAdapterBase{constructor(i,a,s,n,c){super(i,a,s,c),this.privSpeechSynthesizer=n,this.privSynthesizer=n}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(i){const a=new e.SpeechSynthesisEventArgs(new e.SpeechSynthesisResult(i,e.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,a)}onSynthesizing(i){if(this.privSpeechSynthesizer.synthesizing)try{const a=this.privSynthesisTurn.audioOutputFormat.addHeader(i),s=new e.SpeechSynthesisEventArgs(new e.SpeechSynthesisResult(this.privSynthesisTurn.requestId,e.ResultReason.SynthesizingAudio,a));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,s)}catch{}}onSynthesisCancelled(i){if(this.privSpeechSynthesizer.SynthesisCanceled){const a=new e.SpeechSynthesisEventArgs(i);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,a)}catch{}}}onSynthesisCompleted(i){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new e.SpeechSynthesisEventArgs(i))}catch{}}onWordBoundary(i){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,i)}catch{}}onVisemeReceived(i){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,i)}catch{}}onBookmarkReached(i){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,i)}catch{}}};return ss.SpeechSynthesisAdapter=r,ss}var os={},$f;function wb(){if($f)return os;$f=1,Object.defineProperty(os,"__esModule",{value:!0}),os.SynthesisRestAdapter=void 0;const e=ie(),t=T(),r=Ee(),o=le();let i=class{constructor(s,n){let c=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!c){const l=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Region,"westus"),p=r.ConnectionFactoryBase.getHostSuffix(l);c=s.parameters.getProperty(t.PropertyId.SpeechServiceConnection_Host,`https://${l}.tts.speech${p}`)}this.privUri=`${c}/cognitiveservices/voices/list`;const u=e.RestConfigBase.requestOptions;this.privRestAdapter=new e.RestMessageAdapter(u),this.privAuthentication=n}getVoicesList(s){return this.privRestAdapter.setHeaders(o.HeaderNames.ConnectionId,s),this.privAuthentication.fetch(s).then(n=>(this.privRestAdapter.setHeaders(n.headerName,n.token),this.privRestAdapter.request(e.RestRequestType.Get,this.privUri)))}};return os.SynthesisRestAdapter=i,os}var qa={},Vf;function Eb(){return Vf||(Vf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesizerConfig=e.SynthesisServiceType=void 0;const t=k();var r;(function(i){i[i.Standard=0]="Standard",i[i.Custom=1]="Custom"})(r=e.SynthesisServiceType||(e.SynthesisServiceType={}));class o{constructor(a,s){this.privSynthesisServiceType=r.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=a||new t.SpeechServiceConfig(new t.Context(null)),this.privParameters=s}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(a){this.privSynthesisServiceType=a}set synthesisVideoSection(a){this.privSpeechServiceConfig.Context.synthesis={video:a}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}}e.SynthesizerConfig=o}(qa)),qa}var as={},Wf;function Ib(){if(Wf)return as;Wf=1,Object.defineProperty(as,"__esModule",{value:!0}),as.SynthesisContext=void 0;const e=T();let t=class{constructor(){this.privContext={}}setSection(o,i){this.privContext[o]=i}set audioOutputFormat(o){this.privAudioOutputFormat=o}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(o){const i=this.buildSynthesisContext(o);this.setSection("synthesis",i)}buildSynthesisContext(o){return{audio:{metadataOptions:{bookmarkEnabled:!!o?.bookmarkReached,punctuationBoundaryEnabled:o?.properties.getProperty(e.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!o?.wordBoundary),sentenceBoundaryEnabled:o?.properties.getProperty(e.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!o?.visemeReceived,wordBoundaryEnabled:o?.properties.getProperty(e.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!o?.wordBoundary)},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:o?.autoDetectSourceLanguage}}}};return as.SynthesisContext=t,as}var cs={},Hf;function Ab(){if(Hf)return cs;Hf=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.SpeakerRecognitionConfig=void 0;const e=k();let t=class{constructor(o,i){this.privContext=o||new e.Context(null),this.privParameters=i}get parameters(){return this.privParameters}get Context(){return this.privContext}};return cs.SpeakerRecognitionConfig=t,cs}var us={},Kf;function Tb(){if(Kf)return us;Kf=1,Object.defineProperty(us,"__esModule",{value:!0}),us.SpeakerServiceRecognizer=void 0;const e=ie(),t=O(),r=T(),o=k(),i=Wt();let a=class extends o.ServiceRecognizerBase{constructor(n,c,u,l,p){super(n,c,u,l,p),this.privSpeakerRecognizer=p,this.privSpeakerAudioSource=u,this.recognizeSpeaker=d=>this.recognizeSpeakerOnce(d),this.sendPrePayloadJSONOverride=()=>this.noOp()}processTypeSpecificMessages(n){let c=!1;const u=new r.PropertyCollection;switch(n.messageType===t.MessageType.Text&&u.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,n.textBody),n.path.toLowerCase()){case"speaker.response":const p=JSON.parse(n.textBody);let d;p.status.statusCode.toLowerCase()!=="success"?d=new r.SpeakerRecognitionResult(p,r.ResultReason.Canceled,r.CancellationErrorCode.ServiceError,p.status.reason):d=new r.SpeakerRecognitionResult(p,r.ResultReason.RecognizedSpeaker),this.privResultDeferral&&this.privResultDeferral.resolve(d),c=!0;break}const l=new t.Deferred;return l.resolve(c),l.promise}cancelRecognition(n,c,u,l,p){if(new r.PropertyCollection().setProperty(o.CancellationErrorCodePropertyName,r.CancellationErrorCode[l]),this.privResultDeferral){const h=new r.SpeakerRecognitionResult({scenario:this.privSpeakerModel.scenario,status:{statusCode:p,reason:p}},r.ResultReason.Canceled,l,p);try{this.privResultDeferral.resolve(h)}catch(f){this.privResultDeferral.reject(f)}}}async recognizeSpeakerOnce(n){this.privSpeakerModel=n,this.voiceProfileType=n.scenario,this.privResultDeferral||(this.privResultDeferral=new t.Deferred),this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(r.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const c=this.connectImpl(),u=this.sendPreAudioMessages(this.extractSpeakerContext(n)),l=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),p=await this.privSpeakerAudioSource.format,d=await this.privSpeakerAudioSource.deviceInfo,h=new e.ReplayableAudioNode(l,p.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(h,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:d};try{await c,await u}catch(m){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.ConnectionFailure,m)}const f=new r.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,f),this.receiveMessage(),this.sendAudio(h).then(()=>{},m=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.RuntimeError,m)}),this.privResultDeferral.promise}async sendPreAudioMessages(n){const c=await this.fetchConnection();await this.sendSpeakerRecognition(c,n)}async sendSpeakerRecognition(n,c){const u=JSON.stringify(c);return n.send(new i.SpeechConnectionMessage(t.MessageType.Text,"speaker.context",this.privRequestSession.requestId,"application/json; charset=utf-8",u))}extractSpeakerContext(n){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:n.profileIds,scenario:n.scenario}}};return us.SpeakerServiceRecognizer=a,us}var ls={},Jf;function _b(){if(Jf)return ls;Jf=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.VoiceServiceRecognizer=void 0;const e=ie(),t=O(),r=T(),o=k(),i=Wt();let a=class extends o.ServiceRecognizerBase{constructor(n,c,u,l,p){super(n,c,u,l,p),this.privDeferralMap=new t.DeferralMap,this.privSpeakerAudioSource=u,this.sendPrePayloadJSONOverride=()=>this.noOp()}set SpeakerAudioSource(n){this.privSpeakerAudioSource=n}processTypeSpecificMessages(n){let c=!1;const u=new r.PropertyCollection;switch(n.messageType===t.MessageType.Text&&u.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,n.textBody),n.path.toLowerCase()){case"speaker.profiles":const p=JSON.parse(n.textBody);switch(p.operation.toLowerCase()){case"create":this.handleCreateResponse(p,n.requestId);break;case"delete":case"reset":this.handleResultResponse(p,n.requestId);break;case"fetch":const g=JSON.parse(n.textBody);this.handleFetchResponse(g,n.requestId);break}c=!0;break;case"speaker.phrases":const d=JSON.parse(n.textBody);this.handlePhrasesResponse(d,n.requestId),c=!0;break;case"speaker.profile.enrollment":const h=JSON.parse(n.textBody),f=new r.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(h.enrollment?h.enrollment.enrollmentStatus:h.status.statusCode),h.enrollment?JSON.stringify(h.enrollment):void 0,h.status.reason);this.privDeferralMap.getId(n.requestId)&&this.privDeferralMap.complete(n.requestId,f),this.privRequestSession.onSpeechEnded(),c=!0;break}const l=new t.Deferred;return l.resolve(c),l.promise}cancelRecognition(n,c,u,l,p){new r.PropertyCollection().setProperty(o.CancellationErrorCodePropertyName,r.CancellationErrorCode[l]);const h=new r.VoiceProfileEnrollmentResult(r.ResultReason.Canceled,p,p);this.privDeferralMap.getId(c)&&this.privDeferralMap.complete(c,h)}async createProfile(n,c){this.voiceProfileType=n.toString();const u=this.connectImpl();try{const l=new t.Deferred;return await u,await this.sendCreateProfile(l,n,c),this.receiveMessage(),l.promise}catch(l){throw l}}async resetProfile(n){return this.voiceProfileType=n.profileType.toString(),this.sendCommonRequest("reset",n.profileType,n)}async deleteProfile(n){return this.voiceProfileType=n.profileType.toString(),this.sendCommonRequest("delete",n.profileType,n)}async retrieveEnrollmentResult(n){return this.voiceProfileType=n.profileType.toString(),this.privExpectedProfileId=n.profileId,this.sendCommonRequest("fetch",n.profileType,n)}async getAllProfiles(n){return this.voiceProfileType=n.toString(),this.sendCommonRequest("fetch",n)}async getActivationPhrases(n,c){this.voiceProfileType=n.toString();const u=this.connectImpl();try{const l=new t.Deferred;return await u,await this.sendPhrasesRequest(l,n,c),this.receiveMessage(),l.promise}catch(l){throw l}}async enrollProfile(n){this.voiceProfileType=n.profileType.toString();const c=new t.Deferred;this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(r.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const u=this.connectImpl(),l=this.sendPreAudioMessages(n,c),p=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),d=await this.privSpeakerAudioSource.format,h=await this.privSpeakerAudioSource.deviceInfo,f=new e.ReplayableAudioNode(p,d.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(f,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:h};try{await u,await l}catch(v){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.ConnectionFailure,v)}const g=new r.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,g),this.receiveMessage(),this.sendAudio(f).then(()=>{},v=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.RuntimeError,v)}),c.promise}async sendPreAudioMessages(n,c){const u=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,c),await this.sendBaseRequest(u,"enroll",this.scenarioFrom(n.profileType),n)}async sendPhrasesRequest(n,c,u){const l=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,n);const p=this.scenarioFrom(c),d={locale:u,scenario:p};return l.send(new i.SpeechConnectionMessage(t.MessageType.Text,"speaker.profile.phrases",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(d)))}async sendCreateProfile(n,c,u){const l=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,n);const p=c===r.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":c===r.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification",d={locale:u,number:"1",scenario:p};return l.send(new i.SpeechConnectionMessage(t.MessageType.Text,"speaker.profile.create",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(d)))}async sendCommonRequest(n,c,u=void 0){const l=this.connectImpl();try{const p=new t.Deferred;this.privRequestSession.onSpeechContext(),await l;const d=await this.fetchConnection();return this.privDeferralMap.add(this.privRequestSession.requestId,p),await this.sendBaseRequest(d,n,this.scenarioFrom(c),u),this.receiveMessage(),p.promise}catch(p){throw p}}async sendBaseRequest(n,c,u,l){const p={scenario:u};return l?p.profileIds=[l.profileId]:p.maxPageSize=-1,n.send(new i.SpeechConnectionMessage(t.MessageType.Text,`speaker.profile.${c}`,this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(p)))}extractSpeakerContext(n){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:n.profileIds,scenario:n.scenario}}handlePhrasesResponse(n,c){if(this.privDeferralMap.getId(c))if(n.status.statusCode.toLowerCase()!=="success"){const u=r.ResultReason.Canceled,l=new r.VoiceProfilePhraseResult(u,n.status.statusCode,n.passPhraseType,[]);this.privDeferralMap.complete(c,l)}else if(n.phrases&&n.phrases.length>0){const u=r.ResultReason.EnrollingVoiceProfile,l=new r.VoiceProfilePhraseResult(u,n.status.statusCode,n.passPhraseType,n.phrases);this.privDeferralMap.complete(c,l)}else throw new Error("Voice Profile get activation phrases failed, no phrases received");else throw new Error(`Voice Profile get activation phrases request for requestID ${c} not found`)}handleCreateResponse(n,c){if(n.profiles&&n.profiles.length>0)if(this.privDeferralMap.getId(c)){const u=n.profiles.map(l=>l.profileId);this.privDeferralMap.complete(c,u)}else throw new Error(`Voice Profile create request for requestID ${c} not found`);else throw new Error("Voice Profile create failed, no profile id received")}handleResultResponse(n,c){if(this.privDeferralMap.getId(c)){const u=n.operation.toLowerCase()==="delete"?r.ResultReason.DeletedVoiceProfile:r.ResultReason.ResetVoiceProfile,l=n.status.statusCode.toLowerCase()==="success"?u:r.ResultReason.Canceled,p=new r.VoiceProfileResult(l,`statusCode: ${n.status.statusCode}, errorDetails: ${n.status.reason}`);this.privDeferralMap.complete(c,p)}else throw new Error(`Voice Profile create request for requestID ${c} not found`)}handleFetchResponse(n,c){if(this.privDeferralMap.getId(c)&&n.profiles[0]){if(this.privExpectedProfileId&&n.profiles.length===1&&n.profiles[0].profileId===this.privExpectedProfileId){this.privExpectedProfileId=void 0;const u=n.profiles[0],l=new r.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(u.enrollmentStatus),JSON.stringify(u),n.status.reason);this.privDeferralMap.complete(c,l)}else if(n.profiles.length>0){const u=n.profiles,l=[];for(const p of u)l.push(new r.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(p.enrollmentStatus),JSON.stringify(p),n.status.reason));this.privDeferralMap.complete(c,l)}}else throw new Error(`Voice Profile fetch request for requestID ${c} not found`)}enrollmentReasonFrom(n){switch(n.toLowerCase()){case"enrolled":return r.ResultReason.EnrolledVoiceProfile;case"invalidlocale":case"invalidphrase":case"invalidaudioformat":case"invalidscenario":case"invalidprofilecount":case"invalidoperation":case"audiotooshort":case"audiotoolong":case"toomanyenrollments":case"storageconflict":case"profilenotfound":case"incompatibleprofiles":case"incompleteenrollment":return r.ResultReason.Canceled;default:return r.ResultReason.EnrollingVoiceProfile}}scenarioFrom(n){return n===r.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":n===r.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"}};return ls.VoiceServiceRecognizer=a,ls}var Fa={},Gf;function kb(){return Gf||(Gf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.type=e.connectivity=e.Device=e.OS=e.System=e.Context=e.SpeechServiceConfig=void 0;class t{constructor(n){this.context=n}serialize(){return JSON.stringify(this,(n,c)=>{if(c&&typeof c=="object"&&!Array.isArray(c)){const u={};for(const l in c)Object.hasOwnProperty.call(c,l)&&(u[l&&l.charAt(0).toLowerCase()+l.substring(1)]=c[l]);return u}return c})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(n){this.recognition=n.toLowerCase()}}e.SpeechServiceConfig=t;class r{constructor(n){this.system=new o,this.os=n}}e.Context=r;class o{constructor(){const n="1.44.1";this.name="SpeechSDK",this.version=n,this.build="JavaScript",this.lang="JavaScript"}}e.System=o;class i{constructor(n,c,u){this.platform=n,this.name=c,this.version=u}}e.OS=i;class a{constructor(n,c,u){this.manufacturer=n,this.model=c,this.version=u}}e.Device=a,function(s){s.Bluetooth="Bluetooth",s.Wired="Wired",s.WiFi="WiFi",s.Cellular="Cellular",s.InBuilt="InBuilt",s.Unknown="Unknown"}(e.connectivity||(e.connectivity={})),function(s){s.Phone="Phone",s.Speaker="Speaker",s.Car="Car",s.Headset="Headset",s.Thermostat="Thermostat",s.Microphones="Microphones",s.Deskphone="Deskphone",s.RemoteControl="RemoteControl",s.Unknown="Unknown",s.File="File",s.Stream="Stream"}(e.type||(e.type={}))}(Fa)),Fa}var Qf;function k(){return Qf||(Qf=1,function(e){var t=ot&&ot.__createBinding||(Object.create?function(a,s,n,c){c===void 0&&(c=n),Object.defineProperty(a,c,{enumerable:!0,get:function(){return s[n]}})}:function(a,s,n,c){c===void 0&&(c=n),a[c]=s[n]}),r=ot&&ot.__exportStar||function(a,s){for(var n in a)n!=="default"&&!Object.prototype.hasOwnProperty.call(s,n)&&t(s,a,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.AutoDetectSourceLanguagesOpenRangeOptionName=e.ForceDictationPropertyName=e.ServicePropertiesPropertyName=e.CancellationErrorCodePropertyName=e.OutputFormatPropertyName=e.SpeechSynthesisAdapter=e.AvatarSynthesisAdapter=void 0,r(aC(),e),r(cC(),e),r(Do(),e),r(uC(),e),r(lC(),e),r(lR(),e),r(pR(),e),r(va(),e),r(PR(),e),r(RR(),e),r(bR(),e),r(wR(),e),r(ER(),e),r(IR(),e),r(AR(),e),r(TR(),e),r(_R(),e),r(rh(),e),r(kR(),e),r(OR(),e),r(MR(),e),r(DR(),e),r(NR(),e),r(xR(),e),r(zR(),e),r(LR(),e),r(jR(),e),r(qR(),e),r(BR(),e),r(UR(),e),r($R(),e),r(VR(),e),r(WR(),e),r(HR(),e),r(KR(),e),r(JR(),e),r(QR(),e),r(ZR(),e),r(eb(),e),r(sb(),e),r(ob(),e),r(yb(),e),r(Lf(),e),r(Cb(),e),r(Pb(),e);var o=Rb();Object.defineProperty(e,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return o.AvatarSynthesisAdapter}});var i=bb();Object.defineProperty(e,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return i.SpeechSynthesisAdapter}}),r(wb(),e),r(Eb(),e),r(Ib(),e),r(Ab(),e),r(Tb(),e),r(_b(),e),r(kb(),e),e.OutputFormatPropertyName="OutputFormat",e.CancellationErrorCodePropertyName="CancellationErrorCode",e.ServicePropertiesPropertyName="ServiceProperties",e.ForceDictationPropertyName="ForceDictation",e.AutoDetectSourceLanguagesOpenRangeOptionName="UND"}(ot)),ot}var Yf;function Ob(){return Yf||(Yf=1,function(e){var t=st&&st.__createBinding||(Object.create?function(i,a,s,n){n===void 0&&(n=s),Object.defineProperty(i,n,{enumerable:!0,get:function(){return a[s]}})}:function(i,a,s,n){n===void 0&&(n=s),i[n]=a[s]}),r=st&&st.__exportStar||function(i,a){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&t(a,i,s)};Object.defineProperty(e,"__esModule",{value:!0});const o=k();new o.AgentConfig,r(T(),e)}(st)),st}var ps=Ob();const Mb=Gt.Provider,Db=Gt.Root,Nb=Gt.Trigger,Zf=ae.forwardRef(({className:e,sideOffset:t=4,...r},o)=>C.jsx(Gt.Content,{ref:o,sideOffset:t,className:Zt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));Zf.displayName=Gt.Content.displayName;const xb={en:"en-US",es:"es-ES",pt:"pt-PT",fr:"fr-FR",de:"de-DE",zh:"zh-CN",ja:"ja-JP",hi:"hi-IN",ar:"ar-SA",ru:"ru-RU"};function Ba({avatarName:e,disabled:t=!1,voiceMode:r,setSpokenText:o,setIsSpeaking:i,setInterruptReplica:a,region:s,speechKey:n}){const[c,u]=I.useState(!1),[l,p]=I.useState(!1),[d,h]=I.useState(null),[f,g]=I.useState("en");I.useEffect(()=>{typeof window<"u"&&g(localStorage.getItem("lang")||"en")},[]);const m=c?`You're now talking to ${e}`:`Click here to talk to ${e}`;I.useEffect(()=>(c?v():y(),()=>{y()}),[c]);const v=async()=>{try{const P=ps.SpeechConfig.fromSubscription(n,s);P.speechRecognitionLanguage=xb[f||"en"];const b=ps.AudioConfig.fromDefaultMicrophoneInput(),w=new ps.SpeechRecognizer(P,b);w.recognizing=(A,E)=>{console.log(`RECOGNIZING: Text=${E.result.text}`)},w.recognized=(A,E)=>{E.result.reason===ps.ResultReason.RecognizedSpeech&&(console.log(`RECOGNIZED: Text=${E.result.text}`),E.result.text&&(o(E.result.text),u(!1),i(!1),a(!1)))},w.canceled=(A,E)=>{console.log(`CANCELED: Reason=${E.reason}`),E.reason===ps.CancellationReason.Error&&console.error(`ERROR: Details=${E.errorDetails}`),u(!1),i(!1)},w.sessionStopped=()=>{u(!1),i(!1)},await w.startContinuousRecognitionAsync(),h(w),i(!0),a(!0)}catch(P){console.error("Error starting continuous recognition:",P),u(!1),i(!1)}},y=async()=>{if(d)try{await d.stopContinuousRecognitionAsync(),d.close(),h(null)}catch(P){console.error("Error stopping recognition:",P)}},S=()=>{t||l||u(!c)};return r?C.jsx(Mb,{children:C.jsxs(Db,{children:[C.jsx(Nb,{asChild:!0,children:C.jsx(ke,{variant:"outline",size:"icon",onClick:S,disabled:t||l||!1,className:"rounded-full bg-primary hover:bg-secondary h-9 w-9",children:l?C.jsx(X.Loader2,{className:"w-6 h-6 text-white animate-spin"}):c?C.jsx(X.Mic,{className:"w-6 h-6 text-white"}):C.jsx(X.MicOff,{className:"w-6 h-6 text-white"})})}),C.jsx(Zf,{children:C.jsx("p",{children:m})})]})}):null}const Xf=async(e,t="",r="",o="chat",i="",a=0,s=1,n="en",c)=>{for(let u=0;u<s;u++){const l=new Headers;l.append("Accept","application/json");const p=e+"Language: "+n,d="52533633434137384342",h=new FormData;h.append("Input",p),h.append("UserId",t||d),h.append("BusinessId",r),h.append("Intent",o),h.append("SessionId",i),h.append("Platform","EF0306CD"),c&&c.size>0?(h.append("Files",c),console.log("File appended to FormData")):console.log("No file to append");const f=new AbortController,g=setTimeout(()=>f.abort(),9e4),m={method:"POST",headers:l,body:h,signal:f.signal};try{const y=await fetch("https://developmentapis.azure-api.net/sandbox/v1/api/AI/assistant",m);if(clearTimeout(g),!y.ok){const P=await y.json();throw new Error(P?.Message||`HTTP error! Status: ${y.status}`)}const S=await y.json();if(S.Success&&(S.Data?.Message===null||S.Data?.Message.toUpperCase()==="INVALID JSON"||S.Data?.Message==="local variable 'result' referenced before assignment"||S.Data?.Message==="Object reference not set to an instance of an object."||S.Data?.Message?.toLowerCase().includes("exception thrown"))){console.warn(`Attempt ${u+1}: Success but received null data. Retrying...`),a>0&&await new Promise(P=>setTimeout(P,a));continue}return S}catch(v){if(clearTimeout(g),v instanceof Error&&v.name==="AbortError")return console.error("Request timed out after 90 seconds"),{Success:!1,Message:"ERROR: API timed out",Data:null};console.error("Error in chat API:",v)}}return{Success:!1,Message:"API call failed after all retries",Data:null}},zb=()=>"https://developmentapis.azure-api.net/sandbox/v1/api",Ua=e=>{const t=zb().replace(/\/$/,"");let r=e.startsWith("/")?e:`/${e}`;return t.endsWith("/api")&&r.startsWith("/api/")&&(r=r.replace(/^\/api/,"")),`${t}${r}`},Lb=async(e,t,r,o)=>{const a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Input:e,UserId:t,BusinessId:r,Accepted:o})};let s;try{const n=await fetch(Ua("/api/AI/training"),a);if(!n.ok){const c=await n.text();throw console.error("Error details:",c),new Error(`Failed: ${n.statusText} - ${c}`)}if(n.headers.get("content-length")==="0")s={};else{const c=n.headers.get("content-type");c&&c.includes("application/json")?s=await n.json():console.error("Unexpected response format:",c)}}catch(n){console.error("Saving chat error:",n)}return s},jb=({onStart:e,loading:t,buttonText:r="Start Conversation",videoRef:o,platform:i,replicaId:a,containerClassName:s="",imageHeight:n="auto",buttonSize:c="md",learningPrompts:u,onPromptClick:l,userCredits:p,avatars:d,personaName:h,config:f})=>{const[g,m]=I.useState("en");I.useEffect(()=>{typeof window<"u"&&m(localStorage.getItem("lang")||"en")},[]);const[v,y]=I.useState({loading:"Loading...",avatarNotFound:"Avatar not found"}),S=d.find(b=>b.ExternalId===a),P={sm:"text-sm px-4 py-2",md:"text-base px-6 py-3",lg:"text-lg px-8 py-4"};return I.useEffect(()=>{(async()=>{if(g!=="en"){const[w,A]=await Os(["Loading...","Avatar not found"],g,"en",f?.azureTranslatorKey||"",f?.azureTranslatorEndpoint||"",f?.azureTranslatorRegion||"");y({loading:w,avatarNotFound:A})}else y({loading:"Loading...",avatarNotFound:"Avatar not found"})})()},[g]),C.jsxs("div",{className:`flex flex-col items-center justify-center ${s}`,children:[C.jsx("div",{className:`w-full ${n} max-h-[300px] mb-6 relative`,children:S?C.jsxs(C.Fragment,{children:[C.jsx("img",{ref:o,src:S.ImageUrl,alt:S.Name,className:"w-full h-full object-cover rounded-lg"}),C.jsxs("div",{className:"absolute top-3 right-3 flex items-center bg-black/70 px-2 py-1 rounded-full text-white text-xs font-medium shadow-md",children:[C.jsxs("div",{className:"relative flex h-3 w-3 mr-1.5",children:[C.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-500 opacity-75"}),C.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-green-600"})]}),C.jsx("span",{children:"LIVE"})]}),C.jsxs("div",{className:"absolute bottom-3 left-3 right-3 bg-gradient-to-t from-black/70 to-transparent p-3 rounded-b-lg",children:[C.jsx("h3",{className:"text-white font-semibold text-sm",children:S.Name}),C.jsx("p",{className:"text-white/80 text-xs",children:h})]})]}):C.jsx("div",{className:"w-full h-full bg-light rounded-lg flex items-center justify-center",children:C.jsx("p",{className:"text-secondary",children:v.avatarNotFound})})}),C.jsx("button",{onClick:e,disabled:t||p!==void 0&&p<=0,className:`bg-primary text-white rounded-full font-semibold hover:bg-secondary transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${P[c]}`,children:t?v.loading:r}),u&&u.length>0&&C.jsxs("div",{className:"mt-6 w-full",children:[C.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Try asking about:"}),C.jsx("div",{className:"space-y-2",children:u.map((b,w)=>C.jsx("button",{onClick:()=>l?.(b),className:"w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:b},w))})]})]})},ev=({id:e,style:t={}})=>{const r=oe.useVideoTrack(e),o=r?.isOff,[i,a]=I.useState(!1),s=I.useRef(null);return I.useEffect(()=>{const n=s.current;if(!n)return;const c=()=>a(!0);return n.addEventListener("canplay",c),()=>{n.removeEventListener("canplay",c)}},[r]),C.jsxs("div",{className:`w-full rounded-lg overflow-hidden bg-slate-100 relative transition-all duration-300 mx-auto\r
                    h-[200px] sm:h-[250px] md:h-[350px] lg:h-[450px] xl:h-[500px]`,style:t,children:[e&&C.jsx(oe.DailyVideo,{automirror:!0,sessionId:e,type:"video",ref:s,style:{width:"100%",height:"100%",objectFit:"cover",display:o||!i?"none":"block"}}),!i&&!o&&C.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex items-center justify-center bg-slate-100 z-10",children:C.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[C.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),C.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})}),o&&C.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex items-center justify-center bg-slate-100 z-5",children:C.jsx("svg",{className:"h-1/2 w-auto",width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:C.jsxs("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:[C.jsx("path",{d:"M18.571,4 C19.142,4 19.557,4.23 19.815,4.689 C20.073,5.148 20.073,5.622 19.815,6.111 L16,12 L19.815,17.889 C20.073,18.377 20.073,18.852 19.815,19.311 C19.557,19.77 19.142,20 18.571,20 L5.429,20 C4.857,20 4.443,19.77 4.185,19.311 C3.927,18.852 3.927,18.377 4.185,17.889 L8,12 L4.185,6.111 C3.927,5.622 3.927,5.148 4.185,4.689 C4.443,4.23 4.857,4 5.429,4 L18.571,4 Z",fill:"#555555"}),C.jsx("line",{x1:"4",y1:"4",x2:"20",y2:"20",stroke:"#E92A09",strokeWidth:"2.5",strokeLinecap:"round"})]})})})]})},qb=({handleJoin:e,handleEnd:t,platform:r,setScreen:o,containerClassName:i="",videoDimensions:a={width:"100%",height:"auto"},buttonsSize:s="md"})=>{const n=oe.useLocalSessionId(),c=oe.useDaily();I.useEffect(()=>{(async()=>{if(c){const p=c?.meetingState();if(p==="new"||p==="loading")try{c.startCamera({startVideoOff:!0,startAudioOff:!0}),o("call")}catch(d){console.warn("Failed to start camera:",d)}else console.log("Call already started, skipping startCamera()")}})()},[c,n]);const u={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return C.jsxs(mc.motion.div,{className:`flex flex-col items-center ${i}`,initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[C.jsxs("div",{className:"mb-4 flex flex-col items-center justify-center gap-4 text-center w-full max-w-2xl mx-auto mt-4 px-2",children:[C.jsx("h2",{className:"text-xl font-bold text-secondary mb-1",children:"Check your camera and microphone"}),C.jsx("p",{className:"text-sm text-secondary",children:"Make sure your devices are working properly before joining"})]}),C.jsx("div",{className:"w-full max-w-lg mb-6 rounded-lg border border-gray-300 overflow-hidden bg-gray-100",children:C.jsx("div",{className:"p-8 flex items-center justify-center bg-gradient-to-b from-gray-800 to-primary/60 text-white",children:C.jsxs("div",{className:"text-center",children:[C.jsx("div",{className:"mx-auto h-24 w-24 rounded-full bg-black/80 flex items-center justify-center mb-4",children:C.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[C.jsx("path",{d:"M23 7l-7 5 7 5V7z"}),C.jsx("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})]})}),C.jsx("div",{className:"relative rounded-xl border-4 border-primary overflow-hidden shadow-lg",style:{width:a.width||"100%",height:a.height||"auto"},children:C.jsx(ev,{id:n})})]})})}),C.jsxs("div",{className:`flex flex-wrap gap-4 mt-2 justify-center ${s==="sm"?"scale-90":s==="lg"?"scale-110":""}`,children:[C.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-black/5 rounded-md",children:[C.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[C.jsx("path",{d:"M23 7l-7 5 7 5V7z"}),C.jsx("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})]}),C.jsx("span",{className:"text-sm",children:"Camera: Ready"})]}),C.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-black/5 rounded-md",children:[C.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[C.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),C.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),C.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),C.jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]}),C.jsx("span",{className:"text-sm",children:"Microphone: Ready"})]})]}),C.jsxs("div",{className:"flex gap-4 mt-6",children:[C.jsx("button",{onClick:t,className:`border border-primary text-primary rounded-md hover:bg-secondary transition ${u[s]}`,children:"Cancel"}),C.jsx("button",{onClick:e,className:`bg-primary hover:bg-secondary text-white rounded-md transition ${u[s]}`,children:"Join Conversation"})]})]})},Fb=({actionLabel:e,onAction:t,cancelLabel:r,onCancel:o,chatLabel:i,onChat:a,chatVisible:s=!1,platform:n,setInterruptReplica:c,setIsSpeaking:u,setSpokenText:l,region:p,speechKey:d})=>{oe.useDaily();const{currentCam:h,currentMic:f,refreshDevices:g}=oe.useDevices(),m=oe.useLocalSessionId(),v=oe.useVideoTrack(m),y=oe.useAudioTrack(m);v.isOff,y.isOff;const[S,P]=I.useState(!1);return I.useEffect(()=>{(()=>{document.querySelectorAll("[data-replit-metadata]").forEach(A=>{A.hasAttribute("data-replit-metadata")&&A.removeAttribute("data-replit-metadata")})})()},[]),oe.useDailyEvent("camera-error",I.useCallback(()=>{P(!0)},[])),C.jsxs("div",{className:"mt-2 p-2 rounded-lg max-w-md flex gap-4 justify-around items-center mx-auto bg-primary",children:[C.jsx("div",{className:"flex items-center",children:C.jsx(Ba,{avatarName:n==="university"?"Instructor":n==="pr"?"PR Strategist":n==="business_advisor"?"Medical Advisor":n==="survey"?"AI Surveyor":n==="concierge"?"Concierge":"Business Expert",disabled:!1,voiceMode:!0,setSpokenText:l,setIsSpeaking:u,setInterruptReplica:c,region:p,speechKey:d})}),e&&e==="End Conversation"&&C.jsx("button",{onClick:t,disabled:S||(!h||!f)&&n!=="home"&&n!=="university"&&n!=="concierge"&&n!=="pr"&&n!=="business_advisor"&&n!=="survey",className:"flex items-center justify-center p-1 rounded-full border border-white text-white w-10 h-10",children:C.jsx(lg,{className:"w-6 h-6"})})]})},Bb=({conversationId:e,platform:t,videoMode:r,endConv:o,onAction:i,videoHeight:a="auto",aspectRatio:s="16:9",setInterruptReplica:n,currentScript:c,interruptReplica:u,personaName:l,config:p})=>{const d=oe.useDaily(),h=oe.useParticipantIds({filter:"remote"}),[f,g]=I.useState("full"),[m,v]=I.useState([]),[y,S]=I.useState(!1),[P,b]=I.useState("en");I.useEffect(()=>{typeof window<"u"&&b(localStorage.getItem("lang")||"en")},[]);const w=oe.useAppMessage({onAppMessage:I.useCallback(_=>{const z=_.data;v(F=>[...F,z])},[])}),[A,E]=I.useState({waiting:`${l} will be here shortly...`,endConversation:"Ending Conversation..."});I.useEffect(()=>{(async()=>{if(P!=="en"){const[z,F]=await Os([`${l} will be here shortly...`,"Ending Conversation..."],P,"en",p?.azureTranslatorKey||"",p?.azureTranslatorEndpoint||"",p?.azureTranslatorRegion||"");E({waiting:z,endConversation:F})}else E({waiting:`${l} will be here shortly...`,endConversation:"Ending Conversation..."})})()},[P]);const D=_=>_?_.replace(/\*\*/g,"").replace(/[#_][^\s]+/g,"").replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"").replace(/[^\w\s.,!?'"-]/g,"").replace(/\s+/g," ").trim():"";I.useEffect(()=>{const _=()=>S(!0);return d&&d.on("joined-meeting",_),()=>{d&&d.off("joined-meeting",_)}},[d]),I.useEffect(()=>{try{if(d&&y&&c){n(!1);const _=D(c);R(_)}}catch(_){console.error("Error sending echo interaction:",_)}},[c,y]),I.useEffect(()=>{d&&y&&u&&M()},[u]),I.useEffect(()=>{r&&g(r)},[r]);const R=_=>{const z={message_type:"conversation",event_type:"conversation.echo",conversation_id:e,properties:{modality:"text",text:`${_}`}};console.log("Sending Echo Interaction:",z),w(z,"*")},M=()=>{const _={message_type:"conversation",event_type:"conversation.interrupt",conversation_id:e};console.log("Sending Echo Interaction:",_),w(_,"*")};return C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"flex flex-col items-center justify-center gap-4 text-center mx-auto px-2 h-full overflow-hidden",children:C.jsx("div",{className:"relative w-full h-full rounded-xl border-4 border-neutral overflow-hidden shadow-lg",children:h.length>0?C.jsx("div",{className:"relative w-full h-full",style:{backgroundColor:"#000",position:"relative",overflow:"hidden"},children:C.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},children:C.jsx(ev,{id:h[0],style:{borderRadius:"0px",objectFit:"contain",width:"100%",height:"100%",backgroundColor:"#000"}})})}):C.jsx("div",{className:"relative flex justify-center items-center w-full h-full",style:{backgroundColor:"#000",width:"100%",height:"100%",position:"relative"},children:C.jsx("div",{className:"absolute inset-0 flex justify-center items-center",children:C.jsx("h2",{className:"text-white text-xl text-center px-4",children:o?A.endConversation:A.waiting})})})})}),C.jsx(oe.DailyAudio,{})]})},Ub=({conversation:e,handleEnd:t,platform:r,videoMode:o,endConv:i,chatVisible:a,toggleChat:s,containerClassName:n="",videoHeight:c="auto",controlsSize:u="md",aspectRatio:l="16:9",setInterruptReplica:p,currentScript:d,setCurrentScript:h,interruptReplica:f,setIsSpeaking:g,setSpokenText:m,region:v,speechKey:y,personaName:S,config:P})=>{const b=oe.useDaily();I.useEffect(()=>{(()=>{document.querySelectorAll("[data-replit-metadata]").forEach(_=>{_.hasAttribute("data-replit-metadata")&&_.removeAttribute("data-replit-metadata")})})()},[]),I.useEffect(()=>{if(e&&b){const{conversation_url:R}=e;b.join({url:R})}},[b,e]);const w=async()=>{await b?.leave(),t()},A={sm:"scale-75",md:"",lg:"scale-125"},E="bottom-4",D=()=>c==="auto"?"min-h-[360px]":c;return C.jsx("div",{className:`flex flex-col w-full h-full relative ${n}`,children:C.jsxs("div",{className:"flex-1 w-full h-full relative overflow-hidden",children:[C.jsx(Bb,{conversationId:e.conversation_id,platform:r,videoMode:o,endConv:i,onAction:w,videoHeight:D(),aspectRatio:l,setInterruptReplica:p,currentScript:d,interruptReplica:f,config:P,personaName:S}),C.jsx("div",{className:`absolute ${E} left-0 right-0 z-10 flex justify-center ${A[u]}`,children:C.jsx(Fb,{actionLabel:"End Conversation",onAction:w,platform:r,chatLabel:"Open Chat",onChat:s,chatVisible:a,setInterruptReplica:p,setIsSpeaking:g,setSpokenText:m,region:v,speechKey:y})})]})})},$b=async({replicaId:e,personaId:t,conversationName:r,conversationalContext:o,customGreeting:i,language:a,apiKey:s})=>{const n={method:"POST",headers:{"Content-Type":"application/json","x-api-key":s},body:JSON.stringify({replica_id:e,persona_id:t,conversation_name:r,conversational_context:o,custom_greeting:i,properties:{enable_recording:!1,participant_absent_timeout:180,language:a}})};try{const c=await fetch("https://tavusapi.com/v2/conversations",n);if(!c.ok){const l=c.headers.get("content-type");let p;throw l&&l.includes("application/json")?p=await c.json():p={message:await c.text()},new Error(p?.message||`HTTP error! Status: ${c.status}`)}return await c.json()}catch(c){throw console.error("Error creating Tavus conversation:",c),c}},tv=async({conversationId:e,apiKey:t})=>{const r={method:"POST",headers:{"x-api-key":t}};try{await fetch(`https://tavusapi.com/v2/conversations/${e}/end`,r)}catch{}},rv=async()=>{const e=new Headers;e.append("Accept","application/json");const t={method:"GET",headers:e,redirect:"follow"};let r;try{const o=await fetch(Ua("/api/Avatar/get/all"),t);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);r=o.headers.get("content-length")==="0"?{Success:!0,Data:[]}:await o.json()}catch(o){console.error("Error fetching avatars:",o)}return r},N=e=>typeof e=="string",ds=()=>{let e,t;const r=new Promise((o,i)=>{e=o,t=i});return r.resolve=e,r.reject=t,r},nv=e=>e==null?"":""+e,Vb=(e,t,r)=>{e.forEach(o=>{t[o]&&(r[o]=t[o])})},Wb=/###/g,iv=e=>e&&e.indexOf("###")>-1?e.replace(Wb,"."):e,sv=e=>!e||N(e),hs=(e,t,r)=>{const o=N(t)?t.split("."):t;let i=0;for(;i<o.length-1;){if(sv(e))return{};const a=iv(o[i]);!e[a]&&r&&(e[a]=new r),Object.prototype.hasOwnProperty.call(e,a)?e=e[a]:e={},++i}return sv(e)?{}:{obj:e,k:iv(o[i])}},ov=(e,t,r)=>{const{obj:o,k:i}=hs(e,t,Object);if(o!==void 0||t.length===1){o[i]=r;return}let a=t[t.length-1],s=t.slice(0,t.length-1),n=hs(e,s,Object);for(;n.obj===void 0&&s.length;)a=`${s[s.length-1]}.${a}`,s=s.slice(0,s.length-1),n=hs(e,s,Object),n?.obj&&typeof n.obj[`${n.k}.${a}`]<"u"&&(n.obj=void 0);n.obj[`${n.k}.${a}`]=r},Hb=(e,t,r,o)=>{const{obj:i,k:a}=hs(e,t,Object);i[a]=i[a]||[],i[a].push(r)},xs=(e,t)=>{const{obj:r,k:o}=hs(e,t);if(r&&Object.prototype.hasOwnProperty.call(r,o))return r[o]},Kb=(e,t,r)=>{const o=xs(e,r);return o!==void 0?o:xs(t,r)},av=(e,t,r)=>{for(const o in t)o!=="__proto__"&&o!=="constructor"&&(o in e?N(e[o])||e[o]instanceof String||N(t[o])||t[o]instanceof String?r&&(e[o]=t[o]):av(e[o],t[o],r):e[o]=t[o]);return e},Ht=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var Jb={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const Gb=e=>N(e)?e.replace(/[&<>"'\/]/g,t=>Jb[t]):e;class Qb{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const r=this.regExpMap.get(t);if(r!==void 0)return r;const o=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,o),this.regExpQueue.push(t),o}}const Yb=[" ",",","?","!",";"],Zb=new Qb(20),Xb=(e,t,r)=>{t=t||"",r=r||"";const o=Yb.filter(s=>t.indexOf(s)<0&&r.indexOf(s)<0);if(o.length===0)return!0;const i=Zb.getRegExp(`(${o.map(s=>s==="?"?"\\?":s).join("|")})`);let a=!i.test(e);if(!a){const s=e.indexOf(r);s>0&&!i.test(e.substring(0,s))&&(a=!0)}return a},$a=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!e)return;if(e[t])return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0;const o=t.split(r);let i=e;for(let a=0;a<o.length;){if(!i||typeof i!="object")return;let s,n="";for(let c=a;c<o.length;++c)if(c!==a&&(n+=r),n+=o[c],s=i[n],s!==void 0){if(["string","number","boolean"].indexOf(typeof s)>-1&&c<o.length-1)continue;a+=c-a+1;break}i=s}return i},zs=e=>e?.replace("_","-"),ew={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console?.[e]?.apply?.(console,t)}};class Ls{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(t,r)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=r.prefix||"i18next:",this.logger=t||ew,this.options=r,this.debug=r.debug}log(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return this.forward(r,"log","",!0)}warn(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return this.forward(r,"warn","",!0)}error(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return this.forward(r,"error","")}deprecate(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return this.forward(r,"warn","WARNING DEPRECATED: ",!0)}forward(t,r,o,i){return i&&!this.debug?null:(N(t[0])&&(t[0]=`${o}${this.prefix} ${t[0]}`),this.logger[r](t))}create(t){return new Ls(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new Ls(this.logger,t)}}var De=new Ls;class js{constructor(){this.observers={}}on(t,r){return t.split(" ").forEach(o=>{this.observers[o]||(this.observers[o]=new Map);const i=this.observers[o].get(r)||0;this.observers[o].set(r,i+1)}),this}off(t,r){if(this.observers[t]){if(!r){delete this.observers[t];return}this.observers[t].delete(r)}}emit(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];this.observers[t]&&Array.from(this.observers[t].entries()).forEach(s=>{let[n,c]=s;for(let u=0;u<c;u++)n(...o)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(s=>{let[n,c]=s;for(let u=0;u<c;u++)n.apply(n,[t,...o])})}}class cv extends js{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const r=this.options.ns.indexOf(t);r>-1&&this.options.ns.splice(r,1)}getResource(t,r,o){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,s=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let n;t.indexOf(".")>-1?n=t.split("."):(n=[t,r],o&&(Array.isArray(o)?n.push(...o):N(o)&&a?n.push(...o.split(a)):n.push(o)));const c=xs(this.data,n);return!c&&!r&&!o&&t.indexOf(".")>-1&&(t=n[0],r=n[1],o=n.slice(2).join(".")),c||!s||!N(o)?c:$a(this.data?.[t]?.[r],o,a)}addResource(t,r,o,i){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const s=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator;let n=[t,r];o&&(n=n.concat(s?o.split(s):o)),t.indexOf(".")>-1&&(n=t.split("."),i=r,r=n[1]),this.addNamespaces(r),ov(this.data,n,i),a.silent||this.emit("added",t,r,o,i)}addResources(t,r,o){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const a in o)(N(o[a])||Array.isArray(o[a]))&&this.addResource(t,r,a,o[a],{silent:!0});i.silent||this.emit("added",t,r,o)}addResourceBundle(t,r,o,i,a){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},n=[t,r];t.indexOf(".")>-1&&(n=t.split("."),i=o,o=r,r=n[1]),this.addNamespaces(r);let c=xs(this.data,n)||{};s.skipCopy||(o=JSON.parse(JSON.stringify(o))),i?av(c,o,a):c={...c,...o},ov(this.data,n,c),s.silent||this.emit("added",t,r,o)}removeResourceBundle(t,r){this.hasResourceBundle(t,r)&&delete this.data[t][r],this.removeNamespaces(r),this.emit("removed",t,r)}hasResourceBundle(t,r){return this.getResource(t,r)!==void 0}getResourceBundle(t,r){return r||(r=this.options.defaultNS),this.getResource(t,r)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const r=this.getDataByLanguage(t);return!!(r&&Object.keys(r)||[]).find(i=>r[i]&&Object.keys(r[i]).length>0)}toJSON(){return this.data}}var uv={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,o,i){return e.forEach(a=>{t=this.processors[a]?.process(t,r,o,i)??t}),t}};const lv={},pv=e=>!N(e)&&typeof e!="boolean"&&typeof e!="number";class qs extends js{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Vb(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=De.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};return t==null?!1:this.resolve(t,r)?.res!==void 0}extractFromKey(t,r){let o=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;o===void 0&&(o=":");const i=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let a=r.ns||this.options.defaultNS||[];const s=o&&t.indexOf(o)>-1,n=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!Xb(t,o,i);if(s&&!n){const c=t.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:t,namespaces:N(a)?[a]:a};const u=t.split(o);(o!==i||o===i&&this.options.ns.indexOf(u[0])>-1)&&(a=u.shift()),t=u.join(i)}return{key:t,namespaces:N(a)?[a]:a}}translate(t,r,o){if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);const i=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,a=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:s,namespaces:n}=this.extractFromKey(t[t.length-1],r),c=n[n.length-1],u=r.lng||this.language,l=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u?.toLowerCase()==="cimode"){if(l){const M=r.nsSeparator||this.options.nsSeparator;return i?{res:`${c}${M}${s}`,usedKey:s,exactUsedKey:s,usedLng:u,usedNS:c,usedParams:this.getUsedParamsDetails(r)}:`${c}${M}${s}`}return i?{res:s,usedKey:s,exactUsedKey:s,usedLng:u,usedNS:c,usedParams:this.getUsedParamsDetails(r)}:s}const p=this.resolve(t,r);let d=p?.res;const h=p?.usedKey||s,f=p?.exactUsedKey||s,g=["[object Number]","[object Function]","[object RegExp]"],m=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,v=!this.i18nFormat||this.i18nFormat.handleAsObject,y=r.count!==void 0&&!N(r.count),S=qs.hasDefaultValue(r),P=y?this.pluralResolver.getSuffix(u,r.count,r):"",b=r.ordinal&&y?this.pluralResolver.getSuffix(u,r.count,{ordinal:!1}):"",w=y&&!r.ordinal&&r.count===0,A=w&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${P}`]||r[`defaultValue${b}`]||r.defaultValue;let E=d;v&&!d&&S&&(E=A);const D=pv(E),R=Object.prototype.toString.apply(E);if(v&&E&&D&&g.indexOf(R)<0&&!(N(m)&&Array.isArray(E))){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const M=this.options.returnedObjectHandler?this.options.returnedObjectHandler(h,E,{...r,ns:n}):`key '${s} (${this.language})' returned an object instead of string.`;return i?(p.res=M,p.usedParams=this.getUsedParamsDetails(r),p):M}if(a){const M=Array.isArray(E),_=M?[]:{},z=M?f:h;for(const F in E)if(Object.prototype.hasOwnProperty.call(E,F)){const Q=`${z}${a}${F}`;S&&!d?_[F]=this.translate(Q,{...r,defaultValue:pv(A)?A[F]:void 0,joinArrays:!1,ns:n}):_[F]=this.translate(Q,{...r,joinArrays:!1,ns:n}),_[F]===Q&&(_[F]=E[F])}d=_}}else if(v&&N(m)&&Array.isArray(d))d=d.join(m),d&&(d=this.extendTranslation(d,t,r,o));else{let M=!1,_=!1;!this.isValidLookup(d)&&S&&(M=!0,d=A),this.isValidLookup(d)||(_=!0,d=s);const F=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&_?void 0:d,Q=S&&A!==d&&this.options.updateMissing;if(_||M||Q){if(this.logger.log(Q?"updateKey":"missingKey",u,c,s,Q?A:d),a){const $=this.resolve(s,{...r,keySeparator:!1});$&&$.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ee=[];const re=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&re&&re[0])for(let $=0;$<re.length;$++)ee.push(re[$]);else this.options.saveMissingTo==="all"?ee=this.languageUtils.toResolveHierarchy(r.lng||this.language):ee.push(r.lng||this.language);const me=($,se,H)=>{const $e=S&&H!==d?H:F;this.options.missingKeyHandler?this.options.missingKeyHandler($,c,se,$e,Q,r):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing($,c,se,$e,Q,r),this.emit("missingKey",$,c,se,d)};this.options.saveMissing&&(this.options.saveMissingPlurals&&y?ee.forEach($=>{const se=this.pluralResolver.getSuffixes($,r);w&&r[`defaultValue${this.options.pluralSeparator}zero`]&&se.indexOf(`${this.options.pluralSeparator}zero`)<0&&se.push(`${this.options.pluralSeparator}zero`),se.forEach(H=>{me([$],s+H,r[`defaultValue${H}`]||A)})}):me(ee,s,A))}d=this.extendTranslation(d,t,r,p,o),_&&d===s&&this.options.appendNamespaceToMissingKey&&(d=`${c}:${s}`),(_||M)&&this.options.parseMissingKeyHandler&&(d=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}:${s}`:s,M?d:void 0))}return i?(p.res=d,p.usedParams=this.getUsedParamsDetails(r),p):d}extendTranslation(t,r,o,i,a){var s=this;if(this.i18nFormat?.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...o},o.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!o.skipInterpolation){o.interpolation&&this.interpolator.init({...o,interpolation:{...this.options.interpolation,...o.interpolation}});const u=N(t)&&(o?.interpolation?.skipOnVariables!==void 0?o.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let l;if(u){const d=t.match(this.interpolator.nestingRegexp);l=d&&d.length}let p=o.replace&&!N(o.replace)?o.replace:o;if(this.options.interpolation.defaultVariables&&(p={...this.options.interpolation.defaultVariables,...p}),t=this.interpolator.interpolate(t,p,o.lng||this.language||i.usedLng,o),u){const d=t.match(this.interpolator.nestingRegexp),h=d&&d.length;l<h&&(o.nest=!1)}!o.lng&&i&&i.res&&(o.lng=this.language||i.usedLng),o.nest!==!1&&(t=this.interpolator.nest(t,function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return a?.[0]===h[0]&&!o.context?(s.logger.warn(`It seems you are nesting recursively key: ${h[0]} in key: ${r[0]}`),null):s.translate(...h,r)},o)),o.interpolation&&this.interpolator.reset()}const n=o.postProcess||this.options.postProcess,c=N(n)?[n]:n;return t!=null&&c?.length&&o.applyPostProcessor!==!1&&(t=uv.handle(c,t,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(o)},...o}:o,this)),t}resolve(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o,i,a,s,n;return N(t)&&(t=[t]),t.forEach(c=>{if(this.isValidLookup(o))return;const u=this.extractFromKey(c,r),l=u.key;i=l;let p=u.namespaces;this.options.fallbackNS&&(p=p.concat(this.options.fallbackNS));const d=r.count!==void 0&&!N(r.count),h=d&&!r.ordinal&&r.count===0,f=r.context!==void 0&&(N(r.context)||typeof r.context=="number")&&r.context!=="",g=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);p.forEach(m=>{this.isValidLookup(o)||(n=m,!lv[`${g[0]}-${m}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(n)&&(lv[`${g[0]}-${m}`]=!0,this.logger.warn(`key "${i}" for languages "${g.join(", ")}" won't get resolved as namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),g.forEach(v=>{if(this.isValidLookup(o))return;s=v;const y=[l];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(y,l,v,m,r);else{let P;d&&(P=this.pluralResolver.getSuffix(v,r.count,r));const b=`${this.options.pluralSeparator}zero`,w=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(d&&(y.push(l+P),r.ordinal&&P.indexOf(w)===0&&y.push(l+P.replace(w,this.options.pluralSeparator)),h&&y.push(l+b)),f){const A=`${l}${this.options.contextSeparator}${r.context}`;y.push(A),d&&(y.push(A+P),r.ordinal&&P.indexOf(w)===0&&y.push(A+P.replace(w,this.options.pluralSeparator)),h&&y.push(A+b))}}let S;for(;S=y.pop();)this.isValidLookup(o)||(a=S,o=this.getResource(v,m,S,r))}))})}),{res:o,usedKey:i,exactUsedKey:a,usedLng:s,usedNS:n}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,r,o){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat?.getResource?this.i18nFormat.getResource(t,r,o,i):this.resourceStore.getResource(t,r,o,i)}getUsedParamsDetails(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],o=t.replace&&!N(t.replace);let i=o?t.replace:t;if(o&&typeof t.count<"u"&&(i.count=t.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!o){i={...i};for(const a of r)delete i[a]}return i}static hasDefaultValue(t){const r="defaultValue";for(const o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&r===o.substring(0,r.length)&&t[o]!==void 0)return!0;return!1}}class dv{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=De.create("languageUtils")}getScriptPartFromCode(t){if(t=zs(t),!t||t.indexOf("-")<0)return null;const r=t.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(t){if(t=zs(t),!t||t.indexOf("-")<0)return t;const r=t.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(t){if(N(t)&&t.indexOf("-")>-1){let r;try{r=Intl.getCanonicalLocales(t)[0]}catch{}return r&&this.options.lowerCaseLng&&(r=r.toLowerCase()),r||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let r;return t.forEach(o=>{if(r)return;const i=this.formatLanguageCode(o);(!this.options.supportedLngs||this.isSupportedCode(i))&&(r=i)}),!r&&this.options.supportedLngs&&t.forEach(o=>{if(r)return;const i=this.getLanguagePartFromCode(o);if(this.isSupportedCode(i))return r=i;r=this.options.supportedLngs.find(a=>{if(a===i)return a;if(!(a.indexOf("-")<0&&i.indexOf("-")<0)&&(a.indexOf("-")>0&&i.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===i||a.indexOf(i)===0&&i.length>1))return a})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(t,r){if(!t)return[];if(typeof t=="function"&&(t=t(r)),N(t)&&(t=[t]),Array.isArray(t))return t;if(!r)return t.default||[];let o=t[r];return o||(o=t[this.getScriptPartFromCode(r)]),o||(o=t[this.formatLanguageCode(r)]),o||(o=t[this.getLanguagePartFromCode(r)]),o||(o=t.default),o||[]}toResolveHierarchy(t,r){const o=this.getFallbackCodes(r||this.options.fallbackLng||[],t),i=[],a=s=>{s&&(this.isSupportedCode(s)?i.push(s):this.logger.warn(`rejecting language code not found in supportedLngs: ${s}`))};return N(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&a(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&a(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&a(this.getLanguagePartFromCode(t))):N(t)&&a(this.formatLanguageCode(t)),o.forEach(s=>{i.indexOf(s)<0&&a(this.formatLanguageCode(s))}),i}}const hv={zero:0,one:1,two:2,few:3,many:4,other:5},fv={select:e=>e===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class tw{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=t,this.options=r,this.logger=De.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,r){this.rules[t]=r}clearCache(){this.pluralRulesCache={}}getRule(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=zs(t==="dev"?"en":t),i=r.ordinal?"ordinal":"cardinal",a=JSON.stringify({cleanedCode:o,type:i});if(a in this.pluralRulesCache)return this.pluralRulesCache[a];let s;try{s=new Intl.PluralRules(o,{type:i})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),fv;if(!t.match(/-|_/))return fv;const c=this.languageUtils.getLanguagePartFromCode(t);s=this.getRule(c,r)}return this.pluralRulesCache[a]=s,s}needsPlural(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.getRule(t,r);return o||(o=this.getRule("dev",r)),o?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(t,r){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(t,o).map(i=>`${r}${i}`)}getSuffixes(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.getRule(t,r);return o||(o=this.getRule("dev",r)),o?o.resolvedOptions().pluralCategories.sort((i,a)=>hv[i]-hv[a]).map(i=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${i}`):[]}getSuffix(t,r){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=this.getRule(t,o);return i?`${this.options.prepend}${o.ordinal?`ordinal${this.options.prepend}`:""}${i.select(r)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",r,o))}}const vv=function(e,t,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=Kb(e,t,r);return!a&&i&&N(r)&&(a=$a(e,r,o),a===void 0&&(a=$a(t,r,o))),a},Va=e=>e.replace(/\$/g,"$$$$");class rw{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=De.create("interpolator"),this.options=t,this.format=t?.interpolation?.format||(r=>r),this.init(t)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});const{escape:r,escapeValue:o,useRawValueToEscape:i,prefix:a,prefixEscaped:s,suffix:n,suffixEscaped:c,formatSeparator:u,unescapeSuffix:l,unescapePrefix:p,nestingPrefix:d,nestingPrefixEscaped:h,nestingSuffix:f,nestingSuffixEscaped:g,nestingOptionsSeparator:m,maxReplaces:v,alwaysFormat:y}=t.interpolation;this.escape=r!==void 0?r:Gb,this.escapeValue=o!==void 0?o:!0,this.useRawValueToEscape=i!==void 0?i:!1,this.prefix=a?Ht(a):s||"{{",this.suffix=n?Ht(n):c||"}}",this.formatSeparator=u||",",this.unescapePrefix=l?"":p||"-",this.unescapeSuffix=this.unescapePrefix?"":l||"",this.nestingPrefix=d?Ht(d):h||Ht("$t("),this.nestingSuffix=f?Ht(f):g||Ht(")"),this.nestingOptionsSeparator=m||",",this.maxReplaces=v||1e3,this.alwaysFormat=y!==void 0?y:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(r,o)=>r?.source===o?(r.lastIndex=0,r):new RegExp(o,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,r,o,i){let a,s,n;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=h=>{if(h.indexOf(this.formatSeparator)<0){const v=vv(r,c,h,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(v,void 0,o,{...i,...r,interpolationkey:h}):v}const f=h.split(this.formatSeparator),g=f.shift().trim(),m=f.join(this.formatSeparator).trim();return this.format(vv(r,c,g,this.options.keySeparator,this.options.ignoreJSONStructure),m,o,{...i,...r,interpolationkey:g})};this.resetRegExp();const l=i?.missingInterpolationHandler||this.options.missingInterpolationHandler,p=i?.interpolation?.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:h=>Va(h)},{regex:this.regexp,safeValue:h=>this.escapeValue?Va(this.escape(h)):Va(h)}].forEach(h=>{for(n=0;a=h.regex.exec(t);){const f=a[1].trim();if(s=u(f),s===void 0)if(typeof l=="function"){const m=l(t,a,i);s=N(m)?m:""}else if(i&&Object.prototype.hasOwnProperty.call(i,f))s="";else if(p){s=a[0];continue}else this.logger.warn(`missed to pass in variable ${f} for interpolating ${t}`),s="";else!N(s)&&!this.useRawValueToEscape&&(s=nv(s));const g=h.safeValue(s);if(t=t.replace(a[0],g),p?(h.regex.lastIndex+=s.length,h.regex.lastIndex-=a[0].length):h.regex.lastIndex=0,n++,n>=this.maxReplaces)break}}),t}nest(t,r){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,a,s;const n=(c,u)=>{const l=this.nestingOptionsSeparator;if(c.indexOf(l)<0)return c;const p=c.split(new RegExp(`${l}[ ]*{`));let d=`{${p[1]}`;c=p[0],d=this.interpolate(d,s);const h=d.match(/'/g),f=d.match(/"/g);((h?.length??0)%2===0&&!f||f.length%2!==0)&&(d=d.replace(/'/g,'"'));try{s=JSON.parse(d),u&&(s={...u,...s})}catch(g){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,g),`${c}${l}${d}`}return s.defaultValue&&s.defaultValue.indexOf(this.prefix)>-1&&delete s.defaultValue,c};for(;i=this.nestingRegexp.exec(t);){let c=[];s={...o},s=s.replace&&!N(s.replace)?s.replace:s,s.applyPostProcessor=!1,delete s.defaultValue;let u=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){const l=i[1].split(this.formatSeparator).map(p=>p.trim());i[1]=l.shift(),c=l,u=!0}if(a=r(n.call(this,i[1].trim(),s),s),a&&i[0]===t&&!N(a))return a;N(a)||(a=nv(a)),a||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${t}`),a=""),u&&(a=c.reduce((l,p)=>this.format(l,p,o.lng,{...o,interpolationkey:i[1].trim()}),a.trim())),t=t.replace(i[0],a),this.regexp.lastIndex=0}return t}}const nw=e=>{let t=e.toLowerCase().trim();const r={};if(e.indexOf("(")>-1){const o=e.split("(");t=o[0].toLowerCase().trim();const i=o[1].substring(0,o[1].length-1);t==="currency"&&i.indexOf(":")<0?r.currency||(r.currency=i.trim()):t==="relativetime"&&i.indexOf(":")<0?r.range||(r.range=i.trim()):i.split(";").forEach(s=>{if(s){const[n,...c]=s.split(":"),u=c.join(":").trim().replace(/^'+|'+$/g,""),l=n.trim();r[l]||(r[l]=u),u==="false"&&(r[l]=!1),u==="true"&&(r[l]=!0),isNaN(u)||(r[l]=parseInt(u,10))}})}return{formatName:t,formatOptions:r}},Kt=e=>{const t={};return(r,o,i)=>{let a=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(a={...a,[i.interpolationkey]:void 0});const s=o+JSON.stringify(a);let n=t[s];return n||(n=e(zs(o),i),t[s]=n),n(r)}};class iw{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=De.create("formatter"),this.options=t,this.formats={number:Kt((r,o)=>{const i=new Intl.NumberFormat(r,{...o});return a=>i.format(a)}),currency:Kt((r,o)=>{const i=new Intl.NumberFormat(r,{...o,style:"currency"});return a=>i.format(a)}),datetime:Kt((r,o)=>{const i=new Intl.DateTimeFormat(r,{...o});return a=>i.format(a)}),relativetime:Kt((r,o)=>{const i=new Intl.RelativeTimeFormat(r,{...o});return a=>i.format(a,o.range||"day")}),list:Kt((r,o)=>{const i=new Intl.ListFormat(r,{...o});return a=>i.format(a)})},this.init(t)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=r.interpolation.formatSeparator||","}add(t,r){this.formats[t.toLowerCase().trim()]=r}addCached(t,r){this.formats[t.toLowerCase().trim()]=Kt(r)}format(t,r,o){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=r.split(this.formatSeparator);if(a.length>1&&a[0].indexOf("(")>1&&a[0].indexOf(")")<0&&a.find(n=>n.indexOf(")")>-1)){const n=a.findIndex(c=>c.indexOf(")")>-1);a[0]=[a[0],...a.splice(1,n)].join(this.formatSeparator)}return a.reduce((n,c)=>{const{formatName:u,formatOptions:l}=nw(c);if(this.formats[u]){let p=n;try{const d=i?.formatParams?.[i.interpolationkey]||{},h=d.locale||d.lng||i.locale||i.lng||o;p=this.formats[u](n,h,{...l,...i,...d})}catch(d){this.logger.warn(d)}return p}else this.logger.warn(`there was no format function for ${u}`);return n},t)}}const sw=(e,t)=>{e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)};class ow extends js{constructor(t,r,o){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=t,this.store=r,this.services=o,this.languageUtils=o.languageUtils,this.options=i,this.logger=De.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(o,i.backend,i)}queueLoad(t,r,o,i){const a={},s={},n={},c={};return t.forEach(u=>{let l=!0;r.forEach(p=>{const d=`${u}|${p}`;!o.reload&&this.store.hasResourceBundle(u,p)?this.state[d]=2:this.state[d]<0||(this.state[d]===1?s[d]===void 0&&(s[d]=!0):(this.state[d]=1,l=!1,s[d]===void 0&&(s[d]=!0),a[d]===void 0&&(a[d]=!0),c[p]===void 0&&(c[p]=!0)))}),l||(n[u]=!0)}),(Object.keys(a).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(a),pending:Object.keys(s),toLoadLanguages:Object.keys(n),toLoadNamespaces:Object.keys(c)}}loaded(t,r,o){const i=t.split("|"),a=i[0],s=i[1];r&&this.emit("failedLoading",a,s,r),!r&&o&&this.store.addResourceBundle(a,s,o,void 0,void 0,{skipCopy:!0}),this.state[t]=r?-1:2,r&&o&&(this.state[t]=0);const n={};this.queue.forEach(c=>{Hb(c.loaded,[a],s),sw(c,t),r&&c.errors.push(r),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(u=>{n[u]||(n[u]={});const l=c.loaded[u];l.length&&l.forEach(p=>{n[u][p]===void 0&&(n[u][p]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",n),this.queue=this.queue.filter(c=>!c.done)}read(t,r,o){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;if(!t.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:r,fcName:o,tried:i,wait:a,callback:s});return}this.readingCalls++;const n=(u,l)=>{if(this.readingCalls--,this.waitingReads.length>0){const p=this.waitingReads.shift();this.read(p.lng,p.ns,p.fcName,p.tried,p.wait,p.callback)}if(u&&l&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,t,r,o,i+1,a*2,s)},a);return}s(u,l)},c=this.backend[o].bind(this.backend);if(c.length===2){try{const u=c(t,r);u&&typeof u.then=="function"?u.then(l=>n(null,l)).catch(n):n(null,u)}catch(u){n(u)}return}return c(t,r,n)}prepareLoading(t,r){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();N(t)&&(t=this.languageUtils.toResolveHierarchy(t)),N(r)&&(r=[r]);const a=this.queueLoad(t,r,o,i);if(!a.toLoad.length)return a.pending.length||i(),null;a.toLoad.forEach(s=>{this.loadOne(s)})}load(t,r,o){this.prepareLoading(t,r,{},o)}reload(t,r,o){this.prepareLoading(t,r,{reload:!0},o)}loadOne(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const o=t.split("|"),i=o[0],a=o[1];this.read(i,a,"read",void 0,void 0,(s,n)=>{s&&this.logger.warn(`${r}loading namespace ${a} for language ${i} failed`,s),!s&&n&&this.logger.log(`${r}loaded namespace ${a} for language ${i}`,n),this.loaded(t,s,n)})}saveMissing(t,r,o,i,a){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},n=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${o}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(o==null||o==="")){if(this.backend?.create){const c={...s,isUpdate:a},u=this.backend.create.bind(this.backend);if(u.length<6)try{let l;u.length===5?l=u(t,r,o,i,c):l=u(t,r,o,i),l&&typeof l.then=="function"?l.then(p=>n(null,p)).catch(n):n(null,l)}catch(l){n(l)}else u(t,r,o,i,n,c)}!t||!t[0]||this.store.addResource(t[0],r,o,i)}}}const gv=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if(typeof e[1]=="object"&&(t=e[1]),N(e[1])&&(t.defaultValue=e[1]),N(e[2])&&(t.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const r=e[3]||e[2];Object.keys(r).forEach(o=>{t[o]=r[o]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),mv=e=>(N(e.ns)&&(e.ns=[e.ns]),N(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),N(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs?.indexOf?.("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),typeof e.initImmediate=="boolean"&&(e.initAsync=e.initImmediate),e),Fs=()=>{},aw=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(r=>{typeof e[r]=="function"&&(e[r]=e[r].bind(e))})};class fs extends js{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(super(),this.options=mv(t),this.services={},this.logger=De,this.modules={external:[]},aw(this),r&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,r),this;setTimeout(()=>{this.init(t,r)},0)}}init(){var t=this;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof r=="function"&&(o=r,r={}),r.defaultNS==null&&r.ns&&(N(r.ns)?r.defaultNS=r.ns:r.ns.indexOf("translation")<0&&(r.defaultNS=r.ns[0]));const i=gv();this.options={...i,...this.options,...mv(r)},this.options.interpolation={...i.interpolation,...this.options.interpolation},r.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=r.keySeparator),r.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=r.nsSeparator);const a=l=>l?typeof l=="function"?new l:l:null;if(!this.options.isClone){this.modules.logger?De.init(a(this.modules.logger),this.options):De.init(null,this.options);let l;this.modules.formatter?l=this.modules.formatter:l=iw;const p=new dv(this.options);this.store=new cv(this.options.resources,this.options);const d=this.services;d.logger=De,d.resourceStore=this.store,d.languageUtils=p,d.pluralResolver=new tw(p,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),l&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(d.formatter=a(l),d.formatter.init(d,this.options),this.options.interpolation.format=d.formatter.format.bind(d.formatter)),d.interpolator=new rw(this.options),d.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},d.backendConnector=new ow(a(this.modules.backend),d.resourceStore,d,this.options),d.backendConnector.on("*",function(h){for(var f=arguments.length,g=new Array(f>1?f-1:0),m=1;m<f;m++)g[m-1]=arguments[m];t.emit(h,...g)}),this.modules.languageDetector&&(d.languageDetector=a(this.modules.languageDetector),d.languageDetector.init&&d.languageDetector.init(d,this.options.detection,this.options)),this.modules.i18nFormat&&(d.i18nFormat=a(this.modules.i18nFormat),d.i18nFormat.init&&d.i18nFormat.init(this)),this.translator=new qs(this.services,this.options),this.translator.on("*",function(h){for(var f=arguments.length,g=new Array(f>1?f-1:0),m=1;m<f;m++)g[m-1]=arguments[m];t.emit(h,...g)}),this.modules.external.forEach(h=>{h.init&&h.init(this)})}if(this.format=this.options.interpolation.format,o||(o=Fs),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const l=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);l.length>0&&l[0]!=="dev"&&(this.options.lng=l[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(l=>{this[l]=function(){return t.store[l](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(l=>{this[l]=function(){return t.store[l](...arguments),t}});const c=ds(),u=()=>{const l=(p,d)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),c.resolve(d),o(p,d)};if(this.languages&&!this.isInitialized)return l(null,this.t.bind(this));this.changeLanguage(this.options.lng,l)};return this.options.resources||!this.options.initAsync?u():setTimeout(u,0),c}loadResources(t){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fs;const i=N(t)?t:this.language;if(typeof t=="function"&&(o=t),!this.options.resources||this.options.partialBundledLanguages){if(i?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return o();const a=[],s=n=>{if(!n||n==="cimode")return;this.services.languageUtils.toResolveHierarchy(n).forEach(u=>{u!=="cimode"&&a.indexOf(u)<0&&a.push(u)})};i?s(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(c=>s(c)),this.options.preload?.forEach?.(n=>s(n)),this.services.backendConnector.load(a,this.options.ns,n=>{!n&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),o(n)})}else o(null)}reloadResources(t,r,o){const i=ds();return typeof t=="function"&&(o=t,t=void 0),typeof r=="function"&&(o=r,r=void 0),t||(t=this.languages),r||(r=this.options.ns),o||(o=Fs),this.services.backendConnector.reload(t,r,a=>{i.resolve(),o(a)}),i}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&uv.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1))for(let r=0;r<this.languages.length;r++){const o=this.languages[r];if(!(["cimode","dev"].indexOf(o)>-1)&&this.store.hasLanguageSomeTranslations(o)){this.resolvedLanguage=o;break}}}changeLanguage(t,r){var o=this;this.isLanguageChangingTo=t;const i=ds();this.emit("languageChanging",t);const a=c=>{this.language=c,this.languages=this.services.languageUtils.toResolveHierarchy(c),this.resolvedLanguage=void 0,this.setResolvedLanguage(c)},s=(c,u)=>{u?(a(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,i.resolve(function(){return o.t(...arguments)}),r&&r(c,function(){return o.t(...arguments)})},n=c=>{!t&&!c&&this.services.languageDetector&&(c=[]);const u=N(c)?c:this.services.languageUtils.getBestMatchFromCodes(c);u&&(this.language||a(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector?.cacheUserLanguage?.(u)),this.loadResources(u,l=>{s(l,u)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?n(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(n):this.services.languageDetector.detect(n):n(t),i}getFixedT(t,r,o){var i=this;const a=function(s,n){let c;if(typeof n!="object"){for(var u=arguments.length,l=new Array(u>2?u-2:0),p=2;p<u;p++)l[p-2]=arguments[p];c=i.options.overloadTranslationOptionHandler([s,n].concat(l))}else c={...n};c.lng=c.lng||a.lng,c.lngs=c.lngs||a.lngs,c.ns=c.ns||a.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||o||a.keyPrefix);const d=i.options.keySeparator||".";let h;return c.keyPrefix&&Array.isArray(s)?h=s.map(f=>`${c.keyPrefix}${d}${f}`):h=c.keyPrefix?`${c.keyPrefix}${d}${s}`:s,i.t(h,c)};return N(t)?a.lng=t:a.lngs=t,a.ns=r,a.keyPrefix=o,a}t(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return this.translator?.translate(...r)}exists(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return this.translator?.exists(...r)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const o=r.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,a=this.languages[this.languages.length-1];if(o.toLowerCase()==="cimode")return!0;const s=(n,c)=>{const u=this.services.backendConnector.state[`${n}|${c}`];return u===-1||u===0||u===2};if(r.precheck){const n=r.precheck(this,s);if(n!==void 0)return n}return!!(this.hasResourceBundle(o,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||s(o,t)&&(!i||s(a,t)))}loadNamespaces(t,r){const o=ds();return this.options.ns?(N(t)&&(t=[t]),t.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{o.resolve(),r&&r(i)}),o):(r&&r(),Promise.resolve())}loadLanguages(t,r){const o=ds();N(t)&&(t=[t]);const i=this.options.preload||[],a=t.filter(s=>i.indexOf(s)<0&&this.services.languageUtils.isSupportedCode(s));return a.length?(this.options.preload=i.concat(a),this.loadResources(s=>{o.resolve(),r&&r(s)}),o):(r&&r(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!t)return"rtl";const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],o=this.services?.languageUtils||new dv(gv());return r.indexOf(o.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return new fs(t,r)}cloneInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fs;const o=t.forkResourceStore;o&&delete t.forkResourceStore;const i={...this.options,...t,isClone:!0},a=new fs(i);if((t.debug!==void 0||t.prefix!==void 0)&&(a.logger=a.logger.clone(t)),["store","services","language"].forEach(n=>{a[n]=this[n]}),a.services={...this.services},a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},o){const n=Object.keys(this.store.data).reduce((c,u)=>(c[u]={...this.store.data[u]},Object.keys(c[u]).reduce((l,p)=>(l[p]={...c[u][p]},l),{})),{});a.store=new cv(n,i),a.services.resourceStore=a.store}return a.translator=new qs(a.services,i),a.translator.on("*",function(n){for(var c=arguments.length,u=new Array(c>1?c-1:0),l=1;l<c;l++)u[l-1]=arguments[l];a.emit(n,...u)}),a.init(i,r),a.translator.options=i,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const ce=fs.createInstance();ce.createInstance=fs.createInstance,ce.createInstance,ce.dir,ce.init,ce.loadResources,ce.reloadResources,ce.use,ce.changeLanguage,ce.getFixedT,ce.t,ce.exists,ce.setDefaultNamespace,ce.hasLoadedNamespace,ce.loadNamespaces,ce.loadLanguages;var Bs=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Us=typeof window>"u"||"Deno"in globalThis;function Ae(){}function cw(e,t){return typeof e=="function"?e(t):e}function uw(e){return typeof e=="number"&&e>=0&&e!==1/0}function lw(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Wa(e,t){return typeof e=="function"?e(t):e}function pw(e,t){return typeof e=="function"?e(t):e}function yv(e,t){const{type:r="all",exact:o,fetchStatus:i,predicate:a,queryKey:s,stale:n}=e;if(s){if(o){if(t.queryHash!==Ha(s,t.options))return!1}else if(!gs(t.queryKey,s))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof n=="boolean"&&t.isStale()!==n||i&&i!==t.state.fetchStatus||a&&!a(t))}function Sv(e,t){const{exact:r,status:o,predicate:i,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(r){if(vs(t.options.mutationKey)!==vs(a))return!1}else if(!gs(t.options.mutationKey,a))return!1}return!(o&&t.state.status!==o||i&&!i(t))}function Ha(e,t){return(t?.queryKeyHashFn||vs)(e)}function vs(e){return JSON.stringify(e,(t,r)=>Ja(r)?Object.keys(r).sort().reduce((o,i)=>(o[i]=r[i],o),{}):r)}function gs(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>gs(e[r],t[r])):!1}function Ka(e,t){if(e===t)return e;const r=Cv(e)&&Cv(t);if(r||Ja(e)&&Ja(t)){const o=r?e:Object.keys(e),i=o.length,a=r?t:Object.keys(t),s=a.length,n=r?[]:{},c=new Set(o);let u=0;for(let l=0;l<s;l++){const p=r?l:a[l];(!r&&c.has(p)||r)&&e[p]===void 0&&t[p]===void 0?(n[p]=void 0,u++):(n[p]=Ka(e[p],t[p]),n[p]===e[p]&&e[p]!==void 0&&u++)}return i===s&&u===i?e:n}return t}function Cv(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Ja(e){if(!Pv(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!Pv(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Pv(e){return Object.prototype.toString.call(e)==="[object Object]"}function dw(e){return new Promise(t=>{setTimeout(t,e)})}function hw(e,t,r){if(typeof r.structuralSharing=="function")return r.structuralSharing(e,t);if(r.structuralSharing!==!1){if(process.env.NODE_ENV!=="production")try{return Ka(e,t)}catch(o){throw console.error(`Structural sharing requires data to be JSON serializable. To fix this, turn off structuralSharing or return JSON-serializable data from your queryFn. [${r.queryHash}]: ${o}`),o}return Ka(e,t)}return t}function fw(e,t,r=0){const o=[...e,t];return r&&o.length>r?o.slice(1):o}function vw(e,t,r=0){const o=[t,...e];return r&&o.length>r?o.slice(0,-1):o}var $s=Symbol();function Rv(e,t){return process.env.NODE_ENV!=="production"&&e.queryFn===$s&&console.error(`Attempted to invoke queryFn when set to skipToken. This is likely a configuration error. Query hash: '${e.queryHash}'`),!e.queryFn&&t?.initialPromise?()=>t.initialPromise:!e.queryFn||e.queryFn===$s?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var gw=class extends Bs{#e;#t;#r;constructor(){super(),this.#r=e=>{if(!Us&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},bv=new gw,mw=class extends Bs{#e=!0;#t;#r;constructor(){super(),this.#r=e=>{if(!Us&&window.addEventListener){const t=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#e!==e&&(this.#e=e,this.listeners.forEach(r=>{r(e)}))}isOnline(){return this.#e}},Vs=new mw;function yw(){let e,t;const r=new Promise((i,a)=>{e=i,t=a});r.status="pending",r.catch(()=>{});function o(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{o({status:"fulfilled",value:i}),e(i)},r.reject=i=>{o({status:"rejected",reason:i}),t(i)},r}function Sw(e){return Math.min(1e3*2**e,3e4)}function wv(e){return(e??"online")==="online"?Vs.isOnline():!0}var Ev=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function Ga(e){return e instanceof Ev}function Iv(e){let t=!1,r=0,o=!1,i;const a=yw(),s=g=>{o||(d(new Ev(g)),e.abort?.())},n=()=>{t=!0},c=()=>{t=!1},u=()=>bv.isFocused()&&(e.networkMode==="always"||Vs.isOnline())&&e.canRun(),l=()=>wv(e.networkMode)&&e.canRun(),p=g=>{o||(o=!0,e.onSuccess?.(g),i?.(),a.resolve(g))},d=g=>{o||(o=!0,e.onError?.(g),i?.(),a.reject(g))},h=()=>new Promise(g=>{i=m=>{(o||u())&&g(m)},e.onPause?.()}).then(()=>{i=void 0,o||e.onContinue?.()}),f=()=>{if(o)return;let g;const m=r===0?e.initialPromise:void 0;try{g=m??e.fn()}catch(v){g=Promise.reject(v)}Promise.resolve(g).then(p).catch(v=>{if(o)return;const y=e.retry??(Us?0:3),S=e.retryDelay??Sw,P=typeof S=="function"?S(r,v):S,b=y===!0||typeof y=="number"&&r<y||typeof y=="function"&&y(r,v);if(t||!b){d(v);return}r++,e.onFail?.(r,v),dw(P).then(()=>u()?void 0:h()).then(()=>{t?d(v):f()})})};return{promise:a,cancel:s,continue:()=>(i?.(),a),cancelRetry:n,continueRetry:c,canStart:l,start:()=>(l()?f():h().then(f),a)}}var Cw=e=>setTimeout(e,0);function Pw(){let e=[],t=0,r=n=>{n()},o=n=>{n()},i=Cw;const a=n=>{t?e.push(n):i(()=>{r(n)})},s=()=>{const n=e;e=[],n.length&&i(()=>{o(()=>{n.forEach(c=>{r(c)})})})};return{batch:n=>{let c;t++;try{c=n()}finally{t--,t||s()}return c},batchCalls:n=>(...c)=>{a(()=>{n(...c)})},schedule:a,setNotifyFunction:n=>{r=n},setBatchNotifyFunction:n=>{o=n},setScheduler:n=>{i=n}}}var de=Pw(),Av=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),uw(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Us?1/0:5*60*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},Rw=class extends Av{#e;#t;#r;#i;#n;#o;#a;constructor(e){super(),this.#a=!1,this.#o=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#r=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=ww(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(e){this.options={...this.#o,...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(e,t){const r=hw(this.state.data,e,this.options);return this.#s({data:r,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),r}setState(e,t){this.#s({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#n?.promise;return this.#n?.cancel(e),t?t.then(Ae).catch(Ae):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>pw(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===$s||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Wa(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!lw(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#n&&(this.#a?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}fetch(e,t){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(e&&this.setOptions(e),!this.options.queryFn){const c=this.observers.find(u=>u.options.queryFn);c&&this.setOptions(c.options)}process.env.NODE_ENV!=="production"&&(Array.isArray(this.options.queryKey)||console.error("As of v4, queryKey needs to be an Array. If you are using a string like 'repoData', please change it to an Array, e.g. ['repoData']"));const r=new AbortController,o=c=>{Object.defineProperty(c,"signal",{enumerable:!0,get:()=>(this.#a=!0,r.signal)})},i=()=>{const c=Rv(this.options,t),l=(()=>{const p={client:this.#i,queryKey:this.queryKey,meta:this.meta};return o(p),p})();return this.#a=!1,this.options.persister?this.options.persister(c,l,this):c(l)},s=(()=>{const c={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:i};return o(c),c})();this.options.behavior?.onFetch(s,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==s.fetchOptions?.meta)&&this.#s({type:"fetch",meta:s.fetchOptions?.meta});const n=c=>{Ga(c)&&c.silent||this.#s({type:"error",error:c}),Ga(c)||(this.#r.config.onError?.(c,this),this.#r.config.onSettled?.(this.state.data,c,this)),this.scheduleGc()};return this.#n=Iv({initialPromise:t?.initialPromise,fn:s.fetchFn,abort:r.abort.bind(r),onSuccess:c=>{if(c===void 0){process.env.NODE_ENV!=="production"&&console.error(`Query data cannot be undefined. Please make sure to return a value other than undefined from your query function. Affected query key: ${this.queryHash}`),n(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(c)}catch(u){n(u);return}this.#r.config.onSuccess?.(c,this),this.#r.config.onSettled?.(c,this.state.error,this),this.scheduleGc()},onError:n,onFail:(c,u)=>{this.#s({type:"failed",failureCount:c,error:u})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0}),this.#n.start()}#s(e){const t=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...bw(r.data,this.options),fetchMeta:e.meta??null};case"success":return this.#t=void 0,{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=e.error;return Ga(o)&&o.revert&&this.#t?{...this.#t,fetchStatus:"idle"}:{...r,error:o,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=t(this.state),de.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:e})})}};function bw(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:wv(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function ww(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,o=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?o??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Ew=class extends Bs{constructor(e={}){super(),this.config=e,this.#e=new Map}#e;build(e,t,r){const o=t.queryKey,i=t.queryHash??Ha(o,t);let a=this.get(i);return a||(a=new Rw({client:e,queryKey:o,queryHash:i,options:e.defaultQueryOptions(t),state:r,defaultOptions:e.getQueryDefaults(o)}),this.add(a)),a}add(e){this.#e.has(e.queryHash)||(this.#e.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#e.get(e.queryHash);t&&(e.destroy(),t===e&&this.#e.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){de.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#e.get(e)}getAll(){return[...this.#e.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(r=>yv(t,r))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(r=>yv(e,r)):t}notify(e){de.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){de.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){de.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Iw=class extends Av{#e;#t;#r;constructor(e){super(),this.mutationId=e.mutationId,this.#t=e.mutationCache,this.#e=[],this.state=e.state||Aw(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#e.includes(e)||(this.#e.push(e),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#e=this.#e.filter(t=>t!==e),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#r?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#i({type:"continue"})};this.#r=Iv({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(i,a)=>{this.#i({type:"failed",failureCount:i,error:a})},onPause:()=>{this.#i({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const r=this.state.status==="pending",o=!this.#r.canStart();try{if(r)t();else{this.#i({type:"pending",variables:e,isPaused:o}),await this.#t.config.onMutate?.(e,this);const a=await this.options.onMutate?.(e);a!==this.state.context&&this.#i({type:"pending",context:a,variables:e,isPaused:o})}const i=await this.#r.start();return await this.#t.config.onSuccess?.(i,e,this.state.context,this),await this.options.onSuccess?.(i,e,this.state.context),await this.#t.config.onSettled?.(i,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(i,null,e,this.state.context),this.#i({type:"success",data:i}),i}catch(i){try{throw await this.#t.config.onError?.(i,e,this.state.context,this),await this.options.onError?.(i,e,this.state.context),await this.#t.config.onSettled?.(void 0,i,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,i,e,this.state.context),i}finally{this.#i({type:"error",error:i})}}finally{this.#t.runNext(this)}}#i(e){const t=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),de.batch(()=>{this.#e.forEach(r=>{r.onMutationUpdate(e)}),this.#t.notify({mutation:this,type:"updated",action:e})})}};function Aw(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Tw=class extends Bs{constructor(e={}){super(),this.config=e,this.#e=new Set,this.#t=new Map,this.#r=0}#e;#t;#r;build(e,t,r){const o=new Iw({mutationCache:this,mutationId:++this.#r,options:e.defaultMutationOptions(t),state:r});return this.add(o),o}add(e){this.#e.add(e);const t=Ws(e);if(typeof t=="string"){const r=this.#t.get(t);r?r.push(e):this.#t.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#e.delete(e)){const t=Ws(e);if(typeof t=="string"){const r=this.#t.get(t);if(r)if(r.length>1){const o=r.indexOf(e);o!==-1&&r.splice(o,1)}else r[0]===e&&this.#t.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Ws(e);if(typeof t=="string"){const o=this.#t.get(t)?.find(i=>i.state.status==="pending");return!o||o===e}else return!0}runNext(e){const t=Ws(e);return typeof t=="string"?this.#t.get(t)?.find(o=>o!==e&&o.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){de.batch(()=>{this.#e.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(e){const t={exact:!0,...e};return this.getAll().find(r=>Sv(t,r))}findAll(e={}){return this.getAll().filter(t=>Sv(e,t))}notify(e){de.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return de.batch(()=>Promise.all(e.map(t=>t.continue().catch(Ae))))}};function Ws(e){return e.options.scope?.id}function Tv(e){return{onFetch:(t,r)=>{const o=t.options,i=t.fetchOptions?.meta?.fetchMore?.direction,a=t.state.data?.pages||[],s=t.state.data?.pageParams||[];let n={pages:[],pageParams:[]},c=0;const u=async()=>{let l=!1;const p=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(t.signal.aborted?l=!0:t.signal.addEventListener("abort",()=>{l=!0}),t.signal)})},d=Rv(t.options,t.fetchOptions),h=async(f,g,m)=>{if(l)return Promise.reject();if(g==null&&f.pages.length)return Promise.resolve(f);const y=(()=>{const w={client:t.client,queryKey:t.queryKey,pageParam:g,direction:m?"backward":"forward",meta:t.options.meta};return p(w),w})(),S=await d(y),{maxPages:P}=t.options,b=m?vw:fw;return{pages:b(f.pages,S,P),pageParams:b(f.pageParams,g,P)}};if(i&&a.length){const f=i==="backward",g=f?_w:_v,m={pages:a,pageParams:s},v=g(o,m);n=await h(m,v,f)}else{const f=e??a.length;do{const g=c===0?s[0]??o.initialPageParam:_v(o,n);if(c>0&&g==null)break;n=await h(n,g),c++}while(c<f)}return n};t.options.persister?t.fetchFn=()=>t.options.persister?.(u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r):t.fetchFn=u}}}function _v(e,{pages:t,pageParams:r}){const o=t.length-1;return t.length>0?e.getNextPageParam(t[o],t,r[o],r):void 0}function _w(e,{pages:t,pageParams:r}){return t.length>0?e.getPreviousPageParam?.(t[0],t,r[0],r):void 0}var kw=class{#e;#t;#r;#i;#n;#o;#a;#s;constructor(e={}){this.#e=e.queryCache||new Ew,this.#t=e.mutationCache||new Tw,this.#r=e.defaultOptions||{},this.#i=new Map,this.#n=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#a=bv.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=Vs.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#a?.(),this.#a=void 0,this.#s?.(),this.#s=void 0)}isFetching(e){return this.#e.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#t.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=this.#e.build(this,t),o=r.state.data;return o===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Wa(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(o))}getQueriesData(e){return this.#e.findAll(e).map(({queryKey:t,state:r})=>{const o=r.data;return[t,o]})}setQueryData(e,t,r){const o=this.defaultQueryOptions({queryKey:e}),a=this.#e.get(o.queryHash)?.state.data,s=cw(t,a);if(s!==void 0)return this.#e.build(this,o).setData(s,{...r,manual:!0})}setQueriesData(e,t,r){return de.batch(()=>this.#e.findAll(e).map(({queryKey:o})=>[o,this.setQueryData(o,t,r)]))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state}removeQueries(e){const t=this.#e;de.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=this.#e;return de.batch(()=>(r.findAll(e).forEach(o=>{o.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},o=de.batch(()=>this.#e.findAll(e).map(i=>i.cancel(r)));return Promise.all(o).then(Ae).catch(Ae)}invalidateQueries(e,t={}){return de.batch(()=>(this.#e.findAll(e).forEach(r=>{r.invalidate()}),e?.refetchType==="none"?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},o=de.batch(()=>this.#e.findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let a=i.fetch(void 0,r);return r.throwOnError||(a=a.catch(Ae)),i.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(o).then(Ae)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=this.#e.build(this,t);return r.isStaleByTime(Wa(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ae).catch(Ae)}fetchInfiniteQuery(e){return e.behavior=Tv(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ae).catch(Ae)}ensureInfiniteQueryData(e){return e.behavior=Tv(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Vs.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(e){this.#r=e}setQueryDefaults(e,t){this.#i.set(vs(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#i.values()],r={};return t.forEach(o=>{gs(e,o.queryKey)&&Object.assign(r,o.defaultOptions)}),r}setMutationDefaults(e,t){this.#n.set(vs(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#n.values()],r={};return t.forEach(o=>{gs(e,o.mutationKey)&&Object.assign(r,o.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#r.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Ha(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===$s&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#r.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}};async function Ow(e){if(!e.ok){const t=await e.text()||e.statusText;throw new Error(`${e.status}: ${t}`)}}function Mw(){return"https://developmentapis.azure-api.net/sandbox/v1/"}const Dw=({on401:e})=>async({queryKey:t})=>{const r=t[0],o=r.startsWith("http")?r:`${Mw()}${r}`,i=await fetch(o,{credentials:"include"});return await Ow(i),await i.json()};new kw({defaultOptions:{queries:{queryFn:Dw({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}});const Nw={en:{concierge:{title:"Welcome to Your Personal AI Medical Concierge",description:"Your intelligent health assistant will ask you key questions to understand your needs and build a personalized profile to support your well-being and care journey.",howItWorks:{title:"How It Works",steps:["Your AI concierge asks you questions to find out how {{brand}} can help you succeed","The concierge will personalize recommendations based on your needs","Access tailored resources, courses, and marketplace options"]},buttons:{resetChat:"Reset Chat",retry:"Retry",continue:"Continue",upload:"Upload",uploading:"Uploading..."},avatar:{yourAIConcierge:"Your AI Concierge",chooseAvatar:"Choose Your Avatar",startConversation:"Start Conversation"},chat:{chooseAvatarTitle:"Choose Your Avatar",chooseAvatarMessage:"Please select an avatar from the left panel to start your conversation with your AI Concierge.",mode:"Chat Mode",modes:{care:"Care",clear:"Clear",clinical:"Clinical"}}},common:{loadingMessages:{loadingMessages:["Analyzing your request","Gathering insights","Processing information","Preparing response","Almost there","Finalizing thoughts","Crafting the perfect response","Connecting the dots","Synthesizing information","Optimizing recommendations"]}}},es:{concierge:{title:"Bienvenido a tu Asistente de IA Personal de Salud",description:"Tu asistente digital inteligente te har preguntas clave para entender tus necesidades y crear un perfil personalizado para apoyarte en tu viaje de bienestar y cuidado.",howItWorks:{title:"Cmo Funciona",steps:["Tu asistente de IA te har preguntas para averiguar cmo {{brand}} puede ayudarte a tener xito","El asistente personalizar recomendaciones basadas en tus necesidades","Accede a recursos, cursos y opciones de mercado personalizados"]},buttons:{resetChat:"Restablecer Chat",retry:"Reintentar",continue:"Continuar",upload:"Cargar",uploading:"Cargando..."},avatar:{yourAIConcierge:"Tu Asistente de IA",chooseAvatar:"Elige tu Avatar",startConversation:"Iniciar Conversacin"},chat:{chooseAvatarTitle:"Elige tu Avatar",chooseAvatarMessage:"Por favor, selecciona un avatar de la izquierda para iniciar tu conversacin con tu Asistente de IA.",mode:"Modo de Chat",modes:{care:"Cuidado",clear:"Claro",clinical:"Clnico"}}},common:{loadingMessages:{loadingMessages:["Analizando tu solicitud","Recopilando informacin","Procesando informacin","Preparando respuesta","Casi listo","Finalizando pensamientos","Elaborando la respuesta perfecta","Conectando los puntos","Sintetizando informacin","Optimizando recomendaciones"]}}},fr:{concierge:{title:"Bienvenue chez votre Assistant IA de Sant",description:"Votre assistant numrique intelligent vous posera des questions cls pour comprendre vos besoins et crer un profil personnalis pour vous aider dans votre parcours de bien-tre et de soins.",howItWorks:{title:"Comment a Marche",steps:["Votre assistant IA vous pose des questions pour savoir comment {{brand}} peut vous aider","L'assistant personnalise des recommandations selon vos besoins","Accdez  des ressources, cours et options adaptes"]},buttons:{resetChat:"Rinitialiser le Chat",retry:"Ressayer",continue:"Continuer",upload:"Tlcharger",uploading:"Tlchargement..."},avatar:{yourAIConcierge:"Votre Assistant IA",chooseAvatar:"Choisissez votre Avatar",startConversation:"Dmarrer la Conversation"},chat:{chooseAvatarTitle:"Choisissez votre Avatar",chooseAvatarMessage:"Veuillez slectionner un avatar de la gauche pour dmarrer votre conversation avec votre Assistant IA.",mode:"Mode de Chat",modes:{care:"Soins",clear:"Clair",clinical:"Clinique"}}},common:{loadingMessages:{loadingMessages:["Analyse de votre demande","Collecte d'informations","Traitement des informations","Prparation de la rponse","Presque termin","Finalisation des rflexions","laboration de la rponse parfaite","Connexion des points","Synthse des informations","Optimisation des recommandations"]}}},de:{concierge:{title:"Willkommen bei Ihrem persnlichen KI-Medizin-Assistenten",description:"Ihr intelligenter digitaler Assistent stellt Fragen, um Ihre Bedrfnisse zu verstehen und ein persnliches Profil zu erstellen, um Ihre Gesundheit und Pflege zu untersttzen.",howItWorks:{title:"So funktioniert es",steps:["Ihr KI-Assistent stellt Fragen, um herauszufinden, wie {{brand}} Sie untersttzen kann","Der Assistent personalisiert Empfehlungen basierend auf Ihren Bedrfnissen","Zugriff auf mageschneiderte Ressourcen, Kurse und Marktplatzoptionen"]},buttons:{resetChat:"Chat zurcksetzen",retry:"Wiederholen",continue:"Fortfahren",upload:"Datei hochladen",uploading:"Hochladen..."},avatar:{yourAIConcierge:"Ihr KI-Assistent",chooseAvatar:"Whlen Sie Ihren Avatar",startConversation:"Konversation starten"},chat:{chooseAvatarTitle:"Whlen Sie Ihren Avatar",chooseAvatarMessage:"Bitte whlen Sie einen Avatar aus der linken Leiste, um mit Ihrem KI-Assistenten zu beginnen.",mode:"Chat-Modus",modes:{care:"Betreuung",clear:"Klar",clinical:"Klinisch"}}},common:{loadingMessages:{loadingMessages:["Analysiere Ihre Anfrage","Sammle Erkenntnisse","Verarbeite Informationen","Bereite Antwort vor","Fast fertig","Finalisiere Gedanken","Erstelle die perfekte Antwort","Verbinde die Punkte","Synthetisiere Informationen","Optimiere Empfehlungen"]}}}};ce.use(pg.initReactI18next).init({resources:Nw,lng:"en",fallbackLng:"en",interpolation:{escapeValue:!1}});const xw=[{code:"en",name:"English"},{code:"es",name:"Spanish"},{code:"fr",name:"French"},{code:"de",name:"German"}],kv={region:"",apiBaseUrl:"",speechKey:"",azureTranslatorKey:"",azureTranslatorEndpoint:"",azureTranslatorRegion:"",tavusApiKey:""},Ov=I.createContext(kv),zw=()=>I.useContext(Ov),Lw=({value:e,children:t})=>{const r={...kv,...e};return C.jsx(Ov.Provider,{value:r,children:t})},Mv=I.forwardRef(({replicaId:e="r82081c7f26d",personaId:t="pc9cb547c05e",personaName:r="Concierge",conversationName:o="Demo Conversation",conversationalContext:i,customGreeting:a,platform:s="home",buttonText:n,videoMode:c,chatVisible:u,toggleChat:l,learningPrompts:p=[],onPromptClick:d,width:h="100%",height:f="100%",maxWidth:g="2xl",className:m="",setVoiceMode:v,setConversationStarted:y,setConversationId:S,setConversationUrl:P,setInterruptReplica:b,currentScript:w,setCurrentScript:A,interruptReplica:E,setIsSpeaking:D,setSpokenText:R,region:M,speechKey:_,config:z},F)=>{const[Q,ee]=I.useState("welcome"),[re,me]=I.useState(null),[$,se]=I.useState(!1),[H,$e]=I.useState(!1),Ot=I.useRef(null),[Qe,Ve]=I.useState([]),[Mt,Jt]=I.useState("16:9"),{tavusApiKey:Ye}=zw(),[Ne,Dt]=I.useState("en");I.useEffect(()=>{typeof window<"u"&&Dt(localStorage.getItem("lang")||"en")},[]);const ms=xw.find(q=>q.code===Ne)?.name||"English",Ze=I.useRef("en");I.useEffect(()=>{typeof window<"u"&&(Ze.current=localStorage.getItem("lang")||"en")},[]),I.useEffect(()=>{(async()=>{if(Qe.length===0)try{const te=await rv();te?.Success&&te.Data&&Ve(te.Data)}catch(te){console.error("Error fetching avatars:",te)}})()},[Qe.length]);const Nt=Qe.find(q=>q.ExternalId===e);I.useEffect(()=>{Ne&&Ne!=="en"&&Ne!==Ze.current&&(Ze.current=Ne,xt())},[Ne]),I.useEffect(()=>{(async()=>{if(Nt?.ImageUrl){const te=new Image;te.onload=()=>{const zt=te.width/te.height;Math.abs(zt-1.7777777777777777)<Math.abs(zt-.5625)?Jt("16:9"):Jt("9:16")},te.onerror=()=>{Jt("16:9")},te.src=Nt.ImageUrl}})()},[Nt?.ImageUrl]),I.useEffect(()=>()=>{re&&tv({conversationId:re.conversation_id,apiKey:Ye})},[re]),I.useEffect(()=>{s==="concierge"&&ye()},[s]);const ye=async()=>{try{$e(!1),se(!0),v(!0),y(!0),Ot.current&&Ot.current.pause();const q=await $b({replicaId:e||"r82081c7f26d",personaId:t||"pc9cb547c05e",conversationName:o||"Demo Conversation",conversationalContext:i??"",customGreeting:a??"",language:ms,apiKey:Ye});if(q?.conversation_id&&q.conversation_url)me(q),S(q.conversation_id),P(q.conversation_url),ee("hairCheck");else throw new Error("Failed to start conversation")}catch(q){console.error("Conversation error:",q)}finally{se(!1)}},xt=async()=>{$e(!0),y(!1);try{if(!re)return;await tv({conversationId:re.conversation_id,apiKey:Ye})}catch(q){console.error(q)}finally{me(null),ee("welcome")}},Hs=()=>{ee("call")};I.useImperativeHandle(F,()=>({handleEnd:xt,handleStart:ye}));const Ks=q=>typeof q=="string"?q:q?`${q}px`:"100%",ys=q=>typeof q=="string"?q:q?`${q}px`:"100%",Ss=Ks(h),Te=ys(f),_e=q=>{if(!q)return;const te=typeof q=="string"?q:`${q}px`;return te.includes("sm")||parseInt(te)<350?"sm":te.includes("lg")||parseInt(te)>600?"lg":"md"},Pe=typeof g=="string"?g:g?`${g}px`:void 0,Xe=Pe&&!Pe.includes("px")&&!Pe.includes("%")?`max-w-${Pe} mx-auto`:"";return C.jsx("main",{className:`${m} relative w-full h-full`,style:{width:Ss,height:Te},children:C.jsx(oe.DailyProvider,{children:C.jsxs("div",{className:`h-full w-full ${Xe}`,style:Pe&&Pe.includes("px")?{maxWidth:Pe}:{},children:[Q==="welcome"&&C.jsx(jb,{onStart:ye,loading:$,buttonText:n,platform:s||"home",replicaId:e||"r82081c7f26d",containerClassName:m,imageHeight:Te==="100%"?"auto":Te,buttonSize:_e(h)||"md",learningPrompts:p,onPromptClick:d,userCredits:100,avatars:Qe,config:z,personaName:r}),Q==="hairCheck"&&C.jsx(qb,{handleEnd:xt,handleJoin:Hs,setScreen:ee,platform:s||"home",containerClassName:m,videoDimensions:{width:Ss,height:Te==="100%"?"auto":Te},buttonsSize:_e(h)||"md"}),Q==="call"&&re&&C.jsx("div",{className:"w-full h-full",children:C.jsx(Ub,{conversation:re,handleEnd:xt,platform:s||"home",videoMode:c??"full",endConv:H,chatVisible:u??!1,toggleChat:l,containerClassName:m,videoHeight:Te==="100%"?"auto":Te,controlsSize:_e(h)||"md",aspectRatio:Mt,setInterruptReplica:b,currentScript:w,setCurrentScript:A,interruptReplica:E,setIsSpeaking:D,setSpokenText:R,region:M,speechKey:_,config:z,personaName:r})})]})})})}),jw=async(e,t,r,o,i=!1,a=!1)=>{const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({UserId:e,CourseId:t,Query:r,Answer:o,Avatar:i,STT:a})};let c;try{const u=Ua("/api/User/education/chathistory/post"),l=await fetch(u,n);if(!l.ok){let p={};const d=l.headers.get("content-type");throw d&&d.includes("application/json")?p=await l.json():p={message:await l.text()},console.error("Error details:",p),new Error(`Failed to post chat history: ${l.status} ${l.statusText} - ${JSON.stringify(p)}`)}return c=l.headers.get("content-length")==="0"?{Data:!0,Success:!0,Message:"Ok"}:await l.json(),c}catch(u){return console.error("Error posting chat history:",u),{Success:!1,Message:u instanceof Error?u.message:"Unknown error occurred",Data:null}}},Qa=({children:e,fallback:t=C.jsx("div",{children:"Loading..."})})=>{const[r,o]=I.useState(!1);return I.useEffect(()=>{o(!0)},[]),r?C.jsx(C.Fragment,{children:e}):C.jsx(C.Fragment,{children:t})},qw=[{id:1,text:"Explain my report",icon:X.GraduationCap},{id:5,text:"Analyze my medical reports.",icon:X.Sparkles},{id:6,text:"Answer my questions like a personal coach",icon:X.MessageSquare}],Fw="r397c808f1cf";function Dv({brandName:e="Growth Hub",personaName:t="Personal AI Concierge",suggestedPrompts:r=qw,welcomeMessage:o="Hi there! I'm your personal health navigator. I can help you understand your lab results, explain medical terminology, and provide personalized health insights. Go ahead and upload any lab test or medical report. If you dont have one, lets just talk.",language:i="en",navigateTo:a="",file:s,onFileChange:n,onApiResponse:c,config:u={region:"",apiBaseUrl:"",speechKey:"",azureTranslatorKey:"",azureTranslatorEndpoint:"",azureTranslatorRegion:""}}){const[l,p]=I.useState([]),[d,h]=I.useState(null),[f,g]=I.useState("chat"),[m,v]=I.useState(!1),[y,S]=I.useState(!1),[P,b]=I.useState(!1),[w,A]=I.useState([]),[E,D]=I.useState(!1),[R,M]=I.useState({}),[_,z]=I.useState(""),[F,Q]=I.useState(!1),[ee,re]=I.useState(!1),[me,$]=I.useState(!1),[se,H]=I.useState(!1),[$e,Ot]=I.useState(""),Qe=I.useRef(null),[Ve,Mt]=I.useState(""),[Jt,Ye]=I.useState(!1),[Ne,Dt]=I.useState(!1),[ms,Ze]=I.useState(!1),[Nt,ye]=I.useState(""),[xt,Hs]=I.useState(""),[Ks,ys]=I.useState(""),[Ss,Te]=I.useState(""),[_e,Pe]=I.useState(!1),Xe=I.useRef(null),q=I.useRef(null),[te,zt]=I.useState([]),[ne,Js]=I.useState({avatar:{chooseAvatar:`Choose Your ${t}`,startConversation:"Start Conversation",yourAIHealthNavigator:`Your ${t}`,description:"I'm here to help you with your health and wellness."},buttons:{resetChat:"Reset Chat",retry:"Retry",continue:"Continue",signUp:"Sign Up Free",uploading:"Uploading...",upload:"Upload report",buyNow:"Buy now"},howItWorks:{title:"How It Works",steps:[`Your AI ${t} asks you questions to find out how ${e} can help you.`,`The ${t} will personalize recommendations based on your needs`,"Access tailored resources, courses, and marketplace options."]}});I.useEffect(()=>{typeof window<"u"&&window.scrollTo(0,0)},[]),I.useEffect(()=>{(async()=>{try{const Z=await rv();if(Z?.Success&&Z.Data){const U=Z.Data.find(V=>V.ExternalId===Fw);U&&(p([U]),h(U))}}catch(Z){console.error("Error fetching avatar:",Z)}})()},[]),I.useEffect(()=>{g(_e?"voice":"chat")},[_e]),I.useEffect(()=>{if(!(!!u?.azureTranslatorKey&&!!u?.azureTranslatorEndpoint&&!!u?.azureTranslatorRegion)){console.warn("Azure translation config is not yet ready.");return}(async()=>{if(i!=="en"&&Xe.current!==i){const[U,V,We,K,Se,Re,Ps,ec,tc,rc,nc,ic,sc,oc,ac]=await Os([`Choose Your ${t}`,"Start Conversation",`Your ${t}`,`I'm here to help you with ${e}.`,"Reset Chat","Retry","Continue","Sign Up Free","Uploading...","Upload Report","Buy Now","How It Works",`Your AI ${t} asks you questions to find out how ${e} can help you.`,`The ${t} will personalize recommendations based on your needs`,"Access tailored resources, courses, and marketplace options."],i,"en",u.azureTranslatorKey,u.azureTranslatorEndpoint,u.azureTranslatorRegion);v(!1),z(""),A([]),Js({avatar:{chooseAvatar:U,startConversation:V,yourAIHealthNavigator:We,description:K},buttons:{resetChat:Se,retry:Re,continue:Ps,signUp:ec,uploading:tc,upload:rc,buyNow:nc},howItWorks:{title:ic,steps:[sc,oc,ac]}}),Xe.current=i}i==="en"&&Xe.current!=="en"&&(v(!1),z(""),A([]),Js({avatar:{chooseAvatar:`Choose Your ${t}`,startConversation:"Start Conversation",yourAIHealthNavigator:`Your ${t}`,description:`I'm here to help you with ${e}.`},buttons:{resetChat:"Reset Chat",retry:"Retry",continue:"Continue",signUp:"Sign Up Free",uploading:"Uploading...",upload:"Upload Report",buyNow:"Buy Now"},howItWorks:{title:"How It Works",steps:[`Your AI ${t} asks you questions to find out how ${e} can help you.`,`The ${t} will personalize recommendations based on your needs`,"Access tailored resources, courses, and marketplace options."]}}),Xe.current="en")})()},[i,u?.azureTranslatorKey,u?.azureTranslatorEndpoint,u?.azureTranslatorRegion,t,e]),I.useEffect(()=>{s&&(zt([s]),et(`Uploaded file: ${s.name}`,[s]))},[s]),I.useCallback(async B=>{S(!0);const U=await Xf("I am user","","","interview",_,0,1,i);return U.Success&&U.Data?.Message?U.Data.Message.includes("ERROR")?(S(!1),ye(`Hello there! I'm ${B?.Name}, your ${t}. I'm here to help you with ${e}. Can you tell me your name?`),{id:"welcome-message",sender:"ai",text:`Hello there! I'm ${B?.Name}, your ${t}. I'm here to help you with ${e}. Can you tell me a little about yourself?`,timestamp:new Date}):(S(!1),z(U.Data.SessionId||""),ye(U.Data.Message),{id:"welcome-message",sender:"ai",text:U.Data.Message,timestamp:new Date}):(S(!1),{id:"welcome-message",sender:"ai",text:`Hello there! I'm ${B?.Name}, your ${t}. I'm here to help you with ${e}. Can you tell me a little about yourself?`,timestamp:new Date})},[e]),I.useEffect(()=>{Ze(!0)},[]),I.useEffect(()=>{Ve&&Ve.trim()!==""&&(et(Ve),Mt(""))},[Ve]),I.useEffect(()=>{v(!!_e)},[_e]);const et=async(B,Z=[])=>{se&&H(!1);const U={id:Date.now().toString(),sender:"user",text:B==="yes, continue"?"Yes":B,timestamp:new Date};Ot(B),A(K=>[...K,U]),S(!0);let V=`${B}`;const We=[...te,...Z];We.length>0&&(V+="Summarize this file in 34 very simple sentences, as if you are explaining to a 3rd grader. Only include the most important points. Also, list anything in the file that should be double-checked or reviewed."),B==="yes, continue"&&(V+="Start the interview. User clicked continue.");try{const K=await Xf(V,"52533633434137384342","","interview",_,0,1,i,We.length>0?We[0]:void 0);if(K.Success&&K.Data?.Message){if(K?.Data?.Message?.includes("ERROR")||K?.Data?.Type==="error"){S(!1);const Re={id:(Date.now()+1).toString(),sender:"ai",text:"Sorry, I couldn't process your request at the moment. Please try again.",timestamp:new Date};A(Ps=>[...Ps,Re]),ye(Re.text),H(!0);return}const Se={id:(Date.now()+1).toString(),sender:"ai",text:K.Data.Message,timestamp:new Date};A(Re=>[...Re,Se]),_||z(K?.Data?.SessionId||""),ye(K.Data.Message),(K.Data.Message.toLowerCase().includes("click continue")||K.Data.Message.toLowerCase().includes("continue"))&&Q(!0),(K.Data.Message.toLowerCase().includes("sign up")||K.Data.Message.toLowerCase().includes("thank you for choosing")||K.Data.Message.toLowerCase().includes("ready to connect"))&&re(!0),(K.Data.Message.toLowerCase().includes("buy now")||K.Data.Message.toLowerCase().includes("ready to get your test kit"))&&$(!0),c&&c(K),await jw("","AIHealthNavigator",B,K.Data.Message||"",f==="voice",B===Ve),Ot("")}else{const Se={id:(Date.now()+1).toString(),sender:"ai",text:"Sorry, I couldn't process your request. Please try again.",timestamp:new Date};A(Re=>[...Re,Se]),ye(Se.text),H(!0)}}catch(K){console.error("Error fetching response from LLM: ",K);const Se={id:(Date.now()+1).toString(),sender:"ai",text:"Sorry, I couldn't connect to the AI service. Please try again later.",timestamp:new Date};A(Re=>[...Re,Se]),ye(Se.text),H(!0)}finally{S(!1)}},Ya=()=>{console.log("Toggle chat visibility")},Cs=()=>{Q(!1),et("yes, continue",[])},ue=()=>{$(!1),typeof window<"u"&&(window.location.href="/account")},Za=()=>{typeof window<"u"&&(a?window.location.href=a:window.location.href="https://growth-hub-git-feature-whitelabeljun25v1-real-business.vercel.app/auth/register")},Gs=()=>{A([])},Qs=(B,Z)=>{const U=Z==="like";M(V=>({...V,[B.id]:Z})),Lb(B.text,"","",U).then(V=>{}).catch(V=>{console.error("Error sending feedback:",V)})},Xa=async B=>{b(!0);const Z=Array.from(B.target.files||[]);if(Z.length>0){const U=Z[0];zt([U]),n&&n(U),b(!1),await et(`Uploaded file: ${U.name}`,[U])}B.target&&(B.target.value="")},Ys=()=>{q.current?.click()};return C.jsxs("div",{className:"w-full h-full",children:[C.jsx("div",{className:"container max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:C.jsxs("div",{className:"relative",children:[C.jsx("div",{className:"relative z-10",children:C.jsxs(mc.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"rounded-lg shadow-2xl border border-primary/20 overflow-hidden",children:[C.jsxs("div",{className:"p-4 sm:p-6 bg-neutral border-b border-primary/20",children:[C.jsxs("div",{className:"flex flex-row items-center justify-between gap-4",children:[C.jsxs("div",{className:"flex items-center flex-shrink min-w-0",children:[C.jsx("div",{className:"h-10 w-10 sm:h-12 sm:w-12 rounded-full overflow-hidden mr-3 sm:mr-4 flex-shrink-0",children:C.jsx("img",{src:d?.ImageUrl,alt:d?.Name,className:"h-full w-full object-cover"})}),C.jsxs("div",{className:"min-w-0",children:[C.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-primary leading-tight truncate",children:ne.avatar.yourAIHealthNavigator}),C.jsx("p",{className:"text-xs sm:text-sm text-secondary truncate",children:ne.avatar.description})]})]}),C.jsxs("div",{className:"hidden md:flex gap-2 flex-wrap ml-4",children:[e!=="CareNexa"&&C.jsxs(ke,{variant:"outline",size:"sm",className:"text-xs text-primary border-primary/30 hover:bg-neutral",onClick:Ys,disabled:P,children:[C.jsx(X.Upload,{className:"h-3 w-3 mr-1"}),P?ne.buttons.uploading:ne.buttons.upload]}),C.jsx(ke,{variant:"outline",size:"sm",className:"text-xs text-primary border-primary/30 hover:bg-neutral",onClick:Gs,children:ne.buttons.resetChat})]}),C.jsx("div",{className:"flex md:hidden items-center ml-2",children:C.jsx("button",{className:"p-2 rounded-md border border-primary/20 bg-white text-primary focus:outline-none",onClick:()=>D(!E),"aria-label":"Open menu",children:E?C.jsx(X.X,{className:"h-6 w-6"}):C.jsx(X.Menu,{className:"h-6 w-6"})})})]}),E&&C.jsxs("div",{className:"md:hidden mt-2 flex flex-col gap-2 animate-fadeIn",children:[C.jsxs(ke,{variant:"outline",size:"sm",className:"text-xs text-primary border-primary/30 hover:bg-neutral",onClick:()=>{Ys(),D(!1)},disabled:P,children:[C.jsx(X.Upload,{className:"h-3 w-3 mr-1"}),P?ne.buttons.uploading:ne.buttons.upload]}),C.jsx(ke,{variant:"outline",size:"sm",className:"text-xs text-primary border-primary/30 hover:bg-neutral",onClick:()=>{Gs(),D(!1)},children:ne.buttons.resetChat})]})]}),C.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 \r
                h-[70vh] md:h-[600px]\r
                max-h-[100vh]`,children:[C.jsx("div",{className:`\r
                  flex flex-col\r
                  basis=[35%] md:basis-auto\r
                  min-h-0\r
                  overflow-y-auto\r
                  p-4 md:p-6\r
                  border-b md:border-b-0 md:border-r border-primary/20\r
                `,children:C.jsx("div",{className:"h-full w-full",children:m?C.jsx("div",{className:"h-full w-full rounded-xl overflow-hidden bg-gradient-to-br from-neutral to-white border border-primary/20",children:d&&C.jsx(Qa,{fallback:C.jsx("div",{className:"w-full h-full bg-gray-200 rounded animate-pulse flex items-center justify-center",children:"Loading conversation..."}),children:C.jsx(Mv,{ref:Qe,replicaId:d?.ExternalId||"",personaId:"pb5d44035dbd",personaName:t,conversationName:`Conversation with ${d?.Name||"your"+t} ${new Date().toISOString()}`,conversationalContext:"Initial medical consultation",customGreeting:w.length>0&&w[w.length-1].sender==="ai"?w[w.length-1].text:o,platform:"concierge",buttonText:ne.avatar.startConversation,videoMode:"minimal",chatVisible:!1,toggleChat:Ya,width:"100%",height:"100%",className:"w-full h-full",setVoiceMode:Ze,setConversationStarted:Pe,setConversationId:ys,setConversationUrl:Te,setInterruptReplica:Dt,currentScript:Nt,setCurrentScript:ye,interruptReplica:Ne,setIsSpeaking:Ye,setSpokenText:Mt,region:u?.region||"",speechKey:u?.speechKey||"",config:u})})}):C.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center",children:[C.jsx("h3",{className:"text-lg font-semibold text-center mb-4 text-primary",children:t}),C.jsx("div",{className:"mb-6 flex items-center justify-center gap-2 text-sm text-secondary",children:C.jsxs("div",{className:"relative group",children:[C.jsxs("div",{className:"flex items-center gap-2 cursor-help",children:[C.jsx(X.HelpCircle,{className:"h-4 w-4 text-primary hover:text-secondary transition-colors"}),C.jsx("span",{children:ne.howItWorks.title})]}),C.jsxs("div",{className:"absolute left-1 -translate-x-1 bottom-full mb-2 w-64 p-3 bg-white rounded-lg shadow-lg border border-primary/20 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-10",children:[C.jsx("h4",{className:"font-medium text-primary mb-2",children:ne.howItWorks.title}),ne.howItWorks.steps.map((B,Z)=>C.jsxs("li",{className:"flex items-start gap-2",children:[C.jsxs("span",{className:"font-bold flex-shrink-0",children:[Z+1,"."]}),C.jsx("span",{className:"break-words",children:B})]},Z))]})]})}),C.jsx("div",{className:"w-64 h-64 md:w-48 md:h-48 rounded-xl overflow-hidden mb-4 bg-gradient-to-br from-neutral to-white border border-primary/20",children:C.jsx("img",{src:d?.ImageUrl,alt:d?.Name,className:"w-full h-full object-cover"})}),C.jsx(ke,{onClick:()=>v(!0),className:"w-full bg-primary hover:bg-secondary text-white py-3 px-6 rounded-lg font-semibold shadow-md transition",children:ne.avatar.startConversation})]})})}),C.jsx("div",{className:`\r
                 flex flex-col\r
                  basis=[65%] md:basis-auto\r
                  min-h-0\r
                  overflow-y-auto\r
                  p-4 md:p-6\r
                `,children:C.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto",children:C.jsx(ES,{language:i,config:u,setInterruptReplica:Dt,messages:w,welcomeMessage:o,onSendMessage:et,className:"h-full",isLoading:y,rightElement:C.jsx(Qa,{fallback:C.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded animate-pulse"}),children:C.jsx(Ba,{avatarName:d?.Name||"AI Health Navigator",disabled:y,voiceMode:ms,setSpokenText:Mt,setIsSpeaking:Ye,setInterruptReplica:Dt,region:u?.region||"",speechKey:u?.speechKey||""})}),suggestedPrompts:r,renderMessage:(B,Z)=>{if(B.sender==="ai"&&B.id!=="welcome-message"){const U=Z===w.length-1;return C.jsxs("div",{className:"relative",children:[C.jsx(eo,{remarkPlugins:[vo],components:{p:({children:V})=>C.jsx("p",{className:"text-sm mb-2",children:V}),ol:({children:V})=>C.jsx("ol",{style:{listStyleType:"circle"},className:"ml-6 mb-2",children:V}),ul:({children:V})=>C.jsx("ul",{className:"list-disc ml-6 mb-2",children:V}),li:({children:V})=>C.jsx("li",{className:"mb-1",children:V}),strong:({children:V})=>C.jsx("strong",{className:"font-semibold",children:V}),a:({href:V,children:We})=>C.jsx("a",{href:V,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:We})},children:B.text}),C.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[C.jsx("button",{className:`p-1 rounded-full transition-colors ${R[B.id]==="like"?"bg-green-100 text-green-600":"hover:bg-gray-200 text-gray-600"}`,onClick:()=>Qs(B,"like"),children:C.jsx(X.ThumbsUp,{className:"h-4 w-4"})}),C.jsx("button",{className:`p-1 rounded-full transition-colors ${R[B.id]==="dislike"?"bg-red-100 text-red-600":"hover:bg-gray-200 text-gray-600"}`,onClick:()=>Qs(B,"dislike"),children:C.jsx(X.ThumbsDown,{className:"h-4 w-4"})})]}),se&&U&&C.jsx("div",{className:"mt-4 flex",children:C.jsx("button",{className:"bg-primary hover:bg-secondary text-white px-6 py-3 rounded-lg font-semibold shadow-md transition",onClick:()=>{et($e),H(!1)},children:ne.buttons.retry})}),U&&F&&C.jsx("div",{className:"mt-4 flex justify-center",children:C.jsx("button",{className:"bg-primary hover:bg-secondary text-white px-6 py-3 rounded-lg font-semibold shadow-md transition",onClick:Cs,children:ne.buttons.continue})}),U&&ee&&C.jsx("div",{className:"mt-4 flex justify-center",children:C.jsx("button",{className:"bg-primary hover:bg-secondary text-white px-6 py-3 rounded-lg font-semibold shadow-md transition",onClick:Za,children:ne.buttons.signUp})}),U&&me&&C.jsx("div",{className:"mt-4 flex justify-center",children:C.jsx("button",{className:"bg-primary hover:bg-secondary text-white px-6 py-3 rounded-lg font-semibold shadow-md transition",onClick:ue,children:ne.buttons.buyNow})})]})}return C.jsx(eo,{remarkPlugins:[vo],components:{p:({children:U})=>C.jsx("p",{className:"text-sm whitespace-pre-line",children:U})},children:B.text})}})})})]})]})}),C.jsx("div",{className:"absolute -top-4 -right-4 w-72 h-72 bg-primary/20 rounded-full blur-3xl"}),C.jsx("div",{className:"absolute -bottom-8 -left-8 w-96 h-96 bg-secondary/10 rounded-full blur-3xl"})]})}),C.jsx("input",{type:"file",ref:q,onChange:Xa,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.txt",style:{display:"none"}})]})}function Bw(e){return C.jsx(Lw,{value:e.config||{},children:C.jsx(Dv,{...e})})}const Nv=I.createContext(void 0),Uw=({children:e,value:t})=>C.jsx(Nv.Provider,{value:t,children:e}),$w=()=>{const e=I.useContext(Nv);if(!e)throw new Error("useConciergeContext must be used within a ConciergeProvider");return e};function Vw(e,t){const[r,o]=I.useState(()=>{if(typeof window>"u")return t;try{const a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(a){return console.log(a),t}});return[r,a=>{try{const s=a instanceof Function?a(r):a;o(s),typeof window<"u"&&window.localStorage.setItem(e,JSON.stringify(s))}catch(s){console.log(s)}}]}Y.ConciergeModule=Bw,Y.ConciergeModuleRaw=Dv,Y.ConciergeProvider=Uw,Y.ConversationComponent=Mv,Y.SSRSafeWrapper=Qa,Y.SpeechComponent=Ba,Y.useConciergeContext=$w,Y.useLocalStorage=Vw,Object.defineProperty(Y,Symbol.toStringTag,{value:"Module"})});
